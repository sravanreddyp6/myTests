<apex:page standardController="Referral__c"
    extensions="referrals_Controller" docType="html-5.0">
    <apex:includeScript value="{!URLFOR($Resource.jquery, 'js/jquery-1.7.2.min.js')}" />
    <apex:includeScript value="{!URLFOR($Resource.jquery, 'js/jquery-ui-1.8.21.custom.min.js')}" />

    <apex:includeScript value="{!URLFOR($Resource.datetimepicker, 'datetimepicker/jquery.datetimepicker.js')}" />
    <apex:includeScript value="{!URLFOR($Resource.momentJs)}" />

    <apex:includeScript value="{!URLFOR($Resource.CommonJS)}" />
    <apex:includeScript value="{!URLFOR($Resource.ReferralsJS)}" />
    <apex:stylesheet value="{!URLFOR($Resource.jquery, 'css/custom-theme/jquery-ui-1.8.21.custom.css')}" />
    <apex:stylesheet value="{!URLFOR($Resource.datetimepicker,  'datetimepicker/jquery.datetimepicker.css')}" />
    <apex:includeScript value="{!URLFOR($Resource.TmnPageLoad)}" />
    <style type="text/css">
.refwarning {
    border-color: #f90;
    display: block;
    background-color: #7bc145;
    border-style: solid;
    border-width: 1px;
    color: #000;
    padding: 2px 2px 2px 2px;
    margin: 4px 20px;
    vertical-align: middle;
}
</style>
    <apex:pageMessage rendered="{!Referral__c.Service_Location__c == null && !isErrorDisplayed && Referral__c.Close_Reason__c != 'Admitted' && locations.size == 0 && Referral__c.id != null && ReferralRecordType != 'CareMeridian'}"
        title="WARNING-Alias Field is blank: No Location has been selected, please add an Anticipated Admission Location OR the section with 'Add Location' button to the Referral."
        severity="warning"></apex:pageMessage>
    <!-- commenting out for PRI-167  Dec 2015
    <div class="refwarning">
            <b>Fields with this formatting are required by The MENTOR Network in order to convert the referral. Please note that the system may alert you to additional data that is required by your state or Operating Group.</b>
                </div>
-->
    <style type="text/css">
.dialogLoadingSpinner {
    margin-left: 5px;
}

#fundingMessages {
    margin-bottom: 10px;
    color: red;
}

#fundingMessages .error {
    color: red;
}

#fundingMessages .success {
    color: green;
}

#progConsid [id*=progConsiderationsDetail] tr td:first-child {
    width: 11.5%;
}

[id*=progConsiderationsDetail] .multiSelectPicklistCell {
    width: 12px;
}

.modalDialog {
    max-height: 500px;
    overflow: auto;
}

.modalDialog .modalSubheader {
    font-weight: bold;
}

.modalDialog .pbHeader {
    font-size: 0.9em;
}

#progConsid td.labelCol {
    width: 20%;
}

#progConsid td.dataCol {
    width: 30px;
}

#ReferralDetailHeader td.labelCol {
    width: 20%;
}

#ReferralDetailHeader td.dataCol {
    width: 20px;
}

.nowrap {
    white-space: nowrap;
}

.custom-lookup-dialog {
    overflow-y: scroll;
    max-height: 400px;
    position: absolute;
}

.requiredInput {
    display: inline;
    margin-left: 4px;
}

.fieldLabel {
    font-size: 90%;
    color: #4a4a56;
    font-weight: bold;
}

.thinking {
    opacity: 0.8;
    background-color: #ccc;
    position: fixed;
    width: 100%;
    height: 100%;
    top: 0px;
    left: 0px;
    z-index: 10000;
}

.thinkingwheel {
    position: absolute;
    left: 50%;
    top: 50%;
    background-color: white;
    border: 2px solid gray;
    padding: 2px;
}

.whitenoise {
    color: white;
}

#datePicker {
    z-index: 9999;
}

.saveBtn:disabled, [id$=createPBRButton]:disabled {
    background: #dddddd !important;
    color: gray !important;
}

.refRequiedFields {
    /*background: #7bc145;*/ /* reversal of PRI-167 2015-12-09 */
    
}

.warning {
    border-color: #f90;
    display: block;
    background-color: #ffc;
    border-style: solid;
    border-width: 1px;
    color: #000;
    padding: 6px 8px 6px 6px;
    margin: 4px 20px;
    vertical-align: middle;
}
</style>

    <script>
        jQuery.noConflict();
        jQuery(document).ready(function($) {
            setUpFields = function () {
                // Apply rules to input fields
                $('body input').on("change", function (event) {
                    applyShowHideRulesToField(event.target);
                });
                $('body select').on("change", function (event) {
                    applyShowHideRulesToField(event.target);
                });
                $('body input').each(function (_, target) {
                    applyShowHideRulesToField(target);
                });
                $('body select').each(function (_, target) {
                    applyShowHideRulesToField(target);
                });
                j$('.datepicker').datetimepicker({
                    timepicker: false,
                    format: 'm/d/Y',
                    yearStart: '1900',
                    closeOnDateSelect: true,
                    mask:false,
                    allowBlank:true,
                    validateOnBlur:false
                });
            };
            setUpFields();
            enableDiagEff();
            setUpTabOrder();
            enableOther();
            enableOtherDesc();
            
//             if(j$('[id$=refSourceTypeFieldId]').val()=== 'Other'){
//          j$('[id$=SourceTypeOtherId]').prop('disabled', false);
//          j$('[id$=SourceTypeOtherDiv]').addClass('requiredInput');
//          }else {
//          j$('[id$=SourceTypeOtherId]').prop('disabled', true);
//          j$('[id$=SourceTypeOtherDiv]').removeClass('requiredInput');
//          }
            if({!referralRecordType =='NeuroRestorative'}){
            j$('[id$=sfps]').addClass('refRequiedFields')
            }

            //Sravan - use this function to clear the link for Name fields in pageBlock Tables
            clearLink = function(){
                j$(".dataCell.noLink a").contents().unwrap();
            }
            clearLink();

        });
    </script>

    <script type="text/javascript">
        j$ = jQuery.noConflict();
        //disable enter key

        function stopRKey(evt) {
            var evt = (evt) ? evt : ((event) ? event : null);
            var node = (evt.target) ? evt.target : ((evt.srcElement) ? evt.srcElement : null);
            if ((evt.keyCode == 13) && (node.type == "text")) {
                return false;
            }
        }

        document.onkeypress = stopRKey;

        // a variable to hold the list of related Parties... need this so we can refresh it using ajax
        var relPartyData = '{!relPartiesJSON}';
        var locationsData = '{!locationsJSON}';

        // ERNS-7 enable the diagnosis effective date when diagnosis is chosen
        function enableDiagEff() {
            if (j$('[id$=diagIdrop]').val() != '') {
                j$('input[id$=diageffdate]').removeAttr('disabled');
                if (j$('[id$=diagIdrop]').val() == 'Encephalopathy') {
                    j$('[id$=encephaloPanel]').show();
                } else if (j$('[id$=diagIdrop]').val() != 'Encephalopathy') {
                    j$('[id$=encephaloPanel]').hide();

                }
            } else {
                j$('input[id$=diageffdate]').val('');
                j$('input[id$=diageffdate]').attr('disabled', 'disabled')
                j$('[id$=encephaloPanel]').hide();
            }
        }

        function validateRelatedParty() {
            var errors = '';
            j$('#relatedPartyErrors').html(errors);
            if (j$('input[id$=relatedPartyEntry_Name]').val() == '') {
                errors += '<li>Party Name is a required field.</li>';
            }
            if (j$('select[id$=relatedPartyEntry_Status]').val() == '') {
                errors += '<li>Status is a required field.</li>';
            }
            var partyType = j$('select[id$=relatedPartyEntry_Type]').val();
            if (partyType == '') {
                errors += '<li>Type is a required field.</li>';
            }
            var x = j$('input[id$=relatedPartyEntry_Email]').val();
            if (x.length > 0) {
                var atpos = x.indexOf("@");
                var dotpos = x.lastIndexOf(".");
                if (atpos < 1 || dotpos < atpos + 2 || dotpos + 2 >= x.length) {
                    errors += '<li>Email is not a valid Email address</li>';
                }
            }
            str = "Physician - Primary";
            var obj = JSON.parse(relPartyData);
            for (var i = 0; i < obj.length; i++) {
                if (obj[i].TypeC === str && partyType === str) {
                    errors += '<li>Only one "Physician - Primary" allowed. Please edit Type on this entry or change the Type assigned to existing Related Party.</li>';
                    break;
                }
            }
            j$('#relatedPartyErrors').html(errors);
            return (errors == '');
        }
    
        function validateAgency() {
            var errors = '';
            j$('#agencyErrors').html(errors);
            if (j$('input[id$=agencyEntry_Name]').val() == '') {
                errors += '<li>Name is a required field.</li>';
            }
            var x = j$('input[id$=agencyEntry_Email]').val();
            if (x.length > 0) {
                var atpos = x.indexOf("@");
                var dotpos = x.lastIndexOf(".");
                if (atpos < 1 || dotpos < atpos + 2 || dotpos + 2 >= x.length) {
                    errors += '<li>Email is not a valid Email address</li>';
                }
            }
            j$('#agencyErrors').html(errors);
            return (errors == '');
        }

        function validateLocation() {

            var errors = '';
            j$('#locationErrors').html(errors);
            if (j$('input[id$=locationEntry_ServiceLocation]').val() == '') {
                errors += '<li>Alias is a required field.</li>';
            } else if (j$('input[id$=locationEntry_ServiceLocation_lkid]').val() == '') {
                errors += '<li>You must lookup the Alias</li>';
            }

            if (j$('input[id$=locationEntry_User]').length > 0) {
                if (j$('input[id$=locationEntry_User]').val() == '') {
                    errors += '<li>User Assigned is a required field.</li>';
                } else if (j$('input[id$=locationEntry_User_lkid]').val() == '') {
                    errors += '<li>You must lookup the User</li>';
                }
            }

            //EC-54 November 2014 Release Make Rank Required for CM
            if (j$('select[id$=locationEntry_Rank]').val() == '' && {!referralRecordType == 'CareMeridian'}) {
                errors += '<li>Rank is a required field.</li>';
            }
            //End EC-54

            //NEVAL-65
            if ({!referralRecordType == 'CareMeridian' || referralRecordType == 'NeuroRestorative'}) {
                if (j$('[id$=hasNonClosedPrimaryLocation]').text() == 'true' && j$('select[id$=locationEntry_Rank]').val() == 'Primary' && ['New', 'Active', 'On Hold'].indexOf(j$('select[id$=locationEntry_Status]').val()) != -1) {
                    errors += '<li>Another New, Active, or On Hold primary location already exists.</li>';
                }
            }
            //End NEVAL-65

            if (j$('select[id$=locationEntry_Status]').val() == '') {
                errors += '<li>Status is a required field.</li>';
            }
            j$('#locationErrors').html(errors);
            return (errors == '');
        }

        function validateActivity() {
            var errors = '';
            j$('#activityErrors').html(errors);
            if (j$('input[id$=activityEntry_Subject]').val() == '') {
                errors += '<li>Subject is a required field.</li>';
            }
            if (j$('select[id$=activityEntry_Priority]').val() == '') {
                errors += '<li>Priority is a required field.</li>';
            }
            if (j$('select[id$=activityEntry_Status]').val() == '') {
                errors += '<li>Status is a required field.</li>';
            }
            if (j$('input[id$=activityEntry_Owner]').val() == '') {
                errors += '<li>Assigned To is a required field.</li>';
            }
            j$('#activityErrors').html(errors);
            return (errors == '');
        }

        //copies relatedParty fields from dialog for postback
        function relatedPartySave(isClose) {
            if (validateRelatedParty()) {
                j$('input[id$=relatedPartyName]').val(j$('input[id$=relatedPartyEntry_Name]').val());
                j$('input[id$=relatedPartyType]').val(j$('select[id$=relatedPartyEntry_Type]').val());
                j$('input[id$=relatedPartyStatus]').val(j$('select[id$=relatedPartyEntry_Status]').val());
                j$('input[id$=relatedPartyEmail]').val(j$('input[id$=relatedPartyEntry_Email]').val());
                j$('input[id$=relatedPartyPhone]').val(j$('input[id$=relatedPartyEntry_Phone]').val());
                j$('input[id$=relatedPartyAddress]').val(j$('textarea[id$=relatedPartyEntry_Address]').val());
                j$('input[id$=relatedPartyPhone_2]').val(j$('input[id$=relatedPartyEntry_Phone_2]').val());
                j$('input[id$=relatedPartyPhone_1_Type]').val(j$('select[id$=relatedPartyEntry_Phone_1_Type]').val());
                j$('input[id$=relatedPartyPhone_2_Type]').val(j$('select[id$=relatedPartyEntry_Phone_2_Type]').val());
                j$('input[id$=relatedPartyComments]').val(j$('textarea[id$=relatedPartyEntry_Comments]').val());

                saveRelParty();
                if (isClose) {
                    closeModalDialogR('relatedPartyModal', 'span');
                }
            }
        }
        //EB-481
        function validateFundingSource(){
            var errors = '';
            j$('#fundingMessages').html(errors);
            if ( j$('span[id$=hasPrimaryFS]').text() == 'true' ) {
                if ( j$('select[id$=fundingEntry_coverage]').val() == 'Primary' ) {
                    errors += '<li>A Primary Funding Source has already been added, only one Primary Funding source is allowed</li>';
                }
            }

            j$('#fundingMessages').html(errors);
            return (errors == '');
        }

        fundingSourceSave = function(isClose) {
            // We cant use Visualforce functions/variables in a Static Resource JS file,
            // so we have to pass it in here.
            closeFundingSource = isClose;
            if( validateFundingSource() ){
                fundingSourceSaveHelper('{!JSENCODE(ReferralRecordType)}');
            }
        }

        // ERC-96: Adding this for front end validation.
        // Claims_Submission_Zip is now a text field instead of number field.
        function checkZipCode(value) {
            var errors = '';
            var validformat = /^\d{5}$|^\d{5}-\d{4}$/

            // if it contains a value and doesn't match regex then error
            if (!validformat.test(value) && value.trim()) {
                errors += '<li class="error">Please enter zip code in the format: XXXXX or XXXXX-XXXX</li>';
                j$('#fundingMessages').html(errors);
            }
            return (errors == '');
        }

        //copies Agency fields from dialog for postback
        function agencySave(isClose) {
            //j$('#agencyErrors').html('');
            if (validateAgency()) {
                j$('input[id$=agencyName]').val(j$('input[id$=agencyEntry_Name]').val());
                j$('input[id$=agencyPhone]').val(j$('input[id$=agencyEntry_Phone]').val());
                j$('input[id$=agencyAddress]').val(j$('textarea[id$=agencyEntry_Address]').val());
                j$('input[id$=agencyEmail]').val(j$('input[id$=agencyEntry_Email]').val());
                j$('input[id$=agencyReason]').val(j$('textarea[id$=agencyEntry_Reason]').val());

                saveAgency();
                if (isClose) {
                    closeModalDialogR('agencyModal', 'span');
                }
            }
            /*else {
                j$('#agencyErrors').html('<li>Name is required.</li>');
            } */
        }

        //copies activity fields from dialog for postback
        function activitySave(isClose) {
            if (validateActivity()) {
                j$('input[id$=activitySubject]').val(j$('input[id$=activityEntry_Subject]').val());
                j$('input[id$=activityPriority]').val(j$('select[id$=activityEntry_Priority]').val());
                j$('input[id$=activityStatus]').val(j$('select[id$=activityEntry_Status]').val());
                j$('input[id$=activityActivityDate]').val(j$('input[id$=activityEntry_ActivityDate]').val());
                j$('input[id$=activityOwner]').val(j$('input[id$=activityEntry_Owner_lkid]').val());
                j$('input[id$=activityComments__c]').val(j$('textarea[id$=activityEntry_Comments__c]').val());

                saveActivity();
                if (isClose) {
                    closeModalDialogR('ActivityModal', 'span');
                }
            }
        }

        //copies Location fields from dialog for postback
        function locationSave(isClose) {
            if (validateLocation()) {
                j$('input[id$=locationServiceLocation]').val(j$('input[id$=locationEntry_ServiceLocation_lkid]').val());
                j$('input[id$=locationUser]').val(j$('input[id$=locationEntry_User_lkid]').val());
                j$('input[id$=locationStatus]').val(j$('select[id$=locationEntry_Status]').val());
                j$('input[id$=locationRank]').val(j$('select[id$=locationEntry_Rank]').val());
                saveLocation();

                if (isClose) {
                    closeModalDialogR('ReferralLocationModal', 'span');
                }
            }
        }

        function copyPermanent(element) {
            var street1 = '';
            var street2 = '';
            var city = '';
            var state = '';
            var zip = '';
            var phone = '';
            var email = '';
            var fax = '';
            if (element.checked) {
                street1 = j$('input[id$=Perm_Street1]').val();
                street2 = j$('input[id$=Perm_Street2]').val();
                city = j$('input[id$=Perm_City]').val();
                state = j$('select[id$=Perm_State]').val();
                zip = j$('input[id$=Perm_Zip]').val();
                phone = j$('input[id$=Perm_Phone]').val();
                email = j$('input[id$=Perm_Email]').val();
                fax = j$('input[id$=Perm_Fax]').val();
            }

            j$('input[id$=MN_Street1]').val(street1);
            j$('input[id$=Neuro_Street1]').val(street1);
            j$('input[id$=MN_Street2]').val(street2);
            j$('input[id$=Neuro_Street2]').val(street2);
            j$('input[id$=MN_City]').val(city);
            j$('select[id$=MN_State]').val(state);
            j$('input[id$=MN_Zip]').val(zip);
            j$('input[id$=MN_Phone]').val(phone);
            j$('input[id$=MN_Email]').val(email);
            j$('input[id$=MN_Fax]').val(fax);
        }

        function copyPermanentNeuro(element) {
            var street1 = '';
            var street2 = '';
            var city = '';
            var state = '';
            var zip = '';
            var phone = '';
            var email = '';
            var fax = '';
            if (element.checked) {
                street1 = j$('input[id$=Ref_Perm_Street]').val();
                street2 = j$('input[id$=Ref_Perm_Street2]').val();
                city = j$('input[id$=Ref_Perm_City]').val();
                state = j$('select[id$=Ref_Perm_State]').val();
                zip = j$('input[id$=Ref_Perm_Zip]').val();
            }

            j$('input[id$=MN_Street1]').val(street1);
            j$('input[id$=Neuro_Street1]').val(street1);
            j$('input[id$=MN_Street2]').val(street2);
            j$('input[id$=Neuro_Street2]').val(street2);
            j$('input[id$=MN_City]').val(city);
            j$('select[id$=MN_State]').val(state);
            j$('input[id$=MN_Zip]').val(zip);

        }

        function alertOnHighRisk() {
            if (j$('[id*=redFlagged]').val() == "true") {
                alert('This referral has been flagged as High Risk. Please follow the process in your state to move forward with this referral appropriately.');
            }
        }

        function unsetAdditionalFields(value) {
            var d = new Date();

            var month = d.getMonth() + 1;
            var day = d.getDate();
            var year = d.getFullYear();

            var fulldate = month + '/' + day + '/' + year;
            if (value != 'Closed') {
                j$('select[id$=closeReason]').val('');
                j$('input[id$=closeDate]').val('');
                j$('textarea[id$=closeComment]').val('');
            }
            if (value != 'On Hold') {
                j$('select[id$=holdReason]').val('');
                j$('input[id$=holdDate]').val('');
                j$('input[id$=reviewOn]').val('');
            }
            if (value == 'Closed') {

                j$('input[id$=closeDate]').val(fulldate);
            }
            if (value == 'On Hold') {
                j$('input[id$=holdDate]').val(fulldate);
            }
        }

        function clearReason_MentalHealth() {
            j$('select[id$=clearReason_MentalHealth_input]').val('');



        }

        function clearAdjudicated_offense_status() {
            //window.alert("sometext");
            j$('input[id$=Misdemeanor_s]').prop("checked", false);
            j$('input[id$=Felony_ies]').prop("checked", false);


        }

        //Added by Sravan for ERR-20  09/17/2014 10:25 AM
        function alertUseraboutLocation() {

            var refStatus = j$('select[id$=referralStatus]').val();
            str = "Closed";
            var foundActive = false;
            var obj = JSON.parse(locationsData);

            for (var i = 0; i < obj.length; i++) {
                if (obj[i].status !== str) {
                    foundActive = true;
                    break;
                }
            }

            if (refStatus == 'Closed' && foundActive == true) {
                if (!window.confirm('There are Other Locations that are not closed, would you like to still close this referral?')) {
                    if ('{!Referral__c.Id}') {
                        return window.location = '/apex/referral2?id={!Referral__c.Id}';
                    }
                } else checkRedFlags(); //This is the ActionFunction
            } else {
                checkRedFlags();
            }

        }

        clearDisableField = function(pageSectionId) {

            j$.each(j$('div[id$=' + pageSectionId + '] input[disabled=true]'), function(k, v) {
                j$(this).val('');
                j$(this).trigger('change');
            });
            j$.each(j$('div[id$=' + pageSectionId + '] select[disabled=true]'), function(k, v) {
                j$(this).val('');
            });
            j$.each(j$('div[id$=' + pageSectionId + ']  textarea[disabled=true]'), function(k, v) {
                j$(this).val('');
            });
        }
        saveBtnDisplay = function(dStatus){
            console.log('save status' + dStatus);
            j$('.saveBtn').prop('disabled', dStatus);
            if(dStatus){
                j$('.saveBtn').prop('value', 'Saving...');                
            }
            else{
                j$('.saveBtn').prop('value', 'Save Referral');
            }
        }
        
//pri-162
        function setUpTabOrder(){
            console.log('start tab order');
            var tabindex = 20000;
              j$('body :input').each(function() {
                 if (this.type != "hidden") {
                   var $input = j$(this);
                   if( $input.attr("tabindex") == ''){
                       $input.attr("tabindex", tabindex);
                       //console.log($input);
                   }
                 }
              });
              tabindex = 1000;
              j$('#theWholeForm :input').each(function() {
                 if (this.type != "hidden") {
                   var $input = j$(this);
                   if( $input.attr("tabindex") == 20000){
                       $input.attr("tabindex", tabindex);
                       //console.log($input);

                   }
                 }
              });
              tabindex = 2000;
              j$('.btn').each(function() {
                 if (this.type != "hidden") {
                   var $input = j$(this);
                       $input.attr("tabindex", tabindex);
                       //console.log($input);

                 }
              });


                   console.log('end tab order');
        }
        //end pri-162


        function enableOther() {
            var source = j$('[id$=refSourceTypeFieldId]').val();
            if(source === 'Other'){
                j$('[id$=SourceTypeOtherId]').prop('disabled', false);
                j$('[id$=SourceTypeOtherDiv]').addClass('requiredInput');
                j$('[id$=brokerage]').val('');
                j$('[id$=brokerage]').prop('disabled', true);
                j$('[id$=SourceTypeBrokerageDiv]').removeClass('requiredInput');
                j$('[id$=county]').val('');
                j$('[id$=county]').prop('disabled', true);
                j$('[id$=SourceTypeCountyDiv]').removeClass('requiredInput');
            }else if(source === 'Brokerage'){
                j$('[id$=brokerage]').prop('disabled', false);
                j$('[id$=SourceTypeBrokerageDiv]').addClass('requiredInput');
                j$('[id$=SourceTypeOtherId]').val('');
                j$('[id$=SourceTypeOtherId]').prop('disabled', true);
                j$('[id$=SourceTypeOtherDiv]').removeClass('requiredInput')
                j$('[id$=county]').val('');
                j$('[id$=county]').prop('disabled', true);
                j$('[id$=SourceTypeCountyDiv]').removeClass('requiredInput');
            }else if(source === 'County'){
                j$('[id$=county]').prop('disabled', false);
                j$('[id$=SourceTypeCountyDiv]').addClass('requiredInput');
                j$('[id$=SourceTypeOtherId]').val('');
                j$('[id$=SourceTypeOtherId]').prop('disabled', true);
                j$('[id$=SourceTypeOtherDiv]').removeClass('requiredInput')
                j$('[id$=brokerage]').val('');
                j$('[id$=brokerage]').prop('disabled', true);
                j$('[id$=SourceTypeBrokerageDiv]').removeClass('requiredInput');
            }
            else{
                j$('[id$=SourceTypeOtherId]').val('');
                j$('[id$=brokerage]').val('');
                j$('[id$=county]').val('');
                j$('[id$=SourceTypeOtherId]').prop('disabled', true);
                j$('[id$=brokerage]').prop('disabled', true);
                j$('[id$=county]').prop('disabled', true);
                j$('[id$=SourceTypeOtherDiv]').removeClass('requiredInput')
                j$('[id$=SourceTypeBrokerageDiv]').removeClass('requiredInput');
                j$('[id$=SourceTypeCountyDiv]').removeClass('requiredInput');
            }
        }
    	
            function enableOtherDesc() {
                var source = j$('[id$=reasonforRefADH]').val();
                if(source === 'Other'){
                    j$('[id$=otherDescADHId]').prop('disabled', false);
                    j$('[id$=otherDescADHDiv]').addClass('requiredInput');
                }else{
                    j$('[id$=otherDescADHId]').val('');
                    j$('[id$=otherDescADHId]').prop('disabled', true);
                	j$('[id$=otherDescADHDiv]').removeClass('requiredInput')
                }
            }
    
    	

    // Diagnosis changes

    function validateDiagnosis() {
        var errors = '';
        j$('#diagnosisErrors').html(errors);

        var effDate = j$('input[id$=diagnosisEntry_EffDate]').val();

        var effDateFormat  = new Date(moment(new Date(effDate)).format());
        var today = new Date(moment(new Date()).format());

        if (j$('input[id$=diagnosisEntry_icd10]').val() == '') {
            errors += '<li>ICD-10 Code is a required field.</li>';
        }

        if (j$('input[id$=diagnosisEntry_icd10]').val() != '' && j$('input[id$=diagnosisEntry_icd10_lkid]').val() == '') {
            errors += '<li>Please perform a search using the lookup icon to add ICD-10 Code.</li>';
        }

        if (j$('input[id$=diagnosisEntry_EffDate]').val() == '') {
            errors += '<li>Date and Time of Diagnosis is a required field.</li>';
        }

        if (effDate != '' && effDateFormat > today) {
            errors += '<li>Date and Time of Diagnosis cannot be in future.</li>';
        }

        if (j$('select[id$=diagnosisEntry_status]').val() == '') {
            errors += '<li>Status is a required field.</li>';
        }

        j$('#diagnosisErrors').html(errors);
        return (errors == '');
    }

    function diagnosisSave(isClose) {
        if (validateDiagnosis()) {
            //   j$('input[id$=diagId]').val(j$('input[id$=diagnosisEntry_Id]').val());
            //   j$('input[id$=diagEffDate]').val(j$('input[id$=diagnosisEntry_EffDate]').val());
            //   j$('input[id$=diagStatus]').val(j$('input[id$=diagnosisEntry_status]').val());

            saveDiagnosis();
            //   j$('input[id$=diagnosisEntry_Id]').val('');
            //   j$('input[id$=diagnosisEntry_EffDate]').val('');
            //   j$('input[id$=diagnosisEntry_status]').val('');

            if (isClose) {
                closeModalDialogR('diagnosisModal', 'span');
            }
        }
    }

    //End

    function getToday() {
            var today = new Date();
            var dd = today.getDate();
            var mm = today.getMonth() + 1; //January is 0!
            var yyyy = today.getFullYear();
            if (dd < 10) {
                dd = '0' + dd
            }
            if (mm < 10) {
                mm = '0' + mm
            }
            today = mm + '/' + dd + '/' + yyyy;
            return today;
        }
    
        function dobFunction() {
            var errors = '';
            j$('#dobError').html(errors);
            
            var dobVar = j$('input[id$=dobId]').val();
            if (j$('input[id$=dobId]').val() != '') {
                  if (checkdate(j$('input[id$=dobId]').val()) == false) {
                        errors += 'Invalid Date Format: Use MM/DD/YYYY';
                    }
            }
            j$('#dobError').html(errors);
            return (errors == '');
        }
        function checkdate(value){
            var dtRegex = new RegExp(/\b\d{1,2}[\/-]\d{1,2}[\/-]\d{4}\b/);
            var returnval = false
            if (!dtRegex.test(value))
                returnval = false
            else
                returnval = true
            return returnval
        }
        function createPbrBtnEnable(enabled){
        
            jQuery('[id$=createPBRButton]').prop("disabled", !enabled);
        }
    </script>
    <div id="theWholeForm">
        <apex:form id="referralForm">
            <apex:actionFunction name="saveRef" action="{!saveRef}" />
            <apex:actionFunction name="checkRedFlags" action="{!checkRedFlags}"
                oncomplete="alertOnHighRisk(); saveRef(); saveBtnDisplay('false'); return false;"
                rerender="redFlagged" />
            <apex:actionRegion >
                <apex:actionFunction name="setReferralRecordType" status="myStatus"
                    action="{!setReferralRecordType}"
                    rerender="ReferralDetail,ReferralDetail_1,Funding,progConsid,ReferralServices,msgs,ReferralDetailHeader,referralDetailBlock,progConsid,progConsiderationsDetail,placementRiskBlock, JuvBlockSection, PlacementHxBlockSection, HxBlock, refTypeHidden"
                    oncomplete="setUpFields();enableOther();" />
            </apex:actionRegion>
            <apex:actionRegion >
                <apex:actionFunction name="showAddRelParty"
                    action="{!showAddRelParty}"
                    oncomplete="openModalDialogR('relatedPartyModal', 'span', 'Add Related Party','none');"
                    status="showAddRelPartyStatus"
                    rerender="relatedParties,relatedPartyEntry,relatedPartyEntry2,msgs" />
            </apex:actionRegion>
            <apex:actionRegion >
                <apex:actionFunction name="showAddFundingSource"
                    status="AddFundingSourceStatus"
                    oncomplete="fundingSourceScrollToTop(); fundingSourceClearMessages(); openModalDialogR('FundingSourceModal', 'span', 'Add Funding Source','none', 1000); applyRulesToFundingSource(); "
                    action="{!showAddFundingSource}"
                    rerender="fundingSources,fundingSourcePayerDetailEntry,fundingSourceRedFlagsEntry,fundingSourceAuthorizationDetailEntry,fundingSourceEntry,msgs" />
            </apex:actionRegion>
            <apex:actionRegion >
                <apex:actionFunction name="showAddAgency" action="{!showAddAgency}"
                    rerender="agencies,agencyEntry,msgs" />
            </apex:actionRegion>
            <apex:actionRegion >
                <apex:actionFunction name="showAddActivity"
                    action="{!showAddActivity}"
                    rerender="activities,activityEntry,msgs" />
            </apex:actionRegion>
            <apex:actionRegion >
                <apex:actionFunction name="showAddLocation"
                    action="{!showAddLocation}"
                    rerender="locations,locationEntry,msgs,SLMSG1"
                    oncomplete="openModalDialogR('ReferralLocationModal', 'span', 'Add Location','referral-location'); j$('input[id$=locationEntry_ServiceLocation]').val('');"
                    status="AddLocationStatus" />
            </apex:actionRegion>
            <apex:actionFunction name="locationLookup"
                action="{!resetSearchItems}" rerender="block,table,SLMSG1"
                oncomplete="j$('input[id$=nameFilter]').val(j$('input[id$=locationEntry_ServiceLocation]').val());openModalDialogR('searchDialog', 'span', 'Search Service Location','custom-lookup-dialog', 900);return false;" />
            <apex:actionFunction name="locationLookup2"
                action="{!resetSearchItems2}" rerender="block2,table2,SLMSG2"
                oncomplete="j$('input[id$=nameFilter2]').val(j$('input[id$=sl]').val());openModalDialogR('searchDialog2', 'span', 'Search Service Location','custom-lookup-dialog',900);return false;" />

            <!-- Diagnosis changes-->

            <apex:actionRegion >
                <apex:actionFunction name="showAddDiagnosis"
                    action="{!showAddDiagnosis}"
                    oncomplete="openModalDialogR('diagnosisModal', 'span', 'Add Diagnosis', 'none', 1000);"
                    rerender="diagsec,diagnosisModal,msgs" status="AdddiagStatus" />
            </apex:actionRegion>
        <!-- end -->
        
            <apex:pageMessages id="msgs" />

            <apex:inputhidden value="{!Referral__c.Person_Being_Referred__c}" />
            <apex:inputhidden value="{!Referral__c.Person_Being_Served__c}" />
            <!--apex:inputhidden value="{!Referral__c.RecordType.Name}" /-->
            <!--<apex:outputpanel style="display:none">
        <apex:inputField value="{!Referral__c.RecordType.Name}" />
    </apex:outputpanel>-->

            <apex:pageBlock mode="edit">
                <apex:pageblockButtons location="bottom" rendered="{!AND(ISNULL(personBeingRefRecord.Id),ISNULL(personBeingServedRecord.Id))}">
                    
                    <apex:actionFunction name="createPBR" action="{!createPBR}" />
                    <apex:commandButton value="Create Person Being Referred"
                        id="createPBRButton" onclick="createPBR(); createPbrBtnEnable(false); return false;"  
                        rendered="{!ISNULL(personBeingRefRecord.Id)}" />
                    <apex:commandButton value="Cancel" id="cancelButton"
                        action="{!cancel}" html-formnovalidate="formnovalidate" />
                </apex:pageblockButtons>

                <apex:pageblockButtons location="Top">
                    <apex:commandButton value="Search for Duplicates"
                        action="{!redirectToSearch}" />
                    <apex:commandButton value="Unlink Referral" action="{!unlinkPBR}"
                        rendered="{!Referral__c.OldPBR__c != null}" />
                    <apex:commandButton value="Unlink Referral" action="{!unlinkPBS}"
                        rendered="{!Referral__c.OldPBS__c != null}" />
                </apex:pageblockButtons>

                <apex:pageBlockSection title="Person Being Referred"
                    showHeader="true" columns="2" collapsible="false" id="PBRSection"
                    rendered="{!ISNULL(personBeingServedRecord.id)}">
                    <!-- Rearranged these filed for EPRIQM-117  -->


                    <apex:pageBlockSectionItem helpText="First Name is required to convert this referral to Admission">
                        <apex:outputLabel value="First Name" />
                        <apex:outputPanel layout="block">
                            <apex:outputPanel layout="block" />
                            <apex:inputText value="{!personBeingRefRecord.First_Name__c}"
                                tabindex="10"
                                required="{!ReferralRecordType =='NeuroRestorative' || ReferralRecordType =='Adult Day Health'}"
                                styleclass="refRequiedFields" />
                        </apex:outputPanel>
                    </apex:pageBlockSectionItem>

                    <apex:inputField value="{!personBeingRefRecord.Race__c}"
                        taborderhint="2" />
                    <apex:inputText value="{!personBeingRefRecord.Middle_Initial__c}"
                        tabindex="10" />
                    <apex:inputField value="{!personBeingRefRecord.Ethnicity__c}"
                        taborderhint="2" />

                    <apex:pageBlockSectionItem helpText="Last Name is required to convert this referral to Admission">
                        <apex:outputLabel value="Last Name" />
                        <apex:outputPanel layout="block">
                            <apex:outputPanel layout="block" />
                            <apex:inputText value="{!personBeingRefRecord.Last_Name__c}"
                                tabindex="10"
                                required="{!ReferralRecordType =='NeuroRestorative' || ReferralRecordType =='Adult Day Health'}"
                                styleclass="refRequiedFields" />
                        </apex:outputPanel>
                    </apex:pageBlockSectionItem>


                    <apex:inputField value="{!personBeingRefRecord.Marital_Status__c}"
                        taborderhint="2" />
                    <apex:pageBlockSectionItem helpText="Date of Birth is required to convert this referral to Admission">
                        <apex:outputLabel value="Date of Birth" />
                        <apex:outputPanel layout="block">
                            <apex:outputPanel layout="block" />
                            <apex:inputField value="{!personBeingRefRecord.Date_of_Birth__c}"
                                taborderhint="1" showDatePicker="false"
                                styleclass="refRequiedFields datepicker" id="dobId" onblur="dobFunction();return false;"/>
                              <span class="dobError" id="dobError" style="color:red;"> </span>               
                        </apex:outputPanel>
                    </apex:pageBlockSectionItem>



                    <apex:pageBlockSectionItem helpText="{!$ObjectType.Person_Being_Referred__c.fields.Non_Verbal__c.inlineHelpText}">
                        <apex:outputText value="Primary Language" />
                        <apex:outputPanel styleClass="nowrap">
                            <apex:inputField value="{!personBeingRefRecord.Primary_Language__c}"
                                taborderhint="2" />&nbsp;
                        <apex:outputLabel value="Non-Verbal" />&nbsp;
                        <apex:inputField id="nonverb"
                                value="{!personBeingRefRecord.Non_Verbal__c}" taborderhint="2" />&nbsp;
                        <apex:outputLabel value="Sign Language" />&nbsp;
                        <apex:inputField id="signLan"
                                value="{!personBeingRefRecord.Sign_Language__c}"
                                taborderhint="2" />
                        </apex:outputPanel>
                    </apex:pageBlockSectionItem>
                    <apex:pageBlockSectionItem helpText="{!$ObjectType.Person_Being_Referred__c.fields.Age_year__c.inlineHelpText}">
                        <apex:outputText value="Age " />
                        <apex:outputPanel styleClass="nowrap">
                            <apex:inputField value="{!personBeingRefRecord.Age_year__c}"
                                taborderhint="1" style="width: 30px;" />&nbsp;Years&nbsp;
                        <apex:outputLabel value=" " />
                            <apex:inputField value="{!personBeingRefRecord.Age_month__c}"
                                taborderhint="1" />&nbsp; Months &nbsp;
                        <apex:outputLabel value=" " />&nbsp;
                        <apex:inputField value="{!personBeingRefRecord.Age_days__c}" taborderhint="1" /> Days
                    </apex:outputPanel>
                    </apex:pageBlockSectionItem>
<!--                    <apex:inputField value="{!personBeingRefRecord.Level_of_Education__c}" -->
<!--                        id="levelOfEducation" -->
<!--                        required="{!AND(Referral__c.Referral_Status__c='Closed', Referral__c.Close_Reason__c='Admitted', ReferralRecordType = 'NeuroRestorative')}" /> -->

                    <apex:pageBlockSectionItem helpText="Select the person's legal gender.Gender is required to convert this referral to Admission">
                        <apex:outputLabel value="Gender" />
                        <apex:outputPanel layout="block">
                            <apex:outputPanel layout="block" />
                            <apex:inputField value="{!personBeingRefRecord.Gender__c}"
                                taborderhint="1" styleclass="refRequiedFields" />
                        </apex:outputPanel>
                    </apex:pageBlockSectionItem>


                    <!-- Removed for PRI-160   <apex:inputField value="{!personBeingRefRecord.SSN__c}" /> -->
                </apex:pageBlockSection>
                <apex:pageBlockSection showHeader="false" columns="1"
                    collapsible="false"
                    rendered="{!ISNULL(personBeingServedRecord.id)}">
                    <apex:inputField value="{!personBeingRefRecord.Additional_Information_Comments__c}"
                        taborderhint="3" style="width: 90%;" />
                </apex:pageBlockSection>



                <apex:pageBlockSection title="Contact Information" showHeader="true"
                    columns="2" collapsible="false" id="ContactSection"
                    rendered="{!ISNULL(personBeingServedRecord.id)}">
                    <apex:inputField value="{!personBeingRefRecord.Street_1__c}"
                        id="Perm_Street1" taborderhint="5" label="Mailing Street 1" />
                    <apex:inputField value="{!personBeingRefRecord.Phone__c}"
                        taborderhint="6" id="Perm_Phone" />
                    <apex:inputField value="{!personBeingRefRecord.Street_2__c}"
                        taborderhint="5" id="Perm_Street2" label="Mailing Street 2" />
                    <apex:inputField value="{!personBeingRefRecord.Email_Address__c}"
                        taborderhint="6" id="Perm_Email" label="Email" />
                    <apex:inputText value="{!personBeingRefRecord.City__c}"
                        tabindex="50" id="Perm_City" label="Mailing City" />
                    <apex:outputText value="" />
                    <apex:inputField value="{!personBeingRefRecord.State__c}"
                        taborderhint="5" id="Perm_State" label="Mailing State/Province" />
                    <apex:outputText value="" />
                    <apex:inputText value="{!personBeingRefRecord.Zip_Code__c}"
                        tabindex="50" style="width: 42px;" id="Perm_Zip"
                        label="Mailing Zip/Postal Code" />
                    <apex:outputText value="" />
                    <!--  Fax is removed for   EPRIQM-115
                <apex:inputField value="{!personBeingRefRecord.Fax__c}" id="Perm_Fax" />
                 -->
                    <apex:inputField value="{!personBeingRefRecord.Home_County__c}"
                        taborderhint="5" label="Mailing County" />
                </apex:pageBlockSection>

                <apex:pageBlockSection title="Person Being Served" showHeader="true"
                    columns="2" collapsible="false" id="readPBSSection"
                    rendered="{!!ISNULL(personBeingServedRecord.id)}">


                    <apex:outputText label="First Name"
                        value="{!personBeingServedRecord.FirstName}" />
                    <apex:outputField value="{!personBeingServedRecord.Race__c}" />

                    <apex:outputText label="Middle Name"
                        value="{!personBeingServedRecord.Middle_Name__c}" />
                    <apex:outputField value="{!personBeingServedRecord.Ethnicity_Picklist__c}" />

                    <apex:outputText label="Last Name"
                        value="{!personBeingServedRecord.LastName}" />
                    <apex:outputField value="{!personBeingServedRecord.Marital_Status__c}" />

                    <apex:outputField label="Date of Birth"
                        value="{!personBeingServedRecord.BirthDate}" />
                    <apex:pageBlockSectionItem >
                        <apex:outputLabel >Primary Language </apex:outputLabel>
                        <apex:outputPanel styleClass="nowrap">
                            <apex:outputField value="{!personBeingServedRecord.Primary_Language__c}" />&nbsp;&nbsp;
                        <apex:outputLabel value="Non-Verbal" />&nbsp;
                        <apex:outputField value="{!personBeingServedRecord.Non_Verbal__c}" />&nbsp;
                        <apex:outputLabel value="Sign Language" />&nbsp;
                        <apex:outputField value="{!personBeingServedRecord.Sign_Language__c}" />
                        </apex:outputPanel>
                    </apex:pageBlockSectionItem>

                    <apex:outputText label="Age">{!age}</apex:outputText>
<!--                    <apex:outputField value="{!personBeingServedRecord.Level_of_Education__c}" -->
<!--                        rendered="{! personBeingServedRecord.Level_of_Education__c != null}" /> -->

                    <apex:outputField value="{!personBeingServedRecord.Gender__c}" />
                </apex:pageBlockSection>

                <apex:pageBlockSection title="Contact Information" showHeader="true"
                    columns="2" collapsible="false" id="readContactSection"
                    rendered="{!!ISNULL(personBeingServedRecord.id)}">
                    <apex:outputField value="{!personBeingServedRecord.MailingStreet}"
                        id="Perm_Street1" />
                    <apex:outputField value="{!personBeingServedRecord.Phone}"
                        id="Perm_Phone" />
                    <apex:outputField value="{!personBeingServedRecord.OtherStreet}"
                        id="Perm_Street2" />
                    <apex:outputField value="{!personBeingServedRecord.Email}"
                        id="Perm_Email" />
                    <apex:pageBlockSectionItem >
                        <apex:outputText value="City" />
                        <apex:outputPanel styleClass="nowrap">
                            <apex:outputText value="{!personBeingServedRecord.MailingCity}"
                                id="Perm_City" />&nbsp;
                        <apex:outputLabel value="State" />&nbsp;
                        <apex:outputText value="{!personBeingServedRecord.MailingState}" id="Perm_State" />&nbsp;
                        <apex:outputLabel value="Zip" />&nbsp;
                        <apex:outputText value="{!personBeingServedRecord.MailingPostalCode}"
                                style="width: 42px;" id="PermZip" />
                        </apex:outputPanel>
                    </apex:pageBlockSectionItem>
                    <apex:outputField value="{!personBeingServedRecord.Fax}"
                        id="Perm_Fax" />
                </apex:pageBlockSection>

                <apex:pageblockSection columns="1"
                    title="State For Preferred Service" id="stateForPreferredService"
                    rendered="{!OR(!ISNULL(personBeingRefRecord.Id),!ISNULL(personBeingServedRecord.Id))}">
                    <apex:actionRegion >
                        <apex:inputField value="{!Referral__c.State_for_Preferred_Service__c}"
                            required="{!referralRecordType!='NeuroRestorative'}" id="sfps">
                            <apex:actionSupport status="myStatus" event="onchange"
                                oncomplete="j$('select[id$=servicesRequested]').val('');setReferralRecordType();setUpFields();"
                                rerender="placementRiskBlock, JuvBlockSection, PlacementHxBlockSection, HxBlock" />
                        </apex:inputField>
                    </apex:actionRegion>
                </apex:pageblockSection>

                <apex:pageBlockSection columns="1" title="Related Parties"
                    id="relatedParties"
                    rendered="{!OR(!ISNULL(personBeingRefRecord.Id),!ISNULL(personBeingServedRecord.Id))}">
                    <apex:pageBlockSectionItem >
                        <apex:actionRegion >
                            <apex:commandButton value="Add Related Party" id="addRelParty"
                                onClick="showAddRelParty();return false;" />
                            <apex:actionStatus id="showAddRelPartyStatus">
                                <apex:facet name="start">
                                    <apex:image height="16px" value="/img/loading32.gif"
                                        styleClass="dialogLoadingSpinner" />
                                </apex:facet>
                                <apex:facet name="stop" />
                            </apex:actionStatus>
                        </apex:actionRegion>
                    </apex:pageBlockSectionItem>

                    <apex:pageBlockTable value="{!relParties}" var="relParty">
                        <apex:column value="{!relParty.Type__c}" />
                        <apex:column value="{!relParty.Name}" />
                        <apex:column value="{!relParty.Address__c}" />
                        <apex:column value="{!relParty.Email__c}" />
                        <apex:column value="{!relParty.Phone__c}" />
                        <apex:column value="{!relParty.Phone_1_Type__c}" />
                        <apex:column value="{!relParty.Phone_2__c}" />
                        <apex:column value="{!relParty.Phone_2_Type__c}" />
                        <apex:column value="{!relParty.Status__c}" />
                        <apex:column value="{!relParty.Comments__c}" />
                        <apex:column value="{!relParty.CreatedDate}" />
                    </apex:pageBlockTable>
                    <apex:outputpanel style="display:none">
                        <apex:inputHidden value="{!relParty.Name}" id="relatedPartyName" />
                        <apex:inputHidden value="{!relParty.Type_String__c}"
                            id="relatedPartyType" />
                        <apex:inputHidden value="{!relParty.Address__c}"
                            id="relatedPartyAddress" />
                        <apex:inputHidden value="{!relParty.Email__c}"
                            id="relatedPartyEmail" />
                        <apex:inputHidden value="{!relParty.Phone__c}"
                            id="relatedPartyPhone" />
                        <apex:inputHidden value="{!relParty.Phone_1_Type_String__c}"
                            id="relatedPartyPhone_1_Type" />
                        <apex:inputHidden value="{!relParty.Phone_2__c}"
                            id="relatedPartyPhone_2" />
                        <apex:inputHidden value="{!relParty.Phone_2_Type_String__c}"
                            id="relatedPartyPhone_2_Type" />
                        <apex:inputHidden value="{!relParty.Status__c}"
                            id="relatedPartyStatus" />
                        <apex:inputHidden value="{!relParty.Comments__c}"
                            id="relatedPartyComments" />
                    </apex:outputpanel>
                    <script type="text/javascript">
                    relPartyData = '{!relPartiesJSON}';
                </script>
                </apex:pageBlockSection>

            </apex:pageBlock>

            <!-- Add Related Party modal. -->
            <apex:actionRegion >
                <apex:outputPanel id="relatedPartyModal" style="display:none">

                    <apex:actionFunction name="saveRelParty" action="{!saveRelParty}"
                        status="myStatus"
                        rerender="relatedParties,relatedPartyEntry,relatedPartyEntry2,msgs" />

                    <apex:pageBlock title="Add Related Party">
                        <apex:pageblockButtons location="bottom">
                            <apex:commandButton value="Save"
                                onClick="relatedPartySave(true); return false;" />
                            <apex:commandButton value="Save & New"
                                onClick="relatedPartySave(false);return false;" />
                            <apex:commandButton value="Cancel"
                                onClick="closeModalDialogR('relatedPartyModal', 'span'); j$('#relatedPartyErrors').html('');return false;" />
                        </apex:pageblockButtons>

                        <apex:facet name="header">
                            <p>
                                <strong>Add a related party below:</strong>
                            </p>
                        </apex:facet>

                        <div id='relatedPartyErrors' style='color: red'></div>

                        <apex:pageBlockSection columns="2" id="relatedPartyEntry">
                            <apex:inputField value="{!relParty.Name}"
                                id="relatedPartyEntry_Name" />
                            <apex:inputField value="{!relParty.Type__c}"
                                id="relatedPartyEntry_Type" />

                            <apex:inputField value="{!relParty.Address__c}"
                                id="relatedPartyEntry_Address" />
                            <apex:inputField value="{!relParty.Email__c}"
                                id="relatedPartyEntry_Email" />

                            <apex:inputField value="{!relParty.Phone__c}"
                                id="relatedPartyEntry_Phone" />
                            <apex:inputField value="{!relParty.Phone_1_Type__c}"
                                id="relatedPartyEntry_Phone_1_Type" />

                            <apex:inputField value="{!relParty.Phone_2__c}"
                                id="relatedPartyEntry_Phone_2" />
                            <apex:inputField value="{!relParty.Phone_2_Type__c}"
                                id="relatedPartyEntry_Phone_2_Type" />
                        </apex:pageBlockSection>

                        <apex:pageBlockSection columns="1" id="relatedPartyEntry2">
                            <apex:inputField value="{!relParty.Comments__c}"
                                style="width: 90%;" id="relatedPartyEntry_Comments" />
                            <apex:inputField value="{!relParty.Status__c}"
                                id="relatedPartyEntry_Status" />
                        </apex:pageBlockSection>
                    </apex:pageBlock>
                </apex:outputPanel>
            </apex:actionRegion>


            <!-- Add Agency modal. -->
            <apex:actionRegion >
                <apex:outputPanel id="agencyModal" style="display:none">

                    <apex:actionFunction name="saveAgency" action="{!saveAgency}"
                        status="myStatus" rerender="agencies,agencyEntry,msgs" />

                    <apex:pageBlock title="Add Agency Involved with Individual">
                        <apex:pageblockButtons location="bottom">
                            <apex:commandButton value="Save"
                                onclick="agencySave(true); return false;" />
                            <apex:commandButton value="Save & New"
                                onclick="agencySave(false); return false;" />
                            <apex:commandButton value="Cancel"
                                onclick="closeModalDialogR('agencyModal', 'span');j$('#agencyErrors').html('');return false;" />
                        </apex:pageblockButtons>

                        <apex:facet name="header">
                            <p>
                                <strong>Add an agency involved with the person being
                                    referred below:</strong>
                            </p>
                        </apex:facet>

                        <div id='agencyErrors' style='color: red'></div>

                        <apex:pageBlockSection columns="1" id="agencyEntry">
                            <apex:pageBlockSectionItem >
                                <apex:outputLabel value="Agency Name:" />
                                <apex:inputText value="{!agency.Name}" id="agencyEntry_Name" />
                            </apex:pageBlockSectionItem>

                            <apex:pageBlockSectionItem >
                                <apex:outputLabel value="Address:" />
                                <apex:inputTextarea value="{!agency.Address__c}"
                                    id="agencyEntry_Address" />
                            </apex:pageBlockSectionItem>
                            
                            <apex:pageBlockSectionItem >
                                <apex:outputLabel value="Email:" />
                                <apex:inputField value="{!agency.Email__c}" id="agencyEntry_Email" />
                            </apex:pageBlockSectionItem>

                            <apex:pageBlockSectionItem >
                                <apex:outputLabel value="Phone Number:" />
                                <apex:inputField value="{!agency.Phone__c}"
                                    id="agencyEntry_Phone" />
                            </apex:pageBlockSectionItem>

                            <apex:pageBlockSectionItem >
                                <apex:outputLabel value="Reason for Involvement:" />
                                <apex:inputTextarea value="{!agency.Reason_for_Involvement__c}"
                                    id="agencyEntry_Reason" />
                            </apex:pageBlockSectionItem>
                        </apex:pageBlockSection>
                    </apex:pageBlock>
                </apex:outputPanel>
            </apex:actionRegion>

            <!-- Add Funding Source modal. -->
            <apex:actionRegion >
                <apex:outputPanel id="FundingSourceModal" style="display:none">
                    <script>
                    j$(document).ready(function($) {
                        applyRulesToFundingSource = function() {
                            $(document.getElementById('{!$Component.FundingSourceModal}')).find('input').on("change", function(event) {
                                applyRulesToField(event.target);
                            });
                            $(document.getElementById('{!$Component.FundingSourceModal}')).find('select').on("change", function(event) {
                                applyRulesToField(event.target);
                            });
                            $(document.getElementById('{!$Component.FundingSourceModal}')).find('input').each(function(_, target) {
                                applyRulesToField(target);
                            });
                            $(document.getElementById('{!$Component.FundingSourceModal}')).find('select').each(function(_, target) {
                                applyRulesToField(target);
                            });
                        };
                    });
                </script>

                    <apex:actionFunction name="saveFundingSource"
                        status="saveFundingSourceStatus" action="{!saveFundingSource}"
                        oncomplete="fundingSourceScrollToTop(true); if (closeFundingSource) closeModalDialogR('FundingSourceModal', 'span');"
                        rerender="fundingSources,fundingSourcePayerDetailEntry,fundingSourceRedFlagsEntry,fundingSourceAuthorizationDetailEntry,fundingSourceEntry,msgs" />

                    <div id='fundingMessages'></div>
                    <apex:pageBlock title="Add Funding Source"
                        rendered="{!ReferralRecordType != 'CareMeridian' && ReferralRecordType != 'NeuroRestorative' && ReferralRecordType !='Adult Day Health'}">
                        <apex:pageBlockSection columns="1" id="fundingSourceEntry">
                            <apex:inputField value="{!fundingSource.Funding_Source__c}"
                                id="fundingEntry_Source" />
                            <apex:inputField value="{!fundingSource.Funding_Source_ID__c}"
                                id="fundingEntry_SourceId" />
                            <apex:inputField value="{!fundingSource.Service_Being_Funded__c}"
                                id="fundingEntry_Service"
                                rendered="{!ReferralRecordType!='CareMeridian'}" />
                            <apex:inputField value="{!fundingSource.Payor__c}"
                                id="fundingEntry_Payor"
                                rendered="{!ReferralRecordType=='CareMeridian'}" />
                            <apex:inputField value="{!fundingSource.Status__c}"
                                id="fundingEntry_Status" />
                            <apex:inputField value="{!fundingSource.Comment__c}"
                                id="fundingEntry_comment" />
                            <apex:inputHidden value="{!fundingSource.Id}"
                                id="fundingEntry_Id" rendered="{!!ISBLANK(fundingSource.Id)}" />
                        </apex:pageBlockSection>
                    </apex:pageBlock>
                    <apex:pageBlock title="Payer Detail"
                        id="fundingSourcePayerDetailEntry"
                        rendered="{!ReferralRecordType == 'CareMeridian' || ReferralRecordType == 'NeuroRestorative' || ReferralRecordType =='Adult Day Health'}">
                        <apex:outputText value="{!hasPrimaryFS}" id="hasPrimaryFS"
                            style="display:none;"/ >
                            <apex:pageBlockSection columns="2"
                                rendered="{!ReferralRecordType == 'CareMeridian'}">
                                <apex:outputText label="Full Name"
                                    value="{!IF(ISBLANK(personBeingRefRecord.Middle_Initial__c),personBeingRefRecord.First_Name__c &' '&personBeingRefRecord.Last_Name__c, personBeingRefRecord.First_Name__c &' ' &personBeingRefRecord.Middle_Initial__c &' '& personBeingRefRecord.Last_Name__c)}" />
                                <!-- <apex:outputField value="{!personBeingRefRecord.Date_of_Birth__c}" /> -->
                                <apex:outputText label="Date of Birth"
                                    value="{0, date, MM/dd/yyyy} ({!age})">
                                    <apex:param value="{!personBeingRefRecord.Date_of_Birth__c}" />
                                </apex:outputText>
                                <apex:inputField value="{!fundingSource.Type_of_Coverage__c}" />
                                <apex:pageBlockSectionItem />
                                <apex:inputField value="{!fundingSource.Payer_Name__c}" />
                                <apex:inputField value="{!fundingSource.Payer_Phone__c}" />
                                <apex:inputField value="{!fundingSource.TPA__c}" />
                                <apex:inputField value="{!fundingSource.TPA_Phone__c}" />
                                <apex:inputField value="{!fundingSource.Primary_Med_Ind_Phys_Group__c}" />
                                <apex:inputField value="{!fundingSource.Primary_Med_Ind_Phys_Group_Phone__c}" />
                                <apex:inputField value="{!fundingSource.Network__c}" />
                                <apex:inputField value="{!fundingSource.Network_Phone__c}" />
                                <apex:inputField value="{!fundingSource.Verified_By__c}" />
                                <apex:inputField value="{!fundingSource.Payer_Verification_Date__c}" />
                                <apex:inputField value="{!fundingSource.Verified_With__c}" />
                                <apex:inputField value="{!fundingSource.Representing__c}" />
                                <apex:inputField value="{!fundingSource.Funding_Source__c}"
                                    label="Payer Type" />
                                <apex:inputField value="{!fundingSource.Call_Reference_Number__c}" />
                                <apex:inputField value="{!fundingSource.Policy_Type__c}" />
                                <apex:inputField value="{!fundingSource.Policy_Number__c}" />
                                <apex:inputField value="{!fundingSource.Group_Name__c}" />
                                <apex:inputField value="{!fundingSource.Group_Number__c}" />
                                <apex:inputField value="{!fundingSource.Policy_Holder__c}" />
                                <apex:inputField value="{!fundingSource.Relationship_To_Patient__c}"
                                    id="policyHolderRelationship" />
                            </apex:pageBlockSection>
                            <apex:pageBlockSection columns="2"
                                rendered="{!ReferralRecordType == 'NeuroRestorative' || ReferralRecordType =='Adult Day Health'}">
                                <apex:outputText label="Full Name"
                                    value="{!IF(ISBLANK(personBeingRefRecord.Middle_Initial__c),personBeingRefRecord.First_Name__c &' '&personBeingRefRecord.Last_Name__c, personBeingRefRecord.First_Name__c &' ' &personBeingRefRecord.Middle_Initial__c &' '& personBeingRefRecord.Last_Name__c)}" />
                                <!-- <apex:outputField value="{!personBeingRefRecord.Date_of_Birth__c}" /> -->
                                <apex:outputText label="Date of Birth"
                                    value="{0, date, MM/dd/yyyy} ({!age})">
                                    <apex:param value="{!personBeingRefRecord.Date_of_Birth__c}" />
                                </apex:outputText>
                                <apex:inputField value="{!fundingSource.Type_of_Coverage__c}"
                                    id="fundingEntry_coverage" />
                                <apex:inputField value="{!fundingSource.Payer_Type__c}"
                                    id="neuroPayerType"
                                    html-data-rules="{&quot;VA - Pilot&quot;: [&quot;{!$Component.vaPilotClinicalNumber}&quot;]}" />
                                <apex:pageBlockSectionItem rendered="{!!(ReferralRecordType ='Adult Day Health')}"/>
                                <apex:inputField value="{!fundingSource.VA_Pilot_Clinical_Number__c}"
                                    id="vaPilotClinicalNumber" rendered="{!!(ReferralRecordType ='Adult Day Health')}"/>
                                <apex:inputField value="{!fundingSource.Payer_Name__c}" />
                                <apex:inputField value="{!fundingSource.Payer_Phone__c}" />
                                <apex:pageBlockSectionItem >
                                    <apex:outputLabel for="policyHolder" value="Policy Holder" />
                                    <apex:outputPanel >
                                        <apex:inputField value="{!fundingSource.Policy_Holder__c}"
                                            id="policyHolder" />
                                        <apex:commandLink value="Same as PBR"
                                            onclick="assignValue('{!$Component.policyHolder}', '{!IF(ISBLANK(personBeingRefRecord.Middle_Initial__c),personBeingRefRecord.First_Name__c &' '&personBeingRefRecord.Last_Name__c, personBeingRefRecord.First_Name__c &' ' &personBeingRefRecord.Middle_Initial__c &' '& personBeingRefRecord.Last_Name__c)}'); return false;" />
                                    </apex:outputPanel>
                                </apex:pageBlockSectionItem>
                                <apex:inputField value="{!fundingSource.Relationship_To_Patient__c}" />
                                <!--  Removed for PRI-160
                        <apex:pageBlockSectionItem >
                            <apex:outputLabel for="insuredSSN" value="Insured SSN" />
                            <apex:outputPanel >
                                <apex:inputField value="{!fundingSource.Insured_SSN__c}" id="insuredSSN" />
                                <apex:commandLink value="Same as PBR" onclick="assignValue('{!$Component.insuredSSN}', '{!personBeingRefRecord.SSN__c}'); return false;" />
                            </apex:outputPanel>
                        </apex:pageBlockSectionItem>
                  -->
                                <apex:pageBlockSectionItem >
                                    <apex:outputLabel for="insuredDOB" value="Insured DOB" />
                                    <apex:outputPanel >
                                        <apex:inputField value="{!fundingSource.Insured_DOB__c}"
                                            id="insuredDOB" />
                                        <apex:commandLink value="Same as PBR"
                                            onclick="assignValue('{!$Component.insuredDOB}', '{!personBeingRefRecord.Date_of_Birth__c}'); return false;" />
                                    </apex:outputPanel>
                                </apex:pageBlockSectionItem>
                                <apex:inputField value="{!fundingSource.Policy_Number__c}" />
                                <apex:inputField value="{!fundingSource.Group_Number__c}" />
                            </apex:pageBlockSection>
                            <apex:pageBlockSection columns="1"
                                rendered="{!ReferralRecordType == 'CareMeridian'}">
                                <apex:inputField value="{!fundingSource.Additional_Coverage__c}"
                                    id="additionalCoverage" />
                                <apex:inputTextarea value="{!fundingSource.Additional_Coverage_Comments__c}"
                                    id="additionalCoverageDetail" label="" cols="80" />
                            </apex:pageBlockSection>
                            <apex:pageBlockSection columns="2"
                                rendered="{!ReferralRecordType == 'CareMeridian'}">
                                <apex:outputText value="Benefit Information"
                                    styleClass="modalSubheader" />
                                <apex:pageBlockSectionItem />
                                <apex:inputField value="{!fundingSource.Effective_Date__c}" />
                                <apex:inputField value="{!fundingSource.Termination_Date__c}" />
                                <apex:inputField value="{!fundingSource.Benefit_Cycle__c}" />
                                <apex:pageBlockSectionItem />
                                <apex:inputField value="{!fundingSource.Benefit_Year_Start_Date__c}" />
                                <apex:inputField value="{!fundingSource.Benefit_Year_End_Date__c}" />
                                <apex:inputField value="{!fundingSource.Deductible__c}" />
                                <apex:inputField value="{!fundingSource.Deductible_Met__c}" />
                                <apex:inputField value="{!fundingSource.Rate_of_Reimbursement__c}" />
                                <apex:inputField value="{!fundingSource.RoR_to_100_after_met_OOP_Max__c}"
                                    label="Rate of Reimbursement changes to 100% after OOP Max is met?" />
                                <apex:inputField value="{!fundingSource.OOP_Expense__c}" />
                                <apex:inputField value="{!fundingSource.OOP_Expense_Met__c}" />
                                <apex:inputField value="{!fundingSource.Deductible_Applicable_to_OOP__c}" />
                                <apex:pageBlockSectionItem />
                                <apex:inputField value="{!fundingSource.Lifetime_Max__c}" />
                                <apex:inputField value="{!fundingSource.Lifetime_Max_Met__c}" />


                                <apex:inputField value="{!fundingSource.Copay__c}" />
                                <apex:inputText value="{!fundingSource.Qualifying_Stay_Criteria__c}"
                                    label="Qualifying Stay Criteria" />
                                <apex:inputField label="Day Total" value="{!fundingSource.SNF_Day_Total__c}" />
                                <apex:inputField label="Days Used" value="{!fundingSource.SNF_Days_Used__c}" />
                                <apex:inputField label="Precert Required" value="{!fundingSource.Precert_Required__c}" />
                                <apex:pageBlockSectionItem />

                                <apex:outputText value="Acute Rehab" styleClass="modalSubheader" />
                                <apex:pageBlockSectionItem />
                                <apex:inputField value="{!fundingSource.ARU_Day_Total__c}" />
                                <apex:inputField value="{!fundingSource.ARU_Days_Used__c}" />

                                <apex:outputText value="Home Health" styleClass="modalSubheader" />
                                <apex:pageBlockSectionItem />
                                <apex:inputField value="{!fundingSource.HH_Visits_Total__c}" />
                                <apex:inputField value="{!fundingSource.HH_Visits_Used__c}" />

                                <apex:outputText value="DME" styleClass="modalSubheader" />
                                <apex:pageBlockSectionItem />
                                <apex:inputText value="{!fundingSource.DME_Benefits__c}"
                                    label="DME Benefits" />
                                <apex:inputField value="{!fundingSource.DME_Maximum__c}" />
                                <apex:inputField value="{!fundingSource.DME_Precert_Required__c}" />
                                <apex:pageBlockSectionItem />

                                <apex:outputText value="Transportation"
                                    styleClass="modalSubheader" />
                                <apex:pageBlockSectionItem />
                                <apex:inputText value="{!fundingSource.Transportation_Benefits__c}"
                                    label="Transportation Benefits" />
                                <apex:inputField value="{!fundingSource.Transportation_Maximum__c}" />
                                <apex:inputField value="{!fundingSource.Transportation_Precert_Required__c}" />
                                <apex:pageBlockSectionItem />

                                <apex:inputField value="{!fundingSource.Precert_Company__c}" />
                                <apex:inputField value="{!fundingSource.SNF_Phone__c}"
                                    label="Precert Company Phone" />
                                <apex:inputField value="{!fundingSource.SNF_Fax__c}" label="Fax" />
                                <apex:pageBlockSectionItem />

                                <apex:outputText value="Claims Submission"
                                    styleClass="modalSubheader" />
                                <apex:pageBlockSectionItem />
                                <apex:inputField value="{!fundingSource.Claims_Submission_Company__c}"
                                    label="Company" />
                                <apex:pageBlockSectionItem />
                                <apex:inputField value="{!fundingSource.Claims_Submission_Street_1__c}"
                                    label="Street 1" />
                                <apex:inputField value="{!fundingSource.Claims_Submission_Phone__c}"
                                    label="Phone" />
                                <apex:inputField value="{!fundingSource.Claims_Submission_Street_2__c}"
                                    label="Street 2" />
                                <apex:inputField value="{!fundingSource.Claims_Submission_Email__c}"
                                    label="Email Address" id="claimsSubmissionEmail" />
                                <apex:inputField value="{!fundingSource.Claims_Submission_City__c}" label="City" />
                                <apex:inputField value="{!fundingSource.Claims_Submission_Fax__c}" label="Fax" />
                                <apex:inputField value="{!fundingSource.Claims_Submission_State__c}"
                                    label="State" />
                                <apex:pageBlockSectionItem />
                                <apex:inputField value="{!fundingSource.Claims_Submission_Zip__c}"
                                    id="Claims_Submission_Zip" label="Zip" />
                            </apex:pageBlockSection>
                            <apex:pageBlockSection columns="2"
                                rendered="{!ReferralRecordType == 'NeuroRestorative'}">
                                <apex:outputText value="Benefit Information"
                                    styleClass="modalSubheader" />
                                <apex:pageBlockSectionItem />
                                <apex:inputField value="{!fundingSource.Benefit_Cycle__c}" />
                                <apex:pageBlockSectionItem />
                                <apex:inputField value="{!fundingSource.Effective_Date__c}" />
                                <apex:inputField value="{!fundingSource.Termination_Date__c}" />
                                <apex:inputField value="{!fundingSource.Copay__c}" />
                                <apex:pageBlockSectionItem />
                                <apex:inputField value="{!fundingSource.In_patient_Benefits_Limit__c}" />
                                <apex:inputField value="{!fundingSource.Out_patient_Visit_Limit__c}" />
                                <apex:inputField value="{!fundingSource.Deductible__c}" />
                                <apex:inputField value="{!fundingSource.Deductible_Met__c}" />
                                <apex:inputField value="{!fundingSource.Rate_of_Reimbursement__c}" />
                                <apex:inputField value="{!fundingSource.RoR_to_100_after_met_OOP_Max__c}"
                                    label="Rate of Reimbursement changes to 100% after OOP Max is met?" />


                                <apex:inputField label="Day Total" value="{!fundingSource.SNF_Day_Total__c}" />
                                <apex:inputField label="Days Used" value="{!fundingSource.SNF_Days_Used__c}" />
                                <apex:pageBlockSectionItem />
                                <apex:inputField label="Precert Required" value="{!fundingSource.Precert_Required__c}" />
                                <apex:inputField value="{!fundingSource.Precert_Company__c}" />
                                <apex:inputField value="{!fundingSource.SNF_Phone__c}"
                                    label="Precert Company Phone" />
                                <apex:inputField value="{!fundingSource.SNF_Fax__c}" label="Fax" />
                                <apex:pageBlockSectionItem />

                                <apex:outputText value="Claims Submission"
                                    styleClass="modalSubheader" />
                                <apex:pageBlockSectionItem />
                                <apex:inputField value="{!fundingSource.Claims_Submission_Company__c}"
                                    label="Company" />
                                <apex:pageBlockSectionItem />
                                <apex:inputField value="{!fundingSource.Claims_Submission_Street_1__c}"
                                    label="Street 1" />
                                <apex:inputField value="{!fundingSource.Claims_Submission_Phone__c}"
                                    label="Phone" />
                                <apex:inputField value="{!fundingSource.Claims_Submission_Street_2__c}"
                                    label="Street 2" />
                                <apex:inputField value="{!fundingSource.Claims_Submission_Email__c}"
                                    label="Email Address" id="claimsSubmissionEmail" />
                                <apex:inputField value="{!fundingSource.Claims_Submission_City__c}" label="City" />
                                <apex:inputField value="{!fundingSource.Claims_Submission_Fax__c}" label="Fax" />
                                <apex:inputField value="{!fundingSource.Claims_Submission_State__c}"
                                    label="State" />
                                <apex:pageBlockSectionItem />
                                <apex:inputField value="{!fundingSource.Claims_Submission_Zip__c}"
                                    id="Claims_Submission_Zip" label="Zip" />
                            </apex:pageBlockSection>
                            <apex:pageBlockSection columns="2"
                                rendered="{!ReferralRecordType == 'Adult Day Health'}">
                                <apex:outputText value="Claims Submission"
                                    styleClass="modalSubheader" />
                                <apex:pageBlockSectionItem />
                                <apex:inputField value="{!fundingSource.Claims_Submission_Company__c}"
                                    label="Company" />
                                <apex:pageBlockSectionItem />
                                <apex:inputField value="{!fundingSource.Claims_Submission_Street_1__c}"
                                    label="Street 1" />
                                <apex:inputField value="{!fundingSource.Claims_Submission_Phone__c}"
                                    label="Phone" />
                                <apex:inputField value="{!fundingSource.Claims_Submission_Street_2__c}"
                                    label="Street 2" />
                                <apex:inputField value="{!fundingSource.Claims_Submission_Email__c}"
                                    label="Email Address" id="claimsSubmissionEmail" />
                                <apex:inputField value="{!fundingSource.Claims_Submission_City__c}" label="City" />
                                <apex:inputField value="{!fundingSource.Claims_Submission_Fax__c}" label="Fax" />
                                <apex:inputField value="{!fundingSource.Claims_Submission_State__c}"
                                    label="State" />
                                <apex:pageBlockSectionItem />
                                <apex:inputField value="{!fundingSource.Claims_Submission_Zip__c}"
                                    id="Claims_Submission_Zip" label="Zip" />
                            </apex:pageBlockSection>
                    </apex:pageBlock>
                    <apex:pageBlock title="Red Flags" id="fundingSourceRedFlagsEntry"
                        rendered="{!ReferralRecordType == 'CareMeridian' || ReferralRecordType == 'NeuroRestorative'}">
                        <apex:pageBlockSection columns="2"
                            rendered="{!ReferralRecordType == 'CareMeridian'}">
                            <apex:inputField value="{!fundingSource.Month_to_Month__c}"
                                id="field_validation1" />
                            <apex:inputField value="{!fundingSource.Basis__c}"
                                id="field_check1" />
                            <apex:inputField value="{!fundingSource.Cobra__c}"
                                id="field_validation2" />
                            <apex:inputField value="{!fundingSource.Payment_Detail__c}"
                                id="field_check2" />
                            <apex:inputField value="{!fundingSource.Individual_Plan__c}"
                                id="field_validation3" />
                            <apex:inputField value="{!fundingSource.Continued_Payment__c}"
                                id="field_check3" />
                            <apex:inputField value="{!fundingSource.Under_Pre_Existing_Period__c}"
                                id="field_validation4" />
                            <apex:inputField value="{!fundingSource.Dx_Pre_Existing__c}"
                                id="field_check4" />
                            <apex:inputField value="{!fundingSource.Self_Inflicted__c}"
                                id="field_validation5" />
                            <apex:inputField value="{!fundingSource.Covered__c}"
                                id="field_check5" />
                            <apex:inputField value="{!fundingSource.Readmission__c}"
                                id="field_validation6" />
                            <apex:inputField value="{!fundingSource.Prior_Pmt_Received__c}"
                                id="field_check6" />
                            <apex:inputField value="{!fundingSource.Swing_Bed_Billing_at_SNF_Rate__c}"
                                id="field_validation7" />
                            <apex:inputField value="{!fundingSource.Number_of_Days__c}"
                                id="field_check7" />
                            <apex:inputField value="{!fundingSource.Medicare_is_Secondary_Coverage__c}" />
                            <apex:pageBlockSectionItem />
                            <apex:inputField value="{!fundingSource.Patient_Over_26_and_On_Parent_s_Policy__c}" />
                            <apex:inputField value="{!fundingSource.Coverage_Details__c}" />
                            <apex:inputField value="{!fundingSource.Is_patient_policy_holder__c}" />
                            <apex:inputField value="{!fundingSource.Can_Patient_Return_to_Work__c}"
                                id="canPatientReturnToWork"
                                label="If Yes, Can Patient Return to Work?" />
                            <apex:pageBlockSectionItem />
                            <apex:inputField value="{!fundingSource.Patient_Has_Policy__c}"
                                id="patientHasPolicy" label="If No, Does Patient Have Policy?" />
                            <apex:pageBlockSectionItem />
                            <apex:inputField value="{!fundingSource.Does_PH_Plan_to_Continue_Working__c}"
                                label="If No, Does PH Plan to Continue Working?" />

                            <apex:outputText >
                                <div class="modalSubheader">
                                    Medicare Eligibility
                                    <c:HelpTooltip helpText="If any of the following check boxes are selected, patient is Medicare eligible." />
                                </div>
                            </apex:outputText>
                            <apex:pageBlockSectionItem />
                            <apex:inputField value="{!fundingSource.More_than_1_5_Yrs_of_Disability__c}"
                                id="yearsOfDisability" />
                            <apex:pageBlockSectionItem />
                            <apex:inputField value="{!fundingSource.ALS_ESRD_Black_Lung_Disease__c}" />
                            <apex:pageBlockSectionItem />
                            <apex:inputField value="{!fundingSource.Patient_Over_64_Years_of_Age__c}" />

                            <apex:pageBlockSectionItem />
                        </apex:pageBlockSection>
                        <apex:pageBlockSection columns="2"
                            rendered="{!ReferralRecordType == 'NeuroRestorative' || ReferralRecordType =='Adult Day Health'}">
                            <apex:inputField value="{!fundingSource.Cobra__c}"
                                id="field_validation20" />
                            <apex:inputField value="{!fundingSource.Payment_Detail__c}"
                                id="field_check20" />
                            <apex:inputField value="{!fundingSource.Self_Inflicted__c}"
                                id="field_validation21" />
                            <apex:inputField value="{!fundingSource.Covered__c}"
                                id="field_check21" />
                            <apex:inputField value="{!fundingSource.Self_Insured_Policy__c}" />
                            <apex:pageBlockSectionItem />
                            <apex:inputField value="{!fundingSource.Did_drugs_alcohol_contribute_to_injury__c}"
                                id="field_validation22" />
                            <apex:inputField value="{!fundingSource.Are_injuries_covered__c}"
                                id="field_check22" />
                        </apex:pageBlockSection>
                        <apex:pageBlockSection columns="1"
                            rendered="{!ReferralRecordType == 'CareMeridian'}">
                            <apex:inputTextArea value="{!fundingSource.Comment__c}"
                                label="Additional Comments" cols="80" />
                        </apex:pageBlockSection>
                        <apex:pageBlockSection columns="1"
                            rendered="{!ReferralRecordType == 'NeuroRestorative' || ReferralRecordType =='Adult Day Health'}">
                            <apex:inputTextArea value="{!fundingSource.Comment__c}"
                                label="Red Flag Comments" cols="80" />
                        </apex:pageBlockSection>
                    </apex:pageBlock>

                    <apex:pageBlock title="Authorization Detail"
                        id="fundingSourceAuthorizationDetailEntry"
                        rendered="{!ReferralRecordType == 'CareMeridian' || ReferralRecordType == 'NeuroRestorative' || ReferralRecordType =='Adult Day Health'}">
                        <apex:pageBlockSection columns="2"
                            rendered="{!ReferralRecordType == 'CareMeridian'}">
                            <apex:pageBlockSectionItem >
                                <apex:outputlabel for="authtype" value="Authorization Type" />
                                <apex:outputpanel >
                                    <apex:actionRegion >
                                        <apex:inputField id="authtype"
                                            value="{!fundingSource.Authorization_Type__c}">
                                            <apex:actionSupport event="onchange"
                                                rerender="otherauthtypeblock" status="authtypestatus" />
                                        </apex:inputField>
                                        <apex:actionStatus id="authtypestatus">
                                            <apex:facet name="start">
                                                <apex:image height="16px" value="/img/loading32.gif"
                                                    styleClass="dialogLoadingSpinner" />
                                            </apex:facet>
                                            <apex:facet name="stop" />
                                        </apex:actionStatus>
                                    </apex:actionRegion>
                                    <br />
                                    <apex:outputpanel id="otherauthtypeblock">
                                        <apex:inputfield id="otherauthtype"
                                            value="{!fundingSource.Other_Authorization_Type__c}"
                                            required="{!fundingSource.Authorization_Type__c=='Other'}"
                                            rendered="{!fundingSource.Authorization_Type__c == 'Other'}" />
                                    </apex:outputpanel>
                                </apex:outputpanel>
                            </apex:pageBlockSectionItem>

                            <apex:inputField value="{!fundingSource.Status__c}" />

                            <apex:outputText value="Request" styleClass="modalSubheader" />
                            <apex:pageBlockSectionItem />
                            <apex:inputField value="{!fundingSource.Requested_By__c}" />
                            <apex:inputField value="{!fundingSource.Request_Date__c}" />
                            <apex:inputField value="{!fundingSource.Request_Contact_Name__c}" />
                            <apex:inputField value="{!fundingSource.Representing_Request__c}" />
                            <apex:inputField value="{!fundingSource.Reference_Number__c}" />
                            <apex:inputField value="{!fundingSource.Review_Nurse__c}" />
                            <apex:inputField value="{!fundingSource.Request_Phone__c}"
                                label="Phone" />
                            <apex:inputField value="{!fundingSource.Request_Fax__c}"
                                label="Fax" />

                            <apex:outputText value="Received" styleClass="modalSubheader" />
                            <apex:pageBlockSectionItem />
                            <apex:inputField value="{!fundingSource.Service_Being_Funded_String__c}"
                                label="Item/Service" />
                            <apex:inputField value="{!fundingSource.Authorization_Number__c}" />
                            <apex:inputField value="{!fundingSource.Rate__c}" />

                            <apex:pageBlockSectionItem >
                                <apex:outputLabel value="Date/Time Auth Received" />
                                <apex:outputPanel layout="none">
                                    <c:MilitaryDatetime id="authreceived"
                                        datetimeval="{!fundingSource.Received_Date_Time__c}"
                                        edit="true" hiddenFieldId="authrec" datetimepickerid="authrec" />
                                    <apex:inputHidden id="authrec"
                                        value="{!fundingSource.Received_Date_Time__c}" />
                                </apex:outputPanel>
                            </apex:pageBlockSectionItem>
                            <apex:inputField value="{!fundingSource.Rate_unit__c}" />
                            <apex:inputField value="{!fundingSource.Days_Authorized_From__c}"
                                label="Effective Date" />
                            <apex:inputField id="contractused"
                                value="{!fundingSource.CM_Contract_Used_Lookup__c}" />
                            <apex:inputField value="{!fundingSource.Days_Authorized_To__c}"
                                label="Review Date" />
                            <apex:inputField value="{!fundingSource.Level__c}" />
                            <apex:inputField value="{!fundingSource.Given_By__c}"
                                label="Authorization Given By" />
                            <apex:inputField value="{!fundingSource.Justification__c}"
                                label="Justification for Level/Rate " />
                            <apex:inputField value="{!fundingSource.Representing_Received__c}"
                                label="Representing (Given)" />
                            <apex:pageblocksectionitem />
                            <apex:inputField value="{!fundingSource.Taken_By__c}"
                                label="Authorization Taken By" />
                            <apex:pageblocksectionitem />
                            <apex:inputField value="{!fundingSource.Auth_given_method__c}"
                                Label="How Given" />


                        </apex:pageBlockSection>
                        <apex:inputHidden id="contractused_lkid" />
                        <apex:pageBlockSection columns="2"
                            rendered="{!ReferralRecordType == 'NeuroRestorative' || ReferralRecordType =='Adult Day Health'}">
                            <apex:inputField value="{!fundingSource.Status__c}" />
                            <apex:pageBlockSectionItem />
                            <apex:outputText value="Request" styleClass="modalSubheader" />
                            <apex:pageBlockSectionItem />
                            <apex:inputField value="{!fundingSource.Requested_By__c}" />
                            <apex:inputField value="{!fundingSource.Request_Date__c}" />
                            <apex:inputField value="{!fundingSource.Request_Contact_Name__c}" />
                            <apex:inputField value="{!fundingSource.Representing_Request__c}" rendered="{!ReferralRecordType =='Adult Day Health'}"/>
                            <!--<apex:inputField value="{!fundingSource.Reference_Number__c}" rendered="{!ReferralRecordType =='Adult Day Health'}"/>
                            <apex:inputField value="{!fundingSource.Review_Nurse__c}" rendered="{!ReferralRecordType =='Adult Day Health'}"/> -->
                            <apex:pageBlockSectionItem rendered="{!ReferralRecordType == 'NeuroRestorative'}"/>
                            <apex:inputField value="{!fundingSource.Request_Phone__c}"
                                label="Phone" />
                            <apex:inputField value="{!fundingSource.Request_Fax__c}"
                                label="Fax" />

                            <apex:outputText value="Received" styleClass="modalSubheader" />
                            <apex:pageBlockSectionItem />
                            <apex:inputField value="{!fundingSource.Given_By__c}" />
                            <apex:inputField value="{!fundingSource.Authorization_Number__c}" />
                            <apex:inputField value="{!fundingSource.Days_Authorized__c}" />
                            <apex:inputField value="{!fundingSource.Days_Authorized_Per_Week__c}" rendered="{!ReferralRecordType =='Adult Day Health'}"/>
                            <apex:pageBlockSectionItem rendered="{!ReferralRecordType == 'NeuroRestorative'}"/>
                            <apex:inputField value="{!fundingSource.Days_Authorized_From__c}" />
                            <apex:inputField value="{!fundingSource.Days_Authorized_To__c}" />
                            <apex:inputField value="{!fundingSource.Received_Rate__c}"
                                label="Rate" />
                            <apex:inputField value="{!fundingSource.Negotiated_Rate__c}" />
                            <apex:inputField value="{!fundingSource.Internal_Contact__c}" />
                            <apex:inputField value="{!fundingSource.Internal_Phone__c}" />
                            <apex:inputField value="{!fundingSource.Internal_Fax__c}" />
                            <apex:inputField value="{!fundingSource.Internal_Email__c}"
                                id="payerCmEmail" />
                            <apex:inputField value="{!fundingSource.NR_CM_Name__c}" rendered="{!!(ReferralRecordType ='Adult Day Health')}"/>
                            <apex:inputField value="{!fundingSource.NR_CM_Phone__c}" rendered="{!!(ReferralRecordType ='Adult Day Health')}"/>
                            <apex:inputField value="{!fundingSource.NR_CM_Fax__c}" rendered="{!!(ReferralRecordType ='Adult Day Health')}"/>
                            <apex:inputField value="{!fundingSource.NR_CM_Email__c}"
                                id="nrCmEmail" rendered="{!!(ReferralRecordType ='Adult Day Health')}"/>
                            <apex:inputField value="{!fundingSource.Adjuster_Name__c}" />
                            <apex:inputField value="{!fundingSource.Adjuster_Company__c}" />
                            <apex:inputField value="{!fundingSource.Adjuster_Phone__c}" />
                            <apex:inputField value="{!fundingSource.Adjuster_Fax__c}" />
                            <apex:inputField value="{!fundingSource.Adjuster_Email__c}"
                                id="adjuterEmail" />
                        </apex:pageBlockSection>
                        <apex:pageBlockSection columns="1">
                            <apex:inputTextArea value="{!fundingSource.Authorization_Comments__c}"
                                label="Authorization Comments" cols="80" />
                        </apex:pageBlockSection>
                    </apex:pageBlock>
                    <apex:pageBlock >
                        <apex:pageblockButtons location="bottom">
                            <apex:actionStatus id="saveFundingSourceStatus">
                                <apex:facet name="start">
                                    <apex:outputPanel >
                                        <apex:commandButton value="Saving..." disabled="true" />
                                        <apex:commandButton value="Saving..." disabled="true" />
                                        <apex:commandButton value="Saving..." disabled="true" />
                                    <apex:image height="16px" value="/img/loading32.gif" styleClass="dialogLoadingSpinner" />
                                    </apex:outputPanel>
                                </apex:facet>
                                <apex:facet name="stop">
                                    <apex:outputPanel >
                                        <apex:commandButton value="Save"
                                                            onclick="fundingSourceSave(true); return false;" />
                                        <apex:commandButton value="Save & New"
                                                            onclick="fundingSourceSave(false); return false;" />
                                        <apex:commandButton value="Cancel"
                                                            onclick="closeModalDialogR('FundingSourceModal', 'span');j$('#fundingMessages').html('');return false;" />
                                    </apex:outputPanel>
                                </apex:facet>
                            </apex:actionStatus>
                        </apex:pageblockButtons>
                    </apex:pageBlock>
                </apex:outputPanel>
            </apex:actionRegion>

            <!-- Add Referral Location modal. -->
            <apex:actionRegion >
                <apex:outputPanel id="ReferralLocationModal" style="display:none">

                    <apex:actionFunction name="saveLocation" action="{!saveLocation}"
                        status="myStatus"
                        rerender="locations,locationEntry,msgs,hasNonClosedPrimaryLocation"
                        oncomplete="j$('input[id$=locationEntry_ServiceLocation]').val(''); clearLink(); return false;" />

                    <apex:pageBlock title="Add Location">
                        <apex:pageblockButtons location="bottom">
                            <apex:commandButton value="Save"
                                onclick="locationSave(true); return false;" />
                            <apex:commandButton value="Save & New"
                                onclick="locationSave(false); return false;" />
                            <apex:commandButton value="Cancel"
                                onclick="closeModalDialogR('ReferralLocationModal', 'span');j$('#locationErrors').html('');return false;" />
                        </apex:pageblockButtons>

                        <apex:facet name="header">
                            <p>
                                <strong>Add Referral Location:</strong>
                            </p>
                        </apex:facet>
                        <div id='locationErrors' style='color: red'></div>
                        <apex:pageBlockSection columns="1" id="locationEntry">
                            <!-- Added by Kossi 06/06/13 2:00 AM -->
                            <apex:pageBlockSectionItem >
                                <apex:outputLabel value="Alias" />
                                <apex:pageBlockSectionItem >
                                    <apex:inputText html-readonly="true"
                                        id="locationEntry_ServiceLocation"
                                        value="{!searchedServiceLocationName}" size="20" />
                                    <a id="aliaslookup" onClick="locationLookup();"><img
                                        valign="bottom" src="/s.gif"
                                        alt="Service Location Lookup (New Window)" class="lookupIcon"
                                        onblur="this.className = 'lookupIcon';"
                                        onfocus="this.className = 'lookupIconOn';"
                                        onmouseout="this.className = 'lookupIcon';"
                                        onmouseover="this.className = 'lookupIconOn';"
                                        title="Service Location Lookup (New Window)" /> </a>
                                </apex:pageBlockSectionItem>
                            </apex:pageBlockSectionItem>

                            <apex:inputHidden id="locationEntry_ServiceLocation_lkid"
                                value="{!searchedServiceLocationId}" />

                            <apex:inputField value="{!location.User_Assigned__c}"
                                id="locationEntry_User"
                                rendered="{! referralRecordType != 'CareMeridian'}" />
                            <apex:inputField value="{!location.Rank__c}"
                                id="locationEntry_Rank"
                                rendered="{! referralRecordType == 'CareMeridian' || referralRecordType == 'NeuroRestorative'}" />
                            <apex:inputField value="{!location.Status__c}"
                                id="locationEntry_Status" />
                            <apex:inputHidden value="{!location.Service_Location__c}"
                                id="locationServiceLocation" />
                        </apex:pageBlockSection>
                    </apex:pageBlock>
                </apex:outputPanel>
            </apex:actionRegion>

            <!-- Added by Kossi 06/06/13 2:00 AM -->
            <apex:actionregion >
                <apex:outputPanel id="searchDialog" style="display:none">
                    <apex:pageBlock id="block">
                        <apex:pageblockButtons location="top">
                            <input type="button" class="btn" value="Cancel"
                                onclick="closeModalDialogR('searchDialog', 'span'); clearLink(); return false;" />
                        </apex:pageblockButtons>
                        <apex:pageBlockButtons id="buttons" location="bottom">
                            <apex:outputPanel rendered="{!IF(searchedServiceLocationResultSize!=0,True,False)}">
                                <apex:outputText >
                                    <i style="color: #696969;">{!OffsetSize+1}&nbsp;&nbsp;-&nbsp;&nbsp;{!(OffsetSize+searchedServiceLocationResultSize)}&nbsp;&nbsp;of&nbsp;&nbsp;{!CountTotalRecords}</i>
                                </apex:outputText>
                            </apex:outputPanel>
                        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                        <apex:commandButton value="First"
                                action="{!First}" rerender="table,block" status="status"
                                disabled="{!DisablePrevious}" />
                            <apex:commandButton value="Previous" action="{!Previous}"
                                rerender="table,block" status="status"
                                disabled="{!DisablePrevious}" />
                            <apex:commandButton value="Next" action="{!Next}"
                                reRender="table,block" status="status" disabled="{!DisableNext}" />
                            <apex:commandButton value="Last" action="{!Last}"
                                rerender="table,block" status="status" disabled="{!DisableNext}" />
                            <apex:actionStatus id="status" startText="Paging..." />

                        </apex:pageBlockButtons>
                        <apex:pageMessage severity="warning" strength="1"
                            summary="Please use at least one parameter to search Service Locations" />
                        <apex:outputLabel >Alias&nbsp;&nbsp;&nbsp;</apex:outputLabel>
                        <apex:inputText value="{!nameFilter}" id="nameFilter" size="6" />&nbsp;&nbsp;
<!--                     <apex:outputLabel >Location Nickname&nbsp;&nbsp;&nbsp;</apex:outputLabel> -->
                        <!--                     <apex:inputText value="{!nickNameFilter}" id="LocationNick" size="15"/> -->
                        <apex:outputLabel >&nbsp;&nbsp;&nbsp;City&nbsp;&nbsp;&nbsp;</apex:outputLabel>
                        <apex:inputText value="{!cityFilter}" size="15" />
                        <apex:outputLabel >&nbsp;&nbsp;&nbsp;State&nbsp;&nbsp;&nbsp;</apex:outputLabel>
                        <apex:inputText id="addlocationstate" maxlength="2"
                            value="{!stateFilter}" size="2" />&nbsp;&nbsp;&nbsp;
                    <apex:commandButton value="Search!"
                            action="{!search}" reRender="table,block" status="searchStatus" />
                        <apex:actionStatus id="searchStatus" startText=" Searching..." />
                        <br />
                        <br />
                        <apex:pageblockTable value="{!searchedServiceLocationresults}"
                            var="r" id="table">

                            <apex:column headerValue="Alias">
                            	<apex:outputPanel rendered="{!r.Met_Data_Requirements__c}">
                                	<a href="#"
                                    onClick="j$('input[id$=locationEntry_ServiceLocation]').val('{!r.name}');j$('input[id$=locationEntry_ServiceLocation_lkid]').val('{!r.id}');closeModalDialogR('searchDialog', 'span', 'Search Service Location');return false ">{!r.name}</a>
                            	</apex:outputPanel>
                            	<apex:outputPanel rendered="{!!r.Met_Data_Requirements__c}">
                            		<apex:pageBlockSection >
                      					<apex:pageBlockSectionItem >
                            				{!r.name}
                            				<c:HelpTooltip helpText="Certain aliases cannot be selected due to insufficient data in iServe. Please contact ServiceLocations@thementornetwork.com to complete the required data"/>
                            			</apex:pageBlockSectionItem>
                            		</apex:pageBlockSection>
                            	</apex:outputPanel>
                            </apex:column>
                            <apex:column headerValue="Program Code">
                                <apex:outputText >{!r.ProgramID__c}</apex:outputText>
                            </apex:column>
                            <apex:column headerValue="Location Nickname">
                                <apex:outputText >{!r.Location_Nickname__c}</apex:outputText>
                            </apex:column>
                            <apex:column headerValue="Service Location Address">
                                <apex:outputPanel >
                                    <c:AddressDisplay street1="{!r.Street__c}" city="{!r.City__c}"
                                        state="{!r.State__c}" Zip="{!r.Zip__c}" />
                                    <br />
                                    <apex:outputText value="{!r.Phone__c}" />
                                </apex:outputPanel>
                            </apex:column>
                            <apex:column headerValue="TMN Scope">
                                <apex:outputText >{!r.TMN_Scope__c}</apex:outputText>
                            </apex:column>
                            <apex:column headerValue="Population Served">
                                <apex:outputText >{!r.Population_Served__c}</apex:outputText>
                            </apex:column>
                            <apex:column headerValue="Physical Location">
                                <apex:outputText >{!r.Physical_Location__c}</apex:outputText>
                            </apex:column>
                            <apex:column headerValue="Service Type">
                                <apex:outputText >{!r.Service_Type__c}</apex:outputText>
                            </apex:column>
                            <apex:column headerValue="Offering">
                                <apex:outputText >{!r.Network_Offering__c}</apex:outputText>
                            </apex:column>
                        </apex:pageblockTable>
                        <apex:outputPanel id="SlMSG1" rendered="{!showMsg}">
                            <apex:pageMessages />
                        </apex:outputPanel>
                    </apex:pageBlock>
                </apex:outputPanel>
            </apex:actionregion>
            <apex:actionregion >
                <apex:outputPanel id="searchDialog2" style="display:none">
                    <apex:pageBlock id="block2">
                        <apex:pageblockButtons location="top">
                            <input type="button" class="btn" value="Cancel"
                                onclick="closeModalDialogR('searchDialog2', 'span'); return false;" />
                        </apex:pageblockButtons>
                        <apex:pageBlockButtons id="buttons2" location="bottom">
                            <apex:outputPanel rendered="{!IF(searchedServiceLocationResultSize2!=0,True,False)}">
                                <apex:outputText >
                                    <i style="color: #696969;">{!OffsetSize2+1}&nbsp;&nbsp;-&nbsp;&nbsp;{!(OffsetSize2+searchedServiceLocationResultSize2)}&nbsp;&nbsp;of&nbsp;&nbsp;{!CountTotalRecords2}</i>
                                </apex:outputText>
                            </apex:outputPanel>
                        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                        <apex:commandButton value="First"
                                action="{!First2}" rerender="table2,block2" status="status2"
                                disabled="{!DisablePrevious2}" />
                            <apex:commandButton value="Previous" action="{!Previous2}"
                                rerender="table2,block2" status="status2"
                                disabled="{!DisablePrevious2}" />
                            <apex:commandButton value="Next" action="{!Next2}"
                                reRender="table2,block2" status="status2"
                                disabled="{!DisableNext2}" />
                            <apex:commandButton value="Last" action="{!Last2}"
                                rerender="table2,block2" status="status2"
                                disabled="{!DisableNext2}" />
                            <apex:actionStatus id="status2" startText="Paging..." />

                        </apex:pageBlockButtons>
                        <apex:pageMessage severity="warning" strength="1"
                            summary="Please use at least one parameter to search Service Locations" />
                        <apex:outputLabel >Alias&nbsp;&nbsp;&nbsp;</apex:outputLabel>
                        <apex:inputText value="{!nameFilter2}" id="nameFilter2" size="6" />&nbsp;&nbsp;
<!--                     <apex:outputLabel >Location Nickname&nbsp;&nbsp;&nbsp;</apex:outputLabel> -->
                        <!--                     <apex:inputText value="{!nicknameFilter2}" id="locationNicksecond" size="15"/> -->
                        <apex:outputLabel >&nbsp;&nbsp;&nbsp;City&nbsp;&nbsp;&nbsp;</apex:outputLabel>
                        <apex:inputText id="cityFilter" value="{!cityFilter2}" size="15" />
                        <apex:outputLabel >&nbsp;&nbsp;&nbsp;State&nbsp;&nbsp;&nbsp;</apex:outputLabel>
                        <apex:inputText id="originstate" maxlength="2"
                            value="{!stateFilter2}" size="2" />&nbsp;&nbsp;&nbsp;
                    <apex:commandButton value="Search!"
                            action="{!search2}" reRender="table2,block2,SlMSG2"
                            status="searchStatus2" />
                        <apex:actionStatus id="searchStatus2" startText=" Searching..." />
                        <br />
                        <br />
                        <apex:pageblockTable value="{!searchedServiceLocationresults2}"
                            var="r" id="table2">

                            <apex:column headerValue="Alias">
                            	<apex:outputPanel rendered="{!r.Met_Data_Requirements__c}">
                               		<a href="#"
                                    	onClick="j$('input[id$=sl]').val('{!r.name}');j$('input[id$=sl_lkid]').val('{!r.id}');closeModalDialogR('searchDialog2', 'span', 'Search Service Location'); return false ">{!r.name}</a>
                                </apex:outputPanel>
                                <apex:outputPanel rendered="{!!r.Met_Data_Requirements__c}">
                                	<apex:pageBlockSection >
                      					<apex:pageBlockSectionItem >
                            				{!r.name}
                            				<c:HelpTooltip helpText="Certain aliases cannot be selected due to insufficient data in iServe. Please contact ServiceLocations@thementornetwork.com to complete the required data"/>
                            			</apex:pageBlockSectionItem>
                            		</apex:pageBlockSection>
                                </apex:outputPanel>
                            </apex:column>
                            <apex:column headerValue="Program Code">
                                <apex:outputText >{!r.ProgramID__c}</apex:outputText>
                            </apex:column>
                            <apex:column headerValue="Location Nickname">
                                <apex:outputText >{!r.Location_Nickname__c}</apex:outputText>
                            </apex:column>
                            <apex:column headerValue="Service Location Address">
                                <apex:outputPanel >
                                    <c:AddressDisplay street1="{!r.Street__c}" city="{!r.City__c}"
                                        state="{!r.State__c}" Zip="{!r.Zip__c}" />
                                    <br />
                                    <apex:outputText value="{!r.Phone__c}" />
                                </apex:outputPanel>
                            </apex:column>
                            <apex:column headerValue="TMN Scope">
                                <apex:outputText >{!r.TMN_Scope__c}</apex:outputText>
                            </apex:column>
                            <apex:column headerValue="Population Served">
                                <apex:outputText >{!r.Population_Served__c}</apex:outputText>
                            </apex:column>
                            <apex:column headerValue="Physical Location">
                                <apex:outputText >{!r.Physical_Location__c}</apex:outputText>
                            </apex:column>
                            <apex:column headerValue="Service Type">
                                <apex:outputText >{!r.Service_Type__c}</apex:outputText>
                            </apex:column>
                            <apex:column headerValue="Offering">
                                <apex:outputText >{!r.Network_Offering__c}</apex:outputText>
                            </apex:column>
                        </apex:pageblockTable>
                        <apex:outputPanel id="SlMSG2" rendered="{!showMsg2}">
                            <apex:pageMessage Summary="No Service Locations found matching the search criteria"
                                severity="Info" strength="3" />
                        </apex:outputPanel>
                    </apex:pageBlock>
                </apex:outputPanel>
            </apex:actionregion>
            <!---->

            <!--Activities Modal-->
            <apex:actionRegion >
                <apex:outputpanel style="display:none" id="ActivityModal">

                    <apex:actionFunction name="saveActivity" action="{!saveActivity}"
                        status="myStatus" rerender="activities,activityEntry,msgs" />

                    <apex:pageBlock title="Add Task">
                        <apex:pageblockButtons location="bottom">
                            <apex:commandButton value="Save"
                                onclick="activitySave(true); return false;" />
                            <apex:commandButton value="Save & New"
                                onclick="activitySave(false); return false;" />
                            <apex:commandButton value="Cancel"
                                onclick="closeModalDialogR('ActivityModal', 'span');j$('#activityErrors').html('');return false;" />
                        </apex:pageblockButtons>

                        <apex:facet name="header">
                            <p>
                                <strong>Add Task:</strong>
                            </p>
                        </apex:facet>

                        <div id='activityErrors' style='color: red'></div>

                        <apex:pageBlockSection columns="1" id="activityEntry">
                            <apex:inputField value="{!activity.Subject}"
                                id="activityEntry_Subject" />
                            <apex:inputField value="{!activity.OwnerId}"
                                id="activityEntry_Owner" />
                            <apex:inputField value="{!activity.ActivityDate}"
                                id="activityEntry_ActivityDate" />
                            <apex:inputField value="{!activity.Priority}"
                                id="activityEntry_Priority" />
                            <apex:inputField value="{!activity.Status}"
                                id="activityEntry_Status" />
                            <apex:inputField value="{!activity.Description}"
                                id="activityEntry_Comments__c" />

                        </apex:pageBlockSection>
                    </apex:pageBlock>
                </apex:outputpanel>
            </apex:actionRegion>

            <!-- Add diagnosis modal -->
            <apex:actionRegion >
                <apex:outputPanel id="diagnosisModal" style="display:none">
                    <apex:actionFunction name="saveDiagnosis" action="{!saveDiagnosis}"
                        status="myStatus" rerender="diagsec,diagnosisEntry,msgs"
                        oncomplete="clearLink(); return false;" />
                    <apex:pageBlock title="Add/Edit Diagnosis">
                        <apex:pageblockButtons location="bottom">
                            <apex:commandButton value="Save"
                                onClick="diagnosisSave(true); return false;" />
                            <apex:commandButton value="Save & New"
                                onClick="diagnosisSave(false);return false;" />
                            <apex:commandButton value="Cancel"
                                onClick="closeModalDialogR('diagnosisModal', 'span'); j$('#diagnosisErrors').html(''); clearLink();return false;" />
                        </apex:pageblockButtons>
                        <apex:facet name="header">
                            <p>
                                <strong>Add a diagnosis below:</strong>
                            </p>
                        </apex:facet>
                        <div id='diagnosisErrors' style='color: red'></div>
                        <apex:pageBlockSection columns="2" id="diagnosisEntry">
                            <apex:pageBlockSectionItem >
                                <apex:outputPanel style="padding-left: 77px">
                                    <apex:outputLabel value="ICD-10 Code" style="font-weight:bold" /> &nbsp; &nbsp;
                                <apex:inputField value="{!diag.ICD__c}"
                                        html-disabled="true" id="diagnosisEntry_icd10" />
                                    <c:HelpTooltip helpText="Please note: When searching, use Name to search by the alphanumeric ICD-10 Code. Use All Fields to search by ICD-10 Code OR Description." />
                                </apex:outputPanel>
                            </apex:pageBlockSectionItem>
                            <apex:pageBlockSectionItem >
                                <apex:outputLabel Value="Date and Time of Diagnosis" />
                                <c:MilitaryDatetime edit="true"
                                    hiddenFieldId="diagnosisEntry_EffDate"
                                    dateTimeVal="{!diag.Effective_Date__c}"
                                    datetimepickerid="diagnosisEntry_effDateTimeInput" />
                            </apex:pageBlockSectionItem>
                            <apex:inputField value="{!diag.Status__c}"
                                id="diagnosisEntry_status" />
                            <apex:inputHidden value="{!diag.Effective_Date__c}"
                                id="diagnosisEntry_EffDate" />
                            <!-- <apex:inputField value="{!diag.Type__c}"  id="diagnosisEntry_type" /> -->
                        </apex:pageBlockSection>
                    </apex:pageBlock>
                </apex:outputPanel>
            </apex:actionRegion>

            <!-- End -->

            <!-- Referral Detail -->
            <apex:pageBlock mode="edit" id="referralDetailBlock"
                rendered="{!OR(!ISNULL(personBeingRefRecord.Id), !ISNULL(personBeingServedRecord.Id))}">
                <apex:pageblockButtons location="bottom">
                    <!-- on this button status will not work b/c it doesn't invoke an action it uses onclick js-->
                    <apex:commandButton value="Save Referral" id="saveRefButton"
                        styleClass="saveBtn"
                        onclick="saveBtnDisplay('true'); alertUseraboutLocation();return false;"
                        rendered="{!OR(!ISNULL(personBeingRefRecord.Id), !ISNULL(personBeingServedRecord.Id))}"
                        oncomplete="unsetAdditionalFields(j$('select[id$=referralStatus]').val());" />

                    <apex:commandButton value="Cancel" id="cancelButton"
                        action="{!cancel}" />
                </apex:pageblockButtons>

                <apex:pageBlockSection title="Referral Detail" showHeader="true"
                    columns="2" collapsible="false" id="ReferralDetailHeader">
                    <apex:pageBlockSectionItem rendered="{!referralRecordType=='CareMeridian' || referralRecordType=='Oregon'}" />
                    <apex:inputHidden value="{!redFlagged}" id="redFlagged" />

                    <apex:inputField value="{!Referral__c.How_did_referral_come_in__c}"
                        rendered="{!referralRecordType=='CareMeridian'}" />
                    <apex:inputField value="{!Referral__c.Referral_Date__c}"
                        required="true" />
                    <apex:inputField value="{!Referral__c.Prime_Number__c}"
                        rendered="{!referralRecordType == 'Oregon'}" id="primeNumber" />

                    <apex:pageblocksectionitem >
                        <apex:outputlabel for="referralStatus" value="Referral Status" />
                        <apex:actionregion >
                            <apex:inputField id="referralStatus"
                                value="{!Referral__c.Referral_Status__c}" required="true">
                                <apex:actionSupport event="onchange"
                                    action="{!unsetStatusHelperFiels}"
                                    rerender="ReferralStatus, levelOfEducation"
                                    oncomplete="unsetAdditionalFields(j$('select[id$=referralStatus]').val());" />
                            </apex:inputField>
                        </apex:actionregion>
                    </apex:pageblocksectionitem>
                    <apex:inputField value="{!Referral__c.UCI_Number__c}"
                        rendered="{!ReferralRecordType=='California'}" />


                    <apex:pageBlockSectionItem />

                    <apex:inputField id="refSourceTypeFieldId"
                        value="{!Referral__c.Referral_Source_Type__c}"
                        required="{!ReferralRecordType =='NeuroRestorative' || ReferralRecordType =='Adult Day Health'}"
                        onChange="enableOther()" />

                    <apex:pageBlockSectionItem >
                        <apex:outputLabel value="Other (Describe)" />
                        <apex:outputPanel styleClass="requiredInput" layout="block"
                            id="SourceTypeOtherDiv">
                            <apex:outputPanel styleClass="requiredBlock" layout="block" />
                            <apex:inputField id="SourceTypeOtherId"
                                value="{!Referral__c.Referral_Source_Type_Other_Describe__c}" />
                        </apex:outputPanel>
                    </apex:pageBlockSectionItem>

                    <apex:pageBlockSectionItem rendered="{!ReferralRecordType =='Oregon'}">
                        <apex:outputLabel value="Brokerage" />
                        <apex:outputPanel styleClass="requiredInput" layout="block"
                            id="SourceTypeBrokerageDiv">
                            <apex:outputPanel styleClass="requiredBlock" layout="block" />
                            <apex:inputField id="brokerage"
                                value="{!Referral__c.Brokerage__c}" />
                        </apex:outputPanel>
                    </apex:pageBlockSectionItem>

                    <apex:pageBlockSectionItem rendered="{!ReferralRecordType =='Oregon'}">
                        <apex:outputLabel value="County" />
                        <apex:outputPanel styleClass="requiredInput" layout="block"
                            id="SourceTypeCountyDiv">
                            <apex:outputPanel styleClass="requiredBlock" layout="block" />
                            <apex:inputField id="county" value="{!Referral__c.County__c}" />
                        </apex:outputPanel>
                    </apex:pageBlockSectionItem>
                    <!-- ERC-97: Start -->
                    <!-- <apex:inputField value="{!Referral__c.Agency_Name__c}" label="Referral Source" /> -->
                    <apex:pageBlockSectionItem helpText="{!$ObjectType.Referral__c.fields.Agency_Name__c.InlineHelpText}">
                        <apex:outputlabel for="referralSource" value="Referral Source" />
                        <apex:inputField id="referralSource"
                            value="{!Referral__c.Agency_Name__c}"
                            required="{!ReferralRecordType == 'NeuroRestorative' || ReferralRecordType =='Adult Day Health'}" />
                    </apex:pageBlockSectionItem>
                    <!-- ERC-97: End -->
                    <apex:inputField value="{!Referral__c.How_did_they_learn__c}"
                        rendered="{!ReferralRecordType=='NeuroRestorative' || ReferralRecordType =='Adult Day Health'}"
                        required="True" />

                    <apex:pageBlockSectionItem rendered="{! ReferralRecordType == 'CareMeridian'}" />
                    <apex:inputField value="{!Referral__c.Referral_Name__c}"
                        required="{!ReferralRecordType == 'NeuroRestorative' || ReferralRecordType =='Adult Day Health'}" />
                    <apex:inputText id="referrerPhone" label="Referrer Phone Number"
                        value="{!Referral__c.Referral_Phone_Number__c}"
                        onblur="j$('input[id$=referrerPhone]').val(this.value.replace(/(\d\d\d)(\d\d\d)(\d\d\d\d)/, '$1-$2-$3'))" />
                    <apex:pageBlockSectionItem rendered="{!ReferralRecordType != 'CareMeridian'}" />
                    <apex:inputField value="{!Referral__c.Financial_Status__c}"
                        rendered="{!ReferralRecordType == 'CareMeridian'}" />
                    <apex:inputField value="{!Referral__c.Clinical_Evaluation_Status__c}"
                        rendered="{!ReferralRecordType == 'CareMeridian'}" />
                    <apex:pageBlockSectionItem rendered="{!ReferralRecordType=='NeuroRestorative' || ReferralRecordType =='Adult Day Health'}">
                        <apex:outputText value="Location" />
                        <apex:outputPanel styleClass="nowrap@">
                            <apex:outputLabel value="Street" style="width: 10px;" />&nbsp;
                        <apex:inputText value="{!Referral__c.Referrer_Street__c}" id="Ref_Perm_Street" />&nbsp;
                        <br />
                            <apex:outputLabel value="Street 2" style="width: 10px;" />&nbsp;
                        <apex:inputText value="{!Referral__c.Referrer_Street_2__c}"
                                id="Ref_Perm_Street2" />&nbsp;
                        <br />
                            <apex:outputLabel value="City" style="width: 10px;" />&nbsp; &nbsp; &nbsp;
                        <apex:inputText value="{!Referral__c.Referrer_City__c}" id="Ref_Perm_City" />&nbsp;
                        <br />
                        <apex:outputLabel value="State" />&nbsp;
                        <apex:inputField value="{!Referral__c.Referrer_State__c}" id="Ref_Perm_State" />&nbsp;
                        <br />
                            <apex:outputLabel value="Zip" />&nbsp;
                        <apex:inputText value="{!Referral__c.Referrer_Zip__c}" style="width: 42px;"
                                id="Ref_Perm_Zip" />
                        </apex:outputPanel>
                    </apex:pageBlockSectionItem>
                    <apex:inputField value="{!Referral__c.Referrer_Street__c}"
                        rendered="{!ReferralRecordType=='Cambridge Florida' ||
                                                                                ReferralRecordType = 'Cambridge Massachusetts' ||
                                                                                ReferralRecordType = 'Cambridge Maryland' ||
                                                                                ReferralRecordType = 'Cambridge Indiana' ||
                                                                                ReferralRecordType = 'Cambridge North Carolina' ||
                                                                                ReferralRecordType = 'Cambridge Ohio' ||
                                                                                ReferralRecordType ='CA FSS'}" />
                    <apex:inputField value="{!Referral__c.Referrer_Email__c}"
                        rendered="{!ReferralRecordType=='NeuroRestorative' ||
                                                                                ReferralRecordType =='Adult Day Health' ||
                                                                                ReferralRecordType=='Cambridge Florida' ||
                                                                                ReferralRecordType = 'Cambridge Massachusetts' ||
                                                                                ReferralRecordType = 'Cambridge Maryland' ||
                                                                                ReferralRecordType = 'Cambridge Indiana' ||
                                                                                ReferralRecordType = 'Cambridge North Carolina' ||
                                                                                ReferralRecordType = 'Cambridge Ohio' ||
                                                                                ReferralRecordType=='CA FSS'}" />
                    <apex:pageBlockSectionItem rendered="{!ReferralRecordType=='NeuroRestorative' || isCambridge || ReferralRecordType=='CA FSS' || ReferralRecordType =='Adult Day Health'}" />
                    <apex:inputField value="{!Referral__c.Billing_ID__c}"
                        rendered="{!isCambridge || ReferralRecordType=='CA FSS'}" />
                    <!-- CTEAE-137 -->
                    <apex:inputField label="Payer/Guarantor Medical Record Number"
                        value="{!Referral__c.Payer_Medical_Record_Number__c}"
                        rendered="{!ReferralRecordType=='Cambridge North Carolina' || ReferralRecordType=='CA FSS'}" />
                    <apex:inputField label="Payer/Guarantor Medical Record Number Description"
                        value="{!Referral__c.Payer_Medical_Record_Number_Description__c}"
                        rendered="{!ReferralRecordType=='Cambridge North Carolina' || ReferralRecordType=='CA FSS'}" />
                    <!-- end CTEAE -137 -->
                    <apex:inputText id="referrerFax"
                        value="{!Referral__c.Referrer_Fax__c}"
                        rendered="{!ReferralRecordType=='NeuroRestorative' || ReferralRecordType =='Adult Day Health'}"
                        onblur="j$('input[id$=referrerFax]').val(this.value.replace(/(\d\d\d)(\d\d\d)(\d\d\d\d)/, '$1-$2-$3'))" />
                    <apex:inputField value="{!Referral__c.Case_Manager_Name__c}"
                        rendered="{!ReferralRecordType!='NeuroRestorative' && ReferralRecordType !='Adult Day Health'}" />
                    <!-- ERNS-26 -->
                    <apex:inputField value="{!Referral__c.Case_Manager_Phone__c}"
                        rendered="{!ReferralRecordType!='NeuroRestorative' && ReferralRecordType !='Adult Day Health'}" />
                    <!--apex:inputField value="{!Referral__c.Evaluation_Date__c}" rendered="{!referralRecordType=='CareMeridian'}"/-->
                    <!-- ADDED  for  EB-365 -->
                    <apex:inputField value="{!Referral__c.Assessment_Date__c}"
                        rendered="{!ReferralRecordType=='Wisconsin' || ReferralRecordType=='North Dakota'}" />

                    <apex:pageBlockSectionItem rendered="{!referralRecordType=='CareMeridian'}" />
                    <apex:inputField label="Evaluated By" id="EvalByInter"
                        value="{!Referral__c.Evaluated_By_Internal__c}"
                        rendered="{!referralRecordType == 'CareMeridian'}" />

                    <apex:inputField value="{!Referral__c.Current_Location__c}"
                        rendered="{!referralRecordType=='CareMeridian'}" />
                    <apex:inputField value="{!Referral__c.Current_Location_Type__c}"
                        rendered="{!referralRecordType=='CareMeridian'}" />

                    <!--                Added by Sravan for PRI-164 05/13/2015 -->
                    <apex:pageBlocksectionitem >
                        <apex:outputPanel >
                            <apex:outputLabel value="Guardianship Type"
                                id="guardianshipTypeLabel" />
                            <br />
                            <br />
                            <apex:outputLabel value="Partial Guardianship/Conservatorship Type"
                                id="partialGuardianShipLabel" />
                        </apex:outputPanel>
                        <apex:outputPanel >
                            <apex:inputField value="{!Referral__c.Guardianship_Type__c}"
                                id="guardianShipType"
                                html-data-visibility-rules="{&quot;Partial Guardianship/Conservatorship&quot;: [&quot;{!$Component.partialGuardianShip}&quot;, &quot;{!$Component.partialGuardianShipLabel}&quot;]}" />
                            <br />
                            <br />
                            <apex:inputField value="{!Referral__c.Partial_Guardianship_Conservatorship__c}"
                                id="partialGuardianShip" />
                        </apex:outputPanel>
                    </apex:pageBlocksectionitem>

                    <apex:pageBlocksectionItem rendered="{!Referral__c.Legal_Guardian_Status__c != null}" />
                    
                    <apex:pageBlockSectionItem rendered="{!Referral__c.Legal_Guardian_Status__c != null}">
                        <apex:outputLabel value="Legal/Guardianship Staus" />
                        <apex:outputField value="{!Referral__c.Legal_Guardian_Status__c}" />
                    </apex:pageBlockSectionItem>
                    
                    <apex:inputField value="{!Referral__c.Level_of_Education__c}" rendered="{!!(ReferralRecordType ='Adult Day Health')}"/>

                    <apex:inputField value="{!Referral__c.Evaluated_By_Internal__c}"
                        rendered="{!referralRecordType == 'NeuroRestorative' || ReferralRecordType =='Adult Day Health'}"
                        required="true" />


                    <apex:inputField value="{!Referral__c.Current_Representative_Payee__c}"
                        rendered="{! (isCambridge && referralRecordType!='Generic') || ReferralRecordType=='CA FSS'}" />
                    <apex:inputField value="{!Referral__c.Billing_ID__c}"
                        rendered="{!referralRecordType=='NeuroRestorative' || ReferralRecordType =='Adult Day Health'}" />
                    <!--<apex:pageBlocksectionItem rendered="{!ReferralRecordType =='Adult Day Health'}" />-->
                    <apex:inputField value="{!Referral__c.Referring_Physician__c}" rendered="{!ReferralRecordType =='Adult Day Health'}" />
                        
                    <apex:inputField value="{!Referral__c.Goals_of_Care__c}" rendered="{!ReferralRecordType =='Adult Day Health'}" required="{!ReferralRecordType =='Adult Day Health'}"/>
                    <apex:inputField value="{!Referral__c.Time_Since_Last_Hospital_Stay__c}" rendered="{!ReferralRecordType =='Adult Day Health'}" required="{!ReferralRecordType =='Adult Day Health'}"/>
                    <apex:inputField value="{!Referral__c.Who_lived_with_at_Referral__c}" rendered="{!ReferralRecordType =='Adult Day Health'}" required="{!ReferralRecordType =='Adult Day Health'}"/>
                    <apex:inputField value="{!Referral__c.Prior_NH_Placement__c}" rendered="{!ReferralRecordType =='Adult Day Health'}" required="{!ReferralRecordType =='Adult Day Health'}"/>
                    <apex:inputField value="{!Referral__c.Residential_History__c}" rendered="{!ReferralRecordType =='Adult Day Health'}" required="{!ReferralRecordType =='Adult Day Health'}"/>
                    <apex:pageblocksectionitem rendered="{!ReferralRecordType =='Adult Day Health'}">
                        <apex:outputLabel value="Reason for Referral" for="reasonforRefADH" />
                        <apex:outputPanel styleClass="requiredInput" layout="block">
                            <apex:outputPanel styleClass="requiredBlock" layout="block" />
                            <apex:selectList size="1" value="{!Referral__c.Reason_for_Referral__c}" id="reasonforRefADH" onchange="enableOtherDesc()">
                                <apex:selectOptions value="{!reasonforRefValues}" />
                            </apex:selectList>
                        </apex:outputPanel>
                    </apex:pageblocksectionitem>
                     <apex:pageBlockSectionItem rendered="{!ReferralRecordType =='Adult Day Health'}">
                        <apex:outputLabel value="Other Description" />
                        <apex:outputPanel styleClass="requiredInput" layout="block"
                            id="otherDescADHDiv">
                            <apex:outputPanel styleClass="requiredBlock" layout="block" />
                            <apex:inputField id="otherDescADHId"
                                value="{!Referral__c.Other_Description__c}" />
                        </apex:outputPanel>
                    </apex:pageBlockSectionItem>
                     
                    <apex:inputField value="{!Referral__c.CYBER_ID_Number__c}"
                        rendered="{!referralRecordType=='Cambridge New Jersey'}" />
                    <apex:inputField value="{!Referral__c.CYBER_Referral_Number__c}"
                        rendered="{!referralRecordType=='Cambridge New Jersey'}" />
                    <apex:inputField value="{!Referral__c.Spirit_Case_Number__c}"
                        rendered="{!referralRecordType=='Cambridge New Jersey'}" />
                    <apex:inputField value="{!Referral__c.Spirit_Person_Number__c}"
                        rendered="{!referralRecordType=='Cambridge New Jersey'}" />
                    <apex:inputField value="{!Referral__c.CHESSIE_ID__c}"
                        rendered="{!referralRecordType=='Cambridge Maryland'}" />
                    <apex:pageBlockSectionItem rendered="{!referralRecordType=='CareMeridian'}" />

                </apex:pageBlockSection>
                <apex:pageBlockSection rendered="{!ReferralRecordType=='Cambridge Florida' ||
                        ReferralRecordType = 'Cambridge Massachusetts' ||
                        ReferralRecordType = 'Cambridge Maryland' ||
                        ReferralRecordType = 'Cambridge Indiana' ||
                        ReferralRecordType = 'Cambridge North Carolina' ||
                        ReferralRecordType = 'Cambridge Ohio' ||
                        ReferralRecordType=='CA FSS' }">
                    <!-- added section item for CTEAE-37 -->
                    <apex:pageBlockSectionItem >
                        <apex:outputLabel for="mentalHealthEmot">
                        Reason Category: Mental Health/Emotional
                        <br />
                            <apex:actionStatus id="statusMental_Health">
                                <apex:facet name="start">
                                    <div class="waitingHolder"
                                        style="display: inline; margin-left: 5px; position: relative; top: 5px;">
                                        <img class="waitingImage" src="/img/loading.gif"
                                            title="Please Wait..." /> <span class="waitingDescription"></span>
                                    </div>
                                </apex:facet>
                                <apex:facet name="stop"></apex:facet>
                            </apex:actionStatus>
                        </apex:outputLabel>
                        <apex:outputPanel id="itemMental_Health">
                            <apex:actionRegion >
                                <apex:inputField id="mentalHealthEmot"
                                    value="{!Referral__c.Reason_Category_Mental_Health_Emotional__c}">
                                    <apex:actionSupport event="onchange"
                                        rerender="itemMental_Health" status="statusMental_Health"
                                        oncomplete="clearReason_MentalHealth(); return false;" />
                                </apex:inputField>
                            </apex:actionRegion>
                            <br />
                            <apex:outputLabel >Discrimination Reason</apex:outputLabel>
                            <apex:actionRegion >
                                <apex:inputField value="{!Referral__c.Discrimination_Reason__c}"
                                    id="clearReason_MentalHealth_input"
                                    rendered="{!IF(CONTAINS(Referral__c.Reason_Category_Mental_Health_Emotional__c,'Victim of Discrimination'),false,true)}"
                                    html-disabled="true" />
                                <apex:inputField value="{!Referral__c.Discrimination_Reason__c}"
                                    id="clearReason_MentalHealth_input2"
                                    required="{!IF(CONTAINS(Referral__c.Reason_Category_Mental_Health_Emotional__c,'Victim of Discrimination'),true,false)}"
                                    rendered="{!IF(CONTAINS(Referral__c.Reason_Category_Mental_Health_Emotional__c,'Victim of Discrimination'),true,false)}" />
                            </apex:actionRegion>
                        </apex:outputPanel>
                    </apex:pageBlockSectionItem>
                    <apex:inputField id="schoolProb"
                        value="{!Referral__c.Reason_Category_School_Problems__c}" />
                    <apex:inputField id="medicProb"
                        value="{!Referral__c.Reason_Category_Medical_Problems__c}" />
                    <apex:inputField id="physEnv"
                        value="{!Referral__c.Reason_Category_Physical_Environment__c}" />
                    <apex:inputField id="behavProb"
                        value="{!Referral__c.Reason_Category_Behavioral_Problems__c}" />
                </apex:pageBlockSection>

                <!-- START: CTEAE-106, MA Referral Flavor Fields -->
                <apex:pageBlockSection rendered="{!ReferralRecordType=='Cambridge Massachusetts'}">
                    <apex:inputField id="IccCarePlanSubmittedField"
                        value="{!Referral__c.ICC_Care_Plan_Submitted__c}"
                        label="If the referral is from the ICC has the care plan been submitted to the insurance company in order for us to obtain an authorization for services?" />
                    <apex:pageBlockSectionItem />
                    <apex:inputField value="{!Referral__c.If_Yes_What_kind__c}"
                        label="Describe Any Household Pets" />
                    <apex:inputField value="{!Referral__c.Goals_from_the_Referral_Source__c}" />
                </apex:pageBlockSection>
                <!-- END: CTEAE-106, MA Referral Flavor Fields -->

                <!-- Diagnosis Old Code, Commented some fields, moving to refferal detail section Start-->
                <apex:pageBlockSection showHeader="false"
                    title="Diagnosis Information" columns="2" collapsible="false"
                    id="ReferralDetail">

                    <!--<apex:outputText label="Diagnosis" rendered="{!OR(ReferralRecordType == 'Wisconsin',ReferralRecordType == 'Minnesota',ReferralRecordType == 'North Dakota',ReferralRecordType == 'NeuroRestorative')}" /> -->
                    <apex:pageBlockSectionItem rendered="{!OR(ReferralRecordType == 'Minnesota',ReferralRecordType == 'North Dakota',ReferralRecordType == 'NeuroRestorative')}" />
                    <apex:pageBlockSectionItem >
                        <apex:outputText rendered="{!OR(ReferralRecordType == 'Minnesota',ReferralRecordType == 'NeuroRestorative',ReferralRecordType == 'North Dakota')}">
                            <i><b>Brain Injury Detail</b></i>
                        </apex:outputText>
                        <apex:outputText value="" />
                    </apex:pageBlockSectionItem>
                    <apex:pageBlockSectionItem rendered="{!ReferralRecordType == 'Wisconsin'}" />

                    <!-- <apex:inputTextarea cols="50" rows="3" value="{!Referral__c.Axis_I__c}" rendered="{!ReferralRecordType != 'CareMeridian' && ReferralRecordType != 'NeuroRestorative' }" /> -->
                    <!--<apex:pageBlockSectionItem rendered="{!AND(ReferralRecordType != 'Minnesota',ReferralRecordType != 'North Dakota',referralRecordType!='CareMeridian', referralRecordType != 'NeuroRestorative')}" /> -->
                    <!-- <apex:inputField id="diagIdrop" value="{!Referral__c.Diagnosis_I__c}" label="Primary Diagnosis" rendered="{!ReferralRecordType == 'NeuroRestorative'}" onchange="enableDiagEff();" /> -->
                    <apex:pageBlockSectionItem rendered="{!OR(ReferralRecordType == 'Minnesota',ReferralRecordType == 'North Dakota',ReferralRecordType == 'NeuroRestorative')}" />
                    <apex:inputField value="{!Referral__c.Date_of_Injury__c}"
                        rendered="{!OR(ReferralRecordType == 'Minnesota',ReferralRecordType == 'NeuroRestorative',ReferralRecordType == 'North Dakota')}" />
                    <!--<apex:inputField value="{!Referral__c.Date_of_Injury__c}" rendered="{!ReferralRecordType == 'CareMeridian'}" />-->

                    <!--<apex:inputTextarea cols="50" rows="3" value="{!Referral__c.Axis_II__c}" rendered="{!ReferralRecordType != 'CareMeridian' && ReferralRecordType != 'NeuroRestorative' }" /> -->
                    <apex:pageBlockSectionItem rendered="{!AND(ReferralRecordType != 'NeuroRestorative',ReferralRecordType != 'Minnesota',ReferralRecordType != 'North Dakota',referralRecordType!='CareMeridian')}" />
                    <!--<apex:inputField id="diageffdate" value="{!Referral__c.Diagnosis_Effective_Date__c}" rendered="{!ReferralRecordType == 'NeuroRestorative'}" html-disabled="true" />-->

                    <apex:pageBlockSectionItem rendered="{!OR(ReferralRecordType == 'Minnesota',ReferralRecordType == 'North Dakota',ReferralRecordType == 'NeuroRestorative')}" />
                    <apex:inputField value="{!Referral__c.Cause_of_Injury__c}"
                        rendered="{!OR(ReferralRecordType == 'Minnesota',ReferralRecordType == 'North Dakota')}" />

                    <!--<apex:inputTextarea cols="50" rows="3" value="{!Referral__c.Axis_III__c}" rendered="{!ReferralRecordType != 'CareMeridian' && ReferralRecordType != 'NeuroRestorative' }" />-->

                    <apex:pageBlocksectionItem rendered="{!ReferralRecordType == 'NeuroRestorative'}">
                        <apex:outputLabel value="Cause of Injury" for="causepick" />
                        <apex:outputPanel >
                            <apex:actionRegion >
                                <apex:inputField id="causepick"
                                    value="{!Referral__c.Cause_of_Injury_pick__c}"
                                    label="Cause of Injury">
                                    <apex:actionSupport rerender="othercause" event="onchange" />
                                </apex:inputField>
                            </apex:actionRegion>
                            <br />
                            <apex:outputPanel id="othercause">
                                <apex:outputLabel value="Specify Other"
                                    rendered="{!Referral__c.Cause_of_Injury_pick__c == 'Other'}"
                                    for="txtothercause" />
                                <apex:inputField id="txtothercause"
                                    value="{!Referral__c.Cause_of_Injury_Other__c}"
                                    rendered="{!Referral__c.Cause_of_Injury_pick__c == 'Other'}"
                                    required="{!Referral__c.Cause_of_Injury_pick__c == 'Other'}"
                                    label="Specify Other" />
                            </apex:outputPanel>
                        </apex:outputPanel>
                    </apex:pageBlocksectionItem>

                    <apex:pageBlockSectionItem rendered="{!AND(ReferralRecordType != 'Minnesota',ReferralRecordType != 'North Dakota',referralRecordType!='CareMeridian',referralRecordType!='NeuroRestorative')}" />
                    <apex:pageBlockSectionItem rendered="{!OR(ReferralRecordType == 'Minnesota',ReferralRecordType == 'North Dakota',ReferralRecordType == 'NeuroRestorative')}" />
                    <apex:pageBlockSectionItem rendered="{!OR(ReferralRecordType == 'Minnesota',ReferralRecordType == 'North Dakota')}">
                        <apex:outputText value="Current Location" />
                        <apex:outputPanel >
                            <input id="MN_usePermanent" type="checkbox" value="1"
                                onchange="copyPermanent(this);" />&nbsp;Same as Permanent
                    </apex:outputPanel>
                    </apex:pageBlockSectionItem>

                    <!--<apex:inputTextarea cols="50" rows="3" value="{!Referral__c.Axis_IV__c}" rendered="{!ReferralRecordType != 'CareMeridian' && ReferralRecordType != 'NeuroRestorative' }" /> -->
                    <apex:pageBlockSectionItem rendered="{!ReferralRecordType == 'NeuroRestorative'}">
                        <apex:outputText value="Current Location" />
                        <apex:outputPanel >

                            <input name="which_address" id="NR_usePermanent" type="radio"
                                value="1" onchange="copyPermanentNeuro(this);" />&nbsp;
                        <apex:outputLabel for="NR_usePermanent">Same as Facility</apex:outputLabel>
                            <br />
                            <input name="which_address" id="NR_useContact" type="radio"
                                value="1" onchange="copyPermanent(this);" />&nbsp;
                        <apex:outputLabel for="NR_usePermanent2">Same as Permanent</apex:outputLabel>

                        </apex:outputPanel>
                    </apex:pageBlockSectionItem>
                    <!--<apex:inputField value="{!Referral__c.Ranchos_Los_Amigos_Scale__c}" rendered="{!referralRecordtype == 'NeuroRestorative'}" />-->
                    <apex:pageBlockSectionItem rendered="{!AND(ReferralRecordType != 'Minnesota',ReferralRecordType != 'North Dakota', ReferralRecordType != 'CareMeridian', ReferralRecordType != 'NeuroRestorative')}" />
                    <apex:pageBlockSectionItem rendered="{!ReferralRecordType == 'NeuroRestorative'}" />
                    <apex:inputField value="{!Referral__c.New_Address_Location__c}"
                        rendered="{!ReferralRecordType == 'NeuroRestorative'}" />
                    <apex:pageBlockSectionItem rendered="{!ReferralRecordType == 'NeuroRestorative'}" />

                    <apex:inputField value="{!Referral__c.Current_Location_Type__c}"
                        rendered="{!ReferralRecordType == 'NeuroRestorative'}" />
                    <apex:pageBlockSectionItem rendered="{!ReferralRecordType == 'NeuroRestorative'}" />

                    <apex:inputField value="{!Referral__c.Current_Location_Name__c}"
                        rendered="{!ReferralRecordType == 'NeuroRestorative'}" />
                    <apex:pageBlockSectionItem rendered="{!ReferralRecordType == 'NeuroRestorative'}" />
                    <apex:pageBlockSectionItem rendered="{!OR(ReferralRecordType == 'Minnesota',ReferralRecordType == 'North Dakota')}" />

                    <apex:inputField value="{!Referral__c.Street_1__c}"
                        rendered="{!OR(ReferralRecordType == 'Minnesota',ReferralRecordType == 'North Dakota')}"
                        id="MN_Street1" />

                    <!--<apex:inputTextarea cols="50" rows="3" value="{!Referral__c.Axis_V__c}" rendered="{!ReferralRecordType != 'CareMeridian' && ReferralRecordType != 'NeuroRestorative' }" />-->
                    <apex:pageBlockSectionItem rendered="{!OR(ReferralRecordType == 'Minnesota',ReferralRecordType == 'North Dakota')}" />

                    <apex:inputField value="{!Referral__c.Street_1__c}"
                        rendered="{!ReferralRecordType == 'NeuroRestorative'}"
                        id="Neuro_Street1" />
                    <apex:pageBlockSectionItem rendered="{!AND(ReferralRecordType != 'Minnesota',ReferralRecordType != 'NeuroRestorative',ReferralRecordType != 'North Dakota')}" />
                    <apex:inputField value="{!Referral__c.Street_2__c}"
                        rendered="{!OR(ReferralRecordType == 'Minnesota',ReferralRecordType == 'North Dakota')}"
                        id="MN_Street2" />

                    <apex:inputField value="{!Referral__c.Vision__c}"
                        rendered="{!ReferralRecordType == 'Illinois'}" />
                    <apex:pageBlockSectionItem rendered="{!ReferralRecordType == 'Illinois'}" />

                    <apex:inputField value="{!Referral__c.Hearing__c}"
                        rendered="{!ReferralRecordType == 'Illinois'}" />
                    <apex:pageBlockSectionItem rendered="{!ReferralRecordType == 'Illinois'}" />

                    <apex:inputField value="{!Referral__c.Seizures__c}"
                        rendered="{!ReferralRecordType == 'Illinois'}" />
                    <apex:pageBlockSectionItem rendered="{!ReferralRecordType == 'Illinois'}" />

                    <apex:inputField value="{!Referral__c.Other__c}"
                        rendered="{!ReferralRecordType == 'Illinois'}" />
                    <apex:pageBlockSectionItem rendered="{!ReferralRecordType == 'Illinois'}" />

                    <apex:inputTextarea value="{!Referral__c.Communication_Summary__c}"
                        cols="50" rows="3"
                        rendered="{!ReferralRecordType == 'Illinois' || ReferralRecordType == 'Cambridge Florida' ||
                                                                                                                 ReferralRecordType = 'Cambridge Massachusetts' ||
                                                                                                                 ReferralRecordType = 'Cambridge Maryland' ||
                                                                                                                 ReferralRecordType = 'Cambridge Indiana' ||
                                                                                                                 ReferralRecordType = 'Cambridge North Carolina' ||
                                                                                                                 ReferralRecordType = 'Cambridge Ohio' ||
                                                                                                                 ReferralRecordType == 'CA FSS'}" />
                    <apex:pageBlockSectionItem rendered="{!ReferralRecordType == 'Illinois' || isCambridge || ReferralRecordType == 'CA FSS'}" />

                    <apex:inputTextarea value="{!Referral__c.ADL_Summary__c}" cols="50"
                        rows="3"
                        rendered="{!ReferralRecordType == 'Illinois' || ReferralRecordType == 'Cambridge Florida' ||
                                                                                                       ReferralRecordType = 'Cambridge Massachusetts' ||
                                                                                                       ReferralRecordType = 'Cambridge Maryland' ||
                                                                                                       ReferralRecordType = 'Cambridge Indiana' ||
                                                                                                       ReferralRecordType = 'Cambridge North Carolina' ||
                                                                                                       ReferralRecordType = 'Cambridge Ohio' ||
                                                                                                       ReferralRecordType == 'CA FSS'}" />
                    <apex:pageBlockSectionItem rendered="{!ReferralRecordType == 'Illinois' || isCambridge || ReferralRecordType == 'CA FSS'}" />

                    <apex:inputField value="{!Referral__c.Behavior_Summary__c}"
                        rendered="{!ReferralRecordType == 'Illinois'}" />
                    <apex:pageBlockSectionItem rendered="{!ReferralRecordType == 'Illinois'}" />

                    <apex:inputTextarea value="{!Referral__c.Current_Medications__c}"
                        rendered="{!ReferralRecordType == 'Illinois'}" />
                    <apex:pageBlockSectionItem rendered="{!ReferralRecordType == 'Illinois'}" />

                    <apex:pageBlockSectionItem rendered="{!OR(ReferralRecordType == 'Minnesota',ReferralRecordType == 'NeuroRestorative',ReferralRecordType == 'North Dakota')}" />
                    <apex:inputField value="{!Referral__c.Street_2__c}"
                        rendered="{!ReferralRecordType == 'NeuroRestorative'}"
                        id="Neuro_Street2" />
                    <apex:pageBlockSection rendered="{!ReferralRecordType=='NeuroRestorative'}" />
                    <apex:pageBlockSectionItem rendered="{!OR(ReferralRecordType == 'Minnesota',ReferralRecordType == 'NeuroRestorative',ReferralRecordType == 'North Dakota')}">
                        <apex:outputText value="City" />
                        <apex:outputPanel styleClass="nowrap">
                            <apex:inputText value="{!Referral__c.City__c}" id="MN_City" />&nbsp;
                        <apex:outputLabel value="State" />&nbsp;
                        <apex:inputField value="{!Referral__c.State__c}"
                                id="MN_State" />&nbsp;
                        <apex:outputLabel value="Zip" />&nbsp;
                        <apex:inputText value="{!Referral__c.Zip_Code__c}" style="width: 42px;"
                                id="MN_Zip" />
                        </apex:outputPanel>
                    </apex:pageBlockSectionItem>


                    <apex:pageBlockSectionItem rendered="{!OR(ReferralRecordType == 'Minnesota',ReferralRecordType == 'NeuroRestorative',ReferralRecordType == 'North Dakota')}" />
                    <apex:inputField value="{!Referral__c.Phone__c}"
                        rendered="{!OR(ReferralRecordType == 'Minnesota',ReferralRecordType == 'NeuroRestorative',ReferralRecordType == 'North Dakota')}"
                        id="MN_Phone" />
                    <apex:pageBlockSectionItem rendered="{!OR(ReferralRecordType == 'Minnesota',ReferralRecordType == 'NeuroRestorative',ReferralRecordType == 'North Dakota')}" />
                    <apex:inputField value="{!Referral__c.Email_Address__c}"
                        rendered="{!OR(ReferralRecordType == 'Minnesota',ReferralRecordType == 'NeuroRestorative',ReferralRecordType == 'North Dakota')}"
                        id="MN_Email" />

                    <apex:pageBlockSectionItem rendered="{!OR(ReferralRecordType == 'Minnesota',ReferralRecordType == 'NeuroRestorative',ReferralRecordType == 'North Dakota')}" />
                    <apex:inputField value="{!Referral__c.Fax__c}"
                        rendered="{!OR(ReferralRecordType == 'Minnesota',ReferralRecordType == 'NeuroRestorative',ReferralRecordType == 'North Dakota')}"
                        id="MN_Fax" />

                    <apex:pageBlockSectionItem rendered="{!OR(ReferralRecordType == 'Minnesota',ReferralRecordType == 'NeuroRestorative',ReferralRecordType == 'North Dakota')}" />
                    <apex:inputField value="{!Referral__c.Estimated_Discharge_Date__c}"
                        rendered="{!OR(ReferralRecordType == 'Minnesota',ReferralRecordType == 'NeuroRestorative',ReferralRecordType == 'North Dakota')}" />

                    <apex:pageBlockSectionItem rendered="{!OR(ReferralRecordType == 'Minnesota',ReferralRecordType == 'NeuroRestorative',ReferralRecordType == 'North Dakota')}" />
                    <apex:inputField value="{!Referral__c.Referring_Physician__c}"
                        rendered="{!OR(ReferralRecordType == 'Minnesota',ReferralRecordType == 'NeuroRestorative',ReferralRecordType == 'North Dakota')}" />


                    <apex:pageBlockSectionItem rendered="{!ReferralRecordType=='NeuroRestorative'}" />
                    <apex:inputField value="{!Referral__c.Previous_Brain_Injury__c}"
                        rendered="{!ReferralRecordType=='NeuroRestorative'}">
                        <apex:actionSupport event="onchange" reRender="ReferralDetail" />
                    </apex:inputField>

                    <apex:pageBlockSectionItem rendered="{!AND(ReferralRecordType=='NeuroRestorative',Referral__c.Previous_Brain_Injury__c=='Yes')}" />
                    <apex:inputField value="{!Referral__c.Type_of_Injury_Previous__c}"
                        rendered="{!AND(ReferralRecordType=='NeuroRestorative',Referral__c.Previous_Brain_Injury__c=='Yes')}" />
                    <apex:pageBlockSectionItem rendered="{!AND(ReferralRecordType=='NeuroRestorative',Referral__c.Previous_Brain_Injury__c=='Yes')}" />
                    <apex:inputField value="{!Referral__c.Cause_Of_Injury_Previous__c}"
                        rendered="{!AND(ReferralRecordType=='NeuroRestorative',Referral__c.Previous_Brain_Injury__c=='Yes')}" />

                    <apex:pageBlockSectionItem rendered="{!ReferralRecordType=='NeuroRestorative'}" />
                    <apex:inputField value="{!Referral__c.Did_Alcohol_Contribute_to_Injury__c}"
                        rendered="{!ReferralRecordType=='NeuroRestorative'}">
                        <apex:actionSupport event="onchange" reRender="ReferralDetail" />
                    </apex:inputField>

                    <apex:pageBlockSectionItem rendered="{!AND(ReferralRecordType=='NeuroRestorative',Referral__c.Did_Alcohol_Contribute_to_Injury__c=='Yes')}" />
                    <apex:inputField value="{!Referral__c.Level_At_Time_of_Injury__c}"
                        rendered="{!AND(ReferralRecordType=='NeuroRestorative',Referral__c.Did_Alcohol_Contribute_to_Injury__c=='Yes')}" />
                    <apex:pageBlockSectionItem rendered="{!AND(ReferralRecordType=='NeuroRestorative',Referral__c.Did_Alcohol_Contribute_to_Injury__c=='Yes')}" />
                    <apex:inputField value="{!Referral__c.Current_Alcohol_Use__c}"
                        rendered="{!AND(ReferralRecordType=='NeuroRestorative',Referral__c.Did_Alcohol_Contribute_to_Injury__c=='Yes')}" />

                    <apex:pageBlockSectionItem rendered="{!ReferralRecordType=='NeuroRestorative'}" />
                    <apex:inputField value="{!Referral__c.Did_Drug_Use_Contribute_to_Injury__c}"
                        rendered="{!ReferralRecordType=='NeuroRestorative'}">
                        <apex:actionSupport event="onchange" reRender="ReferralDetail" />
                    </apex:inputField>

                    <apex:pageBlockSectionItem rendered="{!AND(ReferralRecordType=='NeuroRestorative',Referral__c.Did_Drug_Use_Contribute_to_Injury__c=='Yes')}" />
                    <apex:inputField value="{!Referral__c.Current_Drug_Use__c}"
                        rendered="{!AND(ReferralRecordType=='NeuroRestorative',Referral__c.Did_Drug_Use_Contribute_to_Injury__c=='Yes')}" />
                    <apex:pageBlockSectionItem rendered="{!AND(ReferralRecordType=='NeuroRestorative',Referral__c.Did_Drug_Use_Contribute_to_Injury__c=='Yes')}" />
                    <apex:inputField value="{!Referral__c.Litigation__c}"
                        rendered="{!AND(ReferralRecordType=='NeuroRestorative',Referral__c.Did_Drug_Use_Contribute_to_Injury__c=='Yes')}" />

                    <apex:pageBlockSectionItem rendered="{!ReferralRecordType=='NeuroRestorative'}" />
                    <apex:inputField value="{!Referral__c.Military_Service_Related_Injury__c}"
                        rendered="{!ReferralRecordType=='NeuroRestorative'}">
                        <apex:actionSupport event="onchange" reRender="ReferralDetail" />
                    </apex:inputField>

                    <apex:pageBlockSectionItem rendered="{!AND(ReferralRecordType=='NeuroRestorative',Referral__c.Military_Service_Related_Injury__c=='Yes')}" />
                    <apex:inputField value="{!Referral__c.Military_Status__c}"
                        rendered="{!AND(ReferralRecordType=='NeuroRestorative',Referral__c.Military_Service_Related_Injury__c=='Yes')}" />
                    <apex:pageBlockSectionItem rendered="{!AND(ReferralRecordType=='NeuroRestorative',Referral__c.Military_Service_Related_Injury__c=='Yes')}" />
                    <apex:inputField value="{!Referral__c.Branch_of_Service__c}"
                        rendered="{!AND(ReferralRecordType=='NeuroRestorative',Referral__c.Military_Service_Related_Injury__c=='Yes')}" />
                    <apex:pageBlockSectionItem rendered="{!AND(ReferralRecordType=='NeuroRestorative',Referral__c.Military_Service_Related_Injury__c=='Yes')}" />
                    <apex:inputField value="{!Referral__c.Years_of_Service__c}"
                        rendered="{!AND(ReferralRecordType=='NeuroRestorative',Referral__c.Military_Service_Related_Injury__c=='Yes')}" />

                    <apex:pageBlockSectionItem rendered="{!ReferralRecordType=='NeuroRestorative'}" />
                    
                    <apex:inputField value="{!Referral__c.Glasgow_Coma_Scale__c}"
                        rendered="{!ReferralRecordType=='NeuroRestorative'}" />
                    <apex:pageBlockSectionItem rendered="{!ReferralRecordType=='NeuroRestorative'}" />
                    <apex:inputField value="{!Referral__c.Duration_of_Unconsciousness__c}"
                        rendered="{!ReferralRecordType=='NeuroRestorative'}" />
                    <apex:pageBlockSectionItem rendered="{!ReferralRecordType=='NeuroRestorative'}" />
                    <apex:inputField value="{!Referral__c.Reported_By__c}"
                        rendered="{!ReferralRecordType=='NeuroRestorative'}" />

                    <apex:inputField value="{!Referral__c.Level_of_Disability__c}"
                        rendered="{!ReferralRecordType == 'California'}" />

                    <apex:inputField value="{!Referral__c.Health_and_Safety_Needs__c}"
                        rendered="{!AND(ReferralRecordType == 'West Virginia',referralRecordType!='CareMeridian')}" />
                    <apex:pageBlockSectionItem rendered="{!AND(ReferralRecordType == 'West Virginia',referralRecordType!='CareMeridian')}" />
                    <apex:inputField value="{!Referral__c.Anticipated_Job_Accomodations__c}"
                        rendered="{!AND(ReferralRecordType == 'West Virginia',referralRecordType!='CareMeridian')}" />

                    <apex:inputField value="{!Referral__c.Residential_Support_Rate_Established__c}"
                        rendered="{!ReferralRecordType == 'Wisconsin'}" />
                    <apex:pageBlockSectionItem rendered="{!ReferralRecordType == 'Wisconsin'}" />

                    <apex:inputField value="{!Referral__c.Residential_Support_Rate__c}"
                        rendered="{!ReferralRecordType == 'Wisconsin'}" />
                    <apex:pageBlockSectionItem rendered="{!ReferralRecordType == 'Wisconsin'}" />

                    <apex:inputField label="Patient's Current Location (if other than Home)"
                        value="{!Referral__c.Current_Location__c}"
                        rendered="{!ReferralRecordType == 'Wisconsin'}" />
                    <apex:pageBlockSectionItem rendered="{!ReferralRecordType == 'Wisconsin'}" />

                </apex:pageBlockSection>
                <apex:pageBlockSection showHeader="false" columns="1"
                    collapsible="false" id="ReferralServices">
                    <apex:inputField value="{!Referral__c.Program_Category__c}"
                        rendered="{! (isCambridge && referralRecordType!='Generic') || ReferralRecordType == 'CA FSS'}"
                        required="{!isCambridge || ReferralRecordType == 'CA FSS'}" />
                    <br />
                    <apex:inputField value="{!Referral__c.Service_Line__c}"
                        rendered="{! (isCambridge && referralRecordType!='Generic')  || ReferralRecordType == 'CA FSS'}"
                        required="{!isCambridge || ReferralRecordType == 'CA FSS'}" />
                    <br />
                    <apex:inputField id="servicesRequested"
                        value="{!Referral__c.Services_Requested__c}"
                        Rendered="{!referralRecordType!='CareMeridian'}"
                        required="{!isCambridge || ReferralRecordType == 'CA FSS'}" />
                    <apex:inputTextarea cols="50" rows="3"
                        value="{!Referral__c.Family_History__c}"
                        rendered="{! (isCambridge && referralRecordType!='Generic') || ReferralRecordType == 'CA FSS'}" />
                    <apex:inputTextarea cols="50" rows="3"
                        value="{!Referral__c.Medical_History__c}"
                        rendered="{! (isCambridge && referralRecordType!='Generic') || ReferralRecordType == 'CA FSS'}" />
                    <apex:inputTextarea cols="50" rows="3"
                        value="{!Referral__c.Behavior_Summary__c}"
                        rendered="{! (isCambridge && referralRecordType!='Generic') || ReferralRecordType == 'CA FSS'}" />
                    <apex:inputTextarea cols="50" rows="3"
                        value="{!Referral__c.Current_Medications__c}"
                        rendered="{!( (isCambridge && referralRecordType!='Generic') || ReferralRecordType == 'CA FSS') && !isLinkedPersonBeingServed}" />
                    <apex:outputField value="{!personBeingServedRecord.Current_Medications__c}"
                        rendered="{!( (isCambridge && referralRecordType!='Generic') || ReferralRecordType == 'CA FSS') && isLinkedPersonBeingServed}" />
                    <apex:inputField value="{!Referral__c.Prior_Program_Information__c}"
                        style="width: 90%;"
                        Rendered="{!referralRecordType!='CareMeridian'}" />
                    <apex:inputField value="{!Referral__c.Comments__c}"
                        style="width: 90%;" />
                </apex:pageBlockSection>

                <!-- Diagnosis Old Code, Commented some fields, moving to refferal detail section End-->

                <apex:pageBlockSection showHeader="false" columns="1"
                    collapsible="false" id="ReferralDetail_1">
                    <apex:inputField value="{!Referral__c.Reason_for_Referral__c}"
                        style="width: 90%;" rendered="{!ReferralRecordType !='Adult Day Health'}"/>
                    <apex:inputTextarea value="{!Referral__c.Update_Notes__c}"
                        style="width: 90%;" />

                    <apex:inputField id="infoRealese"
                        value="{!Referral__c.Is_Information_Release_Signed__c}"
                        rendered="{!ReferralRecordType == 'Wisconsin'}" />
                    <apex:pageBlockSectionItem rendered="{!ReferralRecordType == 'Wisconsin'}" />
                    <apex:inputField value="{!Referral__c.OwnerID}"
                        rendered="{!Referral__c.id != null}" />
                </apex:pageBlockSection>
                <apex:actionRegion >
                    <apex:pageBlockSection title="Placement Risk"
                        id="placementRiskBlock"
                        rendered="{!referralRecordType=='Cambridge Florida' ||
                                                                                        ReferralRecordType = 'Cambridge Massachusetts' ||
                                                                                        ReferralRecordType = 'Cambridge Maryland' ||
                                                                                        ReferralRecordType = 'Cambridge Indiana' ||
                                                                                        ReferralRecordType = 'Cambridge North Carolina' ||
                                                                                        ReferralRecordType = 'Cambridge Ohio' ||
                                                                                        ReferralRecordType=='CA FSS'}">
                        <apex:inputField label="Is the person at risk of an out of home placement?"
                            value="{!Referral__c.Risk_of_Out_of_Home_Placement__c}">
                            <apex:actionStatus id="statusPlaceRisk">
                                <apex:facet name="start">
                                    <div class="waitingHolder"
                                        style="display: inline; margin-left: 5px; position: relative; top: 5px;">
                                        <img class="waitingImage" src="/img/loading.gif"
                                            title="Please Wait..." /> <span class="waitingDescription"></span>
                                    </div>
                                </apex:facet>
                                <apex:facet name="stop"></apex:facet>
                            </apex:actionStatus>
                            <apex:actionSupport event="onchange"
                                rerender="placementRiskBlock" status="statusPlaceRisk" />
                        </apex:inputField>

                        <apex:inputField label="How great is the risk?"
                            value="{!Referral__c.Risk_Level__c}" html-disabled="true"
                            rendered="{!Referral__c.Risk_of_Out_of_Home_Placement__c!='Yes'}" />
                        <apex:inputField label="How great is the risk?"
                            value="{!Referral__c.Risk_Level__c}"
                            rendered="{!Referral__c.Risk_of_Out_of_Home_Placement__c=='Yes'}" />
                        <apex:inputField label="Select the type of placement that would be most likely to occur, should an out of home placement be required:"
                            value="{!Referral__c.Placement_Type_Risk__c}"
                            html-disabled="true"
                            rendered="{!Referral__c.Risk_of_Out_of_Home_Placement__c!='Yes'}" />
                        <apex:inputField label="Select the type of placement that would be most likely to occur, should an out of home placement be required:"
                            value="{!Referral__c.Placement_Type_Risk__c}"
                            rendered="{!Referral__c.Risk_of_Out_of_Home_Placement__c=='Yes'}">
                            <apex:actionStatus id="statusPlaceTypeRisk">
                                <apex:facet name="start">
                                    <div class="waitingHolder"
                                        style="display: inline; margin-left: 5px; position: relative; top: 5px;">
                                        <img class="waitingImage" src="/img/loading.gif"
                                            title="Please Wait..." /> <span class="waitingDescription"></span>
                                    </div>
                                </apex:facet>
                                <apex:facet name="stop"></apex:facet>
                            </apex:actionStatus>
                            <apex:actionSupport event="onchange"
                                rerender="placementRiskBlock" status="statusPlaceTypeRisk" />
                        </apex:inputField>
                        <apex:inputField label="Other (specify)"
                            value="{!Referral__c.Other_Placement_Type_Desc__c}"
                            html-disabled="true"
                            rendered="{!Referral__c.Placement_Type_Risk__c!='Other (specify)' || Referral__c.Risk_of_Out_of_Home_Placement__c!='Yes'}" />
                        <apex:inputField label="Other (specify)"
                            value="{!Referral__c.Other_Placement_Type_Desc__c}"
                            rendered="{!Referral__c.Placement_Type_Risk__c=='Other (specify)' && Referral__c.Risk_of_Out_of_Home_Placement__c=='Yes'}" />
                        <script type="text/javascript">
                        clearDisableField('placementRiskBlock');
                    </script>
                    </apex:pageBlockSection>

                    <apex:pageBlockSection id="PlacementHxBlockSection"
                        title="Placement History"
                        rendered="{!referralRecordType=='Cambridge Florida' ||
                                                                                                ReferralRecordType = 'Cambridge Massachusetts' ||
                                                                                                ReferralRecordType = 'Cambridge Maryland' ||
                                                                                                ReferralRecordType = 'Cambridge Indiana' ||
                                                                                                ReferralRecordType = 'Cambridge North Carolina' ||
                                                                                                ReferralRecordType = 'Cambridge Ohio' ||
                                                                                                ReferralRecordType=='CA FSS'}">
                        <apex:pageBlockSectionItem >
                            <apex:outputLabel for="placementhist"
                                value="Does the person have a history of placement (past or current)?" />
                            <apex:inputField id="placementhist"
                                value="{!Referral__c.Placement_History__c}">
                                <apex:actionStatus id="statusPlaceHx">
                                    <apex:facet name="start">
                                        <div class="waitingHolder"
                                            style="display: inline; margin-left: 5px; position: relative; top: 5px;">
                                            <img class="waitingImage" src="/img/loading.gif"
                                                title="Please Wait..." /> <span class="waitingDescription"></span>
                                        </div>
                                    </apex:facet>
                                    <apex:facet name="stop"></apex:facet>
                                </apex:actionStatus>
                                <apex:actionSupport event="onchange"
                                    rerender="PlacementHxBlockSection" status="statusPlaceHx" />
                            </apex:inputField>
                        </apex:pageBlockSectionItem>
                        <apex:inputField label="Is this a reunification process due to recent placement back in the home/community?"
                            value="{!Referral__c.Is_Reunification_Process__c}"
                            html-disabled="true"
                            rendered="{!Referral__c.Placement_History__c!='Yes'}" />
                        <apex:inputField label="Is this a reunification process due to recent placement back in the home/community?"
                            value="{!Referral__c.Is_Reunification_Process__c}"
                            rendered="{!Referral__c.Placement_History__c=='Yes'}" />
                        <apex:pageBlockSectionItem >
                            <hr />
                        </apex:pageBlockSectionItem>
                        <apex:pageBlockSectionItem >
                            <hr />
                        </apex:pageBlockSectionItem>
                        <apex:pageBlockSectionItem >
                            <apex:outputText value="Current Placement Info"
                                style="font-weight:bold;" />
                        </apex:pageBlockSectionItem>
                        <apex:pageBlockSectionItem />

                        <apex:inputField label="Is the person currently in an out of home placement?"
                            value="{!Referral__c.Placement_Current__c}" html-disabled="true"
                            rendered="{!Referral__c.Placement_History__c!='Yes'}" />
                        <apex:pageblocksectionitem rendered="{!Referral__c.Placement_History__c=='Yes'}">
                            <apex:outputlabel for="outofhome"
                                value="Is the person currently in an out of home placement?" />
                            <apex:inputField id="outofhome"
                                value="{!Referral__c.Placement_Current__c}">
                                <apex:actionStatus id="statusPlaceCur">
                                    <apex:facet name="start">
                                        <div class="waitingHolder"
                                            style="display: inline; margin-left: 5px; position: relative; top: 5px;">
                                            <img class="waitingImage" src="/img/loading.gif"
                                                title="Please Wait..." /> <span class="waitingDescription"></span>
                                        </div>
                                    </apex:facet>
                                    <apex:facet name="stop"></apex:facet>
                                </apex:actionStatus>
                                <apex:actionSupport event="onchange"
                                    rerender="PlacementHxBlockSection" status="statusPlaceCur" />
                            </apex:inputField>
                        </apex:pageblocksectionitem>
                        <apex:inputField label="Is the plan to return the person to home/community?"
                            value="{!Referral__c.Placement_History_Plan_to_Return__c}"
                            html-disabled="true"
                            rendered="{!Referral__c.Placement_History__c!='Yes' || Referral__c.Placement_Current__c!='Yes'}" />
                        <apex:inputField label="Is the plan to return the person to home/community?"
                            value="{!Referral__c.Placement_History_Plan_to_Return__c}"
                            rendered="{!Referral__c.Placement_History__c=='Yes' && Referral__c.Placement_Current__c=='Yes'}" />
                        <apex:inputField label="Select the type of the current out of home placement:"
                            value="{!Referral__c.Placement_Type_Current__c}"
                            html-disabled="true"
                            rendered="{!Referral__c.Placement_History__c!='Yes' || Referral__c.Placement_Current__c!='Yes'}" />
                        <apex:pageBlockSectionItem rendered="{!Referral__c.Placement_History__c=='Yes' && Referral__c.Placement_Current__c=='Yes'}">
                            <apex:outputlabel for="typeofhomePlacement"
                                value="Select the type of the current out of home placement:" />
                            <apex:inputField id="typeofhomePlacement"
                                value="{!Referral__c.Placement_Type_Current__c}">
                                <apex:actionStatus id="statusPlaceTypeCur">
                                    <apex:facet name="start">
                                        <div class="waitingHolder"
                                            style="display: inline; margin-left: 5px; position: relative; top: 5px;">
                                            <img class="waitingImage" src="/img/loading.gif"
                                                title="Please Wait..." /> <span class="waitingDescription"></span>
                                        </div>
                                    </apex:facet>
                                    <apex:facet name="stop"></apex:facet>
                                </apex:actionStatus>
                                <apex:actionSupport event="onchange"
                                    rerender="PlacementHxBlockSection" status="statusPlaceTypeCur" />
                            </apex:inputField>
                        </apex:pageBlockSectionItem>
                        <apex:inputField label="Other (specify)"
                            value="{!Referral__c.Placement_Type_Current_Other__c}"
                            html-disabled="true"
                            rendered="{!Referral__c.Placement_History__c!='Yes' || Referral__c.Placement_Current__c!='Yes' || Referral__c.Placement_Type_Current__c!='Other (specify)'}" />
                        <apex:inputField label="Other (specify)" id="otherSpecifyPH"
                            value="{!Referral__c.Placement_Type_Current_Other__c}"
                            rendered="{!Referral__c.Placement_History__c=='Yes' && Referral__c.Placement_Current__c=='Yes' && Referral__c.Placement_Type_Current__c=='Other (specify)'}" />
                        <apex:pageBlockSectionItem >
                            <hr />
                        </apex:pageBlockSectionItem>
                        <apex:pageBlockSectionItem >
                            <hr />
                        </apex:pageBlockSectionItem>
                        <apex:pageBlockSectionItem >
                            <apex:outputText value="Previous Placement Info"
                                style="font-weight:bold;" />
                        </apex:pageBlockSectionItem>
                        <apex:pageBlockSectionItem />
                        <apex:inputField label="The person is not currently in an out of home placement but has a history of placements"
                            value="{!Referral__c.Placement_Non_Current_Historical__c}"
                            html-disabled="true"
                            rendered="{!Referral__c.Placement_History__c!='Yes'}" />
                        <apex:inputField label="The person is not currently in an out of home placement but has a history of placements"
                            value="{!Referral__c.Placement_Non_Current_Historical__c}"
                            rendered="{!Referral__c.Placement_History__c=='Yes'}" />
                        <apex:pageBlockSectionItem />
                        <apex:outputText value="If there have been previous placements, enter the number of each type of placement that has occurred (enter 0 for each type that has not occurred):"
                            styleClass="fieldLabel" />
                        <apex:pageBlockSectionItem />
                        <apex:inputField value="{!Referral__c.Placement_Foster_Care_Count__c}"
                            html-disabled="true"
                            rendered="{!Referral__c.Placement_History__c!='Yes'}" />
                        <apex:inputField value="{!Referral__c.Placement_Foster_Care_Count__c}"
                            rendered="{!Referral__c.Placement_History__c=='Yes'}" />
                        <apex:inputField value="{!Referral__c.Placement_Group_Home_Count__c}"
                            html-disabled="true"
                            rendered="{!Referral__c.Placement_History__c!='Yes'}" />
                        <apex:inputField value="{!Referral__c.Placement_Group_Home_Count__c}"
                            rendered="{!Referral__c.Placement_History__c=='Yes'}" />
                        <apex:inputField value="{!Referral__c.Placement_Relative_Count__c}"
                            html-disabled="true"
                            rendered="{!Referral__c.Placement_History__c!='Yes'}" />
                        <apex:inputField value="{!Referral__c.Placement_Relative_Count__c}"
                            rendered="{!Referral__c.Placement_History__c=='Yes'}" />
                        <apex:inputField label="Residential Treatment Facility (how many times?)"
                            value="{!Referral__c.Placement_ResTreatFacility_Count__c}"
                            html-disabled="true"
                            rendered="{!Referral__c.Placement_History__c!='Yes'}" />
                        <apex:inputField label="Residential Treatment Facility (how many times?)"
                            value="{!Referral__c.Placement_ResTreatFacility_Count__c}"
                            rendered="{!Referral__c.Placement_History__c=='Yes'}" />
                        <apex:inputField label="Psychiatric Hospitalization (how many times?)"
                            value="{!Referral__c.Placement_PsychHosp_Count__c}"
                            html-disabled="true"
                            rendered="{!Referral__c.Placement_History__c!='Yes'}" />
                        <apex:inputField label="Psychiatric Hospitalization (how many times?)"
                            value="{!Referral__c.Placement_PsychHosp_Count__c}"
                            rendered="{!Referral__c.Placement_History__c=='Yes'}" />
                        <apex:inputField label="Respite/Emergency Shelter (how many times?)"
                            value="{!Referral__c.Placement_RespEmShelter_Count__c}"
                            html-disabled="true"
                            rendered="{!Referral__c.Placement_History__c!='Yes'}" />
                        <apex:inputField label="Respite/Emergency Shelter (how many times?)"
                            value="{!Referral__c.Placement_RespEmShelter_Count__c}"
                            rendered="{!Referral__c.Placement_History__c=='Yes'}" />
                        <apex:inputField label="Group Home (Juvenile Services) (how many times?)"
                            value="{!Referral__c.Placement_GroupHomeJuv_Count__c}"
                            html-disabled="true"
                            rendered="{!Referral__c.Placement_History__c!='Yes'}" />
                        <apex:inputField label="Group Home (Juvenile Services) (how many times?)"
                            value="{!Referral__c.Placement_GroupHomeJuv_Count__c}"
                            rendered="{!Referral__c.Placement_History__c=='Yes'}" />
                        <apex:inputField label="Long Term Secure Confinement (how many times?)"
                            value="{!Referral__c.Placement_LongTermSecConfine_Count__c}"
                            html-disabled="true"
                            rendered="{!Referral__c.Placement_History__c!='Yes'}" />
                        <apex:inputField label="Long Term Secure Confinement (how many times?)"
                            value="{!Referral__c.Placement_LongTermSecConfine_Count__c}"
                            rendered="{!Referral__c.Placement_History__c=='Yes'}" />
                        <apex:inputField value="{!Referral__c.Placement_Secure_Detention_Count__c}"
                            html-disabled="true"
                            rendered="{!Referral__c.Placement_History__c!='Yes'}" />
                        <apex:inputField value="{!Referral__c.Placement_Secure_Detention_Count__c}"
                            rendered="{!Referral__c.Placement_History__c=='Yes'}" />
                        <apex:inputField label="Inpatient Substance Abuse Treatment (how many times?)"
                            value="{!Referral__c.Placement_InpatientSubAbuseTx_Count__c}"
                            html-disabled="true"
                            rendered="{!Referral__c.Placement_History__c!='Yes'}" />
                        <apex:inputField label="Inpatient Substance Abuse Treatment (how many times?)"
                            value="{!Referral__c.Placement_InpatientSubAbuseTx_Count__c}"
                            rendered="{!Referral__c.Placement_History__c=='Yes'}" />
                        <apex:inputField value="{!Referral__c.Placement_Other_Count__c}"
                            html-disabled="true"
                            rendered="{!Referral__c.Placement_History__c!='Yes'}" />
                        <apex:pageBlocksectionItem rendered="{!Referral__c.Placement_History__c=='Yes'}">
                            <apex:outputlabel value="Other (how many times?)"
                                for="placementotherCount" />
                            <apex:inputField value="{!Referral__c.Placement_Other_Count__c}"
                                id="placementotherCount">
                                <apex:actionStatus id="statusPlaceOtherCount">
                                    <apex:facet name="start">
                                        <div class="waitingHolder"
                                            style="display: inline; margin-left: 5px; position: relative; top: 5px;">
                                            <img class="waitingImage" src="/img/loading.gif"
                                                title="Please Wait..." /> <span class="waitingDescription"></span>
                                        </div>
                                    </apex:facet>
                                    <apex:facet name="stop"></apex:facet>
                                </apex:actionStatus>
                                <apex:actionSupport event="onchange"
                                    rerender="PlacementHxBlockSection"
                                    status="statusPlaceOtherCount" />
                            </apex:inputField>

                        </apex:pageBlocksectionItem>
                        <apex:inputField value="{!Referral__c.Placement_Past_Other_Describe__c}"
                            html-disabled="true"
                            rendered="{!Referral__c.Placement_History__c!='Yes' || Referral__c.Placement_Other_Count__c == null || Referral__c.Placement_Other_Count__c == 0}" />
                        <apex:inputField value="{!Referral__c.Placement_Past_Other_Describe__c}" id="otherDescribePP"
                            rendered="{!Referral__c.Placement_History__c=='Yes' && Referral__c.Placement_Other_Count__c != null && Referral__c.Placement_Other_Count__c > 0}" />
                        <script type="text/javascript">
                        clearDisableField('PlacementHxBlockSection');
                    </script>
                    </apex:pageBlockSection>
                </apex:actionRegion>

                <apex:pageBlockSection id="JuvBlockSection"
                    title="Juvenile Services Info"
                    rendered="{!referralRecordType=='Cambridge Florida' ||
                        ReferralRecordType = 'Cambridge Massachusetts' ||
                        ReferralRecordType = 'Cambridge Maryland' ||
                        ReferralRecordType = 'Cambridge Indiana' ||
                        ReferralRecordType = 'Cambridge North Carolina' ||
                        ReferralRecordType = 'Cambridge Ohio' ||
                        ReferralRecordType=='CA FSS'}">
                    <apex:pageBlockSectionItem >
                        <apex:outputlabel for="previnvolvecb"
                            value="Previous Juvenile Services Involvement?" />
                        <apex:actionregion >
                            <apex:inputField value="{!Referral__c.Previous_Juvenile_Services_Involvement__c}"
                                id="previnvolvecb">

                                <apex:actionStatus id="statusPrevJuv">
                                    <apex:facet name="start">
                                        <div class="waitingHolder"
                                            style="display: inline; margin-left: 5px; position: relative; top: 5px;">
                                            <img class="waitingImage" src="/img/loading.gif"
                                                title="Please Wait..." /> <span class="waitingDescription"></span>
                                        </div>
                                    </apex:facet>
                                    <apex:facet name="stop"></apex:facet>
                                </apex:actionStatus>
                                <apex:actionSupport event="onchange"
                                    rerender="HxBlock,moreHxBlock" status="statusPrevJuv" />
                            </apex:inputField>
                        </apex:actionregion>
                    </apex:pageBlockSectionItem>
                    <apex:pageblockSectionItem />
                    <apex:pageBlockSectionItem >
                        <apex:outputlabel for="currinvolvecb"
                            value="Current Juvenile Services Involvement?" />
                        <apex:actionregion >
                            <apex:inputField value="{!Referral__c.Current_Juvenile_Services_Involvement__c}"
                                id="currinvolveb2">

                                <apex:actionStatus id="statusCurrJuv">
                                    <apex:facet name="start">
                                        <div class="waitingHolder"
                                            style="display: inline; margin-left: 5px; position: relative; top: 5px;">
                                            <img class="waitingImage" src="/img/loading.gif"
                                                title="Please Wait..." /> <span class="waitingDescription"></span>
                                        </div>
                                    </apex:facet>
                                    <apex:facet name="stop"></apex:facet>
                                </apex:actionStatus>
                                <apex:actionSupport event="onchange"
                                    rerender="HxBlock,moreHxBlock" status="statusCurrJuv" />
                            </apex:inputField>
                        </apex:actionregion>
                    </apex:pageBlockSectionItem>
                    <apex:pageblockSectionItem />
                </apex:pageBlockSection>
                <apex:pageBlockSection id="HxBlock"
                    rendered="{!referralRecordType=='Cambridge Florida' ||
                        ReferralRecordType = 'Cambridge Massachusetts' ||
                        ReferralRecordType = 'Cambridge Maryland' ||
                        ReferralRecordType = 'Cambridge Indiana' ||
                        ReferralRecordType = 'Cambridge North Carolina' ||
                        ReferralRecordType = 'Cambridge Ohio' ||
                        ReferralRecordType=='CA FSS'}">

                    <apex:inputField label="Current Charges"
                        value="{!Referral__c.Current_Charges__c}" html-disabled="true"
                        rendered="{!Referral__c.Current_Juvenile_Services_Involvement__c!='Yes' }"
                        style="width:95%;" />
                    <apex:inputField label="Current Charges"
                        value="{!Referral__c.Current_Charges__c}"
                        rendered="{!Referral__c.Current_Juvenile_Services_Involvement__c=='Yes' }"
                        style="width:95%;"
                        required="{!Referral__c.Current_Juvenile_Services_Involvement__c == 'Yes'}" />
                    <apex:pageBlockSectionItem />

                    <apex:inputField label="Is this charge considered a misdemeanor?"
                        value="{!Referral__c.Misdemeanor__c}" html-disabled="true"
                        rendered="{!Referral__c.Current_Juvenile_Services_Involvement__c!='Yes'}" />
                    <apex:pageBlockSectionItem rendered="{!Referral__c.Current_Juvenile_Services_Involvement__c=='Yes' }">
                        <apex:outputLabel for="misdemeanor"
                            value="Is this charge considered a misdemeanor?" />
                        <apex:actionRegion >
                            <apex:inputField id="misdemeanor"
                                value="{!Referral__c.Misdemeanor__c}"
                                rendered="{!Referral__c.Current_Juvenile_Services_Involvement__c=='Yes' }"
                                required="{!Referral__c.Current_Juvenile_Services_Involvement__c=='Yes' }">
                                <apex:actionStatus id="statusMis">
                                    <apex:facet name="start">
                                        <div class="waitingHolder"
                                            style="display: inline; margin-left: 5px; position: relative; top: 5px;">
                                            <img class="waitingImage" src="/img/loading.gif"
                                                title="Please Wait..." /> <span class="waitingDescription"></span>
                                        </div>
                                    </apex:facet>
                                    <apex:facet name="stop"></apex:facet>
                                </apex:actionStatus>
                                <apex:actionSupport event="onchange" rerender="moreHxBlock"
                                    status="statusMis" />
                            </apex:inputField>
                        </apex:actionRegion>
                    </apex:pageBlockSectionItem>

                    <apex:inputField label="Is this charge considered a felony?"
                        value="{!Referral__c.Felony__c}" html-disabled="true"
                        rendered="{!Referral__c.Current_Juvenile_Services_Involvement__c!='Yes' }" />
                    <apex:pageBlockSectionItem rendered="{!Referral__c.Current_Juvenile_Services_Involvement__c=='Yes' }">
                        <apex:outputLabel for="felony"
                            value="Is this charge considered a felony?" />
                        <apex:actionregion >

                            <apex:inputField id="felony" value="{!Referral__c.Felony__c}"
                                required="{!Referral__c.Current_Juvenile_Services_Involvement__c=='Yes'}">
                                <apex:actionStatus id="statusFel">
                                    <apex:facet name="start">
                                        <div class="waitingHolder"
                                            style="display: inline; margin-left: 5px; position: relative; top: 5px;">
                                            <img class="waitingImage" src="/img/loading.gif"
                                                title="Please Wait..." /> <span class="waitingDescription"></span>
                                        </div>
                                    </apex:facet>
                                    <apex:facet name="stop"></apex:facet>
                                </apex:actionStatus>
                                <apex:actionSupport event="onchange" rerender="moreHxBlock"
                                    status="statusFel" />
                            </apex:inputField>
                        </apex:actionregion>
                    </apex:pageBlockSectionItem>

                </apex:pageBlockSection>
                <apex:pageBlockSection id="moreHxBlock"
                    rendered="{!referralRecordType=='Cambridge Florida' ||
                        ReferralRecordType = 'Cambridge Massachusetts' ||
                        ReferralRecordType = 'Cambridge Maryland' ||
                        ReferralRecordType = 'Cambridge Indiana' ||
                        ReferralRecordType = 'Cambridge North Carolina' ||
                        ReferralRecordType = 'Cambridge Ohio' ||
                        ReferralRecordType=='CA FSS'}">

                    <apex:inputField label="Is this client considered pre-court with charges pending?"
                        value="{!Referral__c.Pre_Court__c}" html-disabled="true"
                        rendered="{! Referral__c.Current_Juvenile_Services_Involvement__c!='Yes' || (Referral__c.Felony__c!='Yes' && Referral__c.Misdemeanor__c!='Yes')}" />

                    <apex:inputField label="Is this client considered pre-court with charges pending?"
                        value="{!Referral__c.Pre_Court__c}"
                        rendered="{! Referral__c.Current_Juvenile_Services_Involvement__c=='Yes' && (Referral__c.Felony__c=='Yes' || Referral__c.Misdemeanor__c=='Yes')}"
                        required="{! Referral__c.Current_Juvenile_Services_Involvement__c=='Yes' && (Referral__c.Felony__c=='Yes' || Referral__c.Misdemeanor__c=='Yes')}" />

                    <apex:inputField value="{!Referral__c.Adjudicated_Delinquent__c}"
                        html-disabled="true"
                        rendered="{! Referral__c.Current_Juvenile_Services_Involvement__c!='Yes' || (Referral__c.Felony__c!='Yes' && Referral__c.Misdemeanor__c!='Yes')}" />
                    <apex:inputField id="delinquent"
                        value="{!Referral__c.Adjudicated_Delinquent__c}"
                        rendered="{! Referral__c.Current_Juvenile_Services_Involvement__c=='Yes' && (Referral__c.Felony__c=='Yes' || Referral__c.Misdemeanor__c=='Yes')}"
                        required="{! Referral__c.Current_Juvenile_Services_Involvement__c=='Yes' && (Referral__c.Felony__c=='Yes' || Referral__c.Misdemeanor__c=='Yes')}" />

                    <apex:inputField value="{!Referral__c.Probation__c}"
                        html-disabled="true"
                        rendered="{! Referral__c.Current_Juvenile_Services_Involvement__c!='Yes' || (Referral__c.Felony__c!='Yes' && Referral__c.Misdemeanor__c!='Yes')}" />
                    <apex:inputField id="probation" value="{!Referral__c.Probation__c}"
                        rendered="{! Referral__c.Current_Juvenile_Services_Involvement__c=='Yes' && (Referral__c.Felony__c=='Yes' || Referral__c.Misdemeanor__c=='Yes')}"
                        required="{! Referral__c.Current_Juvenile_Services_Involvement__c=='Yes' && (Referral__c.Felony__c=='Yes' || Referral__c.Misdemeanor__c=='Yes')}" />

                    <apex:inputField label="Is this client receiving after care supervision?"
                        value="{!Referral__c.After_Care__c}" html-disabled="true"
                        rendered="{! Referral__c.Current_Juvenile_Services_Involvement__c!='Yes' || (Referral__c.Felony__c!='Yes' && Referral__c.Misdemeanor__c!='Yes')}" />
                    <apex:inputField id="supervised"
                        label="Is this client receiving after care supervision?"
                        value="{!Referral__c.After_Care__c}"
                        rendered="{! Referral__c.Current_Juvenile_Services_Involvement__c=='Yes' && (Referral__c.Felony__c=='Yes' || Referral__c.Misdemeanor__c=='Yes')}"
                        required="{! Referral__c.Current_Juvenile_Services_Involvement__c=='Yes' && (Referral__c.Felony__c=='Yes' || Referral__c.Misdemeanor__c=='Yes')}" />
                    <apex:inputField value="{!Referral__c.Repeat_Offender__c}"
                        html-disabled="true"
                        rendered="{! Referral__c.Current_Juvenile_Services_Involvement__c!='Yes' || (Referral__c.Felony__c!='Yes' && Referral__c.Misdemeanor__c!='Yes')}" />
                    <apex:inputField id="offender"
                        value="{!Referral__c.Repeat_Offender__c}"
                        rendered="{! Referral__c.Current_Juvenile_Services_Involvement__c=='Yes' && (Referral__c.Felony__c=='Yes' || Referral__c.Misdemeanor__c=='Yes')}"
                        required="{! Referral__c.Current_Juvenile_Services_Involvement__c=='Yes' && (Referral__c.Felony__c=='Yes' || Referral__c.Misdemeanor__c=='Yes')}" />
                    <script type="text/javascript">
                    clearDisableField('JuvBlockSection');
                    clearDisableField('HxBlock');
                    clearDisableField('moreHxBlock');
                </script>
                </apex:pageBlockSection>

                <apex:pageBlockSection showHeader="false" columns="2"
                    collapsible="false" id="ReferralStatus">
                    <apex:inputField id="closeDate"
                        value="{!Referral__c.Close_Date__c}"
                        rendered="{!Referral__c.Referral_Status__c=='Closed'}" />
                    <apex:pageblockSectionItem >
                    <apex:outputLabel value="Close Reason" for="closeReason"/>   
                    <apex:actionRegion >
                    <apex:inputField id="closeReason"
                        value="{!Referral__c.Close_Reason__c}"
                        rendered="{!Referral__c.Referral_Status__c=='Closed'}">
                        <apex:actionSupport event="onchange" rerender="ReferralStatus,levelOfEducation" oncomplete="unsetAdditionalFields(j$('select[id$=referralStatus]').val());"/>
                    </apex:inputField>
                    </apex:actionRegion>
                    </apex:pageblockSectionItem>
                    <apex:pageBlockSectionItem rendered="{!referralRecordType=='NeuroRestorative' && Referral__c.Referral_Status__c=='Closed' && (Referral__c.Close_Reason__c == 'Chose Another Service' || Referral__c.Close_Reason__c == 'Funding Inadequate' || Referral__c.Close_Reason__c == 'Could Not Meet Needs')}"/>
                    <apex:inputField id="closeDetail"
                        rendered="{!referralRecordType=='NeuroRestorative' && Referral__c.Referral_Status__c=='Closed' && (Referral__c.Close_Reason__c == 'Chose Another Service' || Referral__c.Close_Reason__c == 'Funding Inadequate' || Referral__c.Close_Reason__c == 'Could Not Meet Needs')}"
                        value="{!Referral__c.Close_Reason_Detail__c}"                                                                   
                        required="{!Referral__c.Close_Reason__c == 'Chose Another Service' || Referral__c.Close_Reason__c == 'Funding Inadequate' || Referral__c.Close_Reason__c == 'Could Not Meet Needs'}"> 
                    </apex:inputField>                    
                    <!-- EB-311 removing  close commnet condition for Hastings (Cambridge) flavors-->
                    <apex:pageBlockSectionItem rendered="{!Referral__c.Referral_Status__c=='Closed'}"/>                                                            
                    <apex:inputField id="closeComment"
                        value="{!Referral__c.Close_Comment__c}"
                        rendered="{!Referral__c.Referral_Status__c=='Closed'}" />
                    <apex:inputField id="holdDate" value="{!Referral__c.Hold_Date__c}"
                        rendered="{!Referral__c.Referral_Status__c=='On Hold'}" />
                    <apex:inputField id="holdReason"
                        value="{!Referral__c.Hold_Reason__c}"
                        rendered="{!Referral__c.Referral_Status__c=='On Hold'}" />
                    <apex:inputField id="reviewOn" value="{!Referral__c.Review_On__c}"
                        rendered="{!Referral__c.Referral_Status__c=='On Hold'}" />
                </apex:pageBlockSection>

                <apex:pageBlockSection title="Anticipated Admission Location Information" columns="1"
                    collapsible="false" id="LocationInfo">
                    <apex:pageBlockSectionItem helpText="Anticipated Admission DateTime is required to convert this referral to Admission">
                        <apex:outputLabel value="Anticipated Admission DateTime" />
                        <apex:outputPanel layout="none">
                            <c:MilitaryDatetime dateTimeVal="{!referralRecord.Anticipated_Admission_DateTime__c}"
                                edit="true" hiddenFieldId="antAdmDate" styleSheet="true" />
                            <apex:inputHidden id="antAdmDate"
                                value="{!referralRecord.Anticipated_Admission_DateTime__c}" />
                        </apex:outputPanel>
                    </apex:pageBlockSectionItem>
                    <apex:inputHidden id="sl_lkid"
                        value="{!Referral__c.Service_Location__c}" />

                    <apex:pageBlockSectionItem helpText="Anticipated Service Location (Alias) is required to convert this referral to Admission">
                        <apex:outputLabel value="Alias" />
                        <apex:pageBlockSectionItem >
                            <apex:inputText html-readonly="true" id="sl"
                                value="{!searchedServiceLocationName2}" size="20"
                                styleclass="refRequiedFields" />
                            <a id="originlookup" onClick="locationLookup2();"> <img
                                valign="bottom" src="/s.gif"
                                alt="Service Location Lookup (New Window)" class="lookupIcon"
                                onblur="this.className = 'lookupIcon';"
                                onfocus="this.className = 'lookupIconOn';"
                                onmouseout="this.className = 'lookupIcon';"
                                onmouseover="this.className = 'lookupIconOn';"
                                title="Service Location Lookup (New Window)" />
                            </a>
                        </apex:pageBlockSectionItem>
                    </apex:pageBlockSectionItem>

                </apex:pageBlockSection>

                <apex:outputText value="{!hasNonClosedPrimaryLocation}"
                    id="hasNonClosedPrimaryLocation" style="display: none; " />
                <apex:pageBlockSection columns="1"
                    title="{! if (ReferralRecordType == 'CareMeridian', 'Requested Locations', 'Locations Working Referral')}"
                    id="locations">
                    <apex:pageBlockSectionItem >
                        <apex:outputPanel layout="none">
                            <apex:commandButton value="Add Location" id="addLocation"
                                onclick="showAddLocation(); return false;" />
                            <apex:actionStatus id="AddLocationStatus">
                                <apex:facet name="start">
                                    <apex:image height="16px" value="/img/loading32.gif"
                                        styleClass="dialogLoadingSpinner" />
                                </apex:facet>
                                <apex:facet name="stop" />
                            </apex:actionStatus>
                        </apex:outputPanel>
                    </apex:pageBlockSectionItem>
                    <apex:pageBlockTable value="{!locations}" var="location"
                        id="referralLocations">
                        <apex:column headerValue="Alias"
                            value="{!location.Service_Location__c}" styleClass="noLink" />
                        <apex:column value="{!location.Service_Location__r.ProgramID__c}"
                            headerValue="Program Code" />
                        <apex:column value="{!location.Service_location__r.Location_Nickname__c}"
                            headerValue="Location Nickname" />
                        <apex:column headerValue="Address">
                            <apex:outputPanel >
                                <c:AddressDisplay Street1="{!location.Service_Location__r.Street__c}"
                                    City="{!location.Service_Location__r.City__c}"
                                    State="{!location.Service_location__r.State__c}"
                                    Zip="{!location.Service_location__r.Zip__c}" />
                                <br />
                                <apex:outputText value="{!location.Service_Location__r.Phone__c}" />
                            </apex:outputPanel>
                        </apex:column>
                        <apex:column value="{!location.Service_location__r.Physical_Location__c}"
                            headerValue="Physical Location" />
                        <apex:column value="{!location.Service_location__r.Service_Type__c}"
                            headerValue="Service Type" />
                        <apex:column value="{!location.User_Assigned__c}"
                            rendered="{! ReferralRecordType != 'CareMeridian'}"
                            headerValue="User Assigned" />
                        <apex:column value="{!location.Rank__c}"
                            rendered="{!ReferralRecordType == 'CareMeridian' || referralRecordType=='NeuroRestorative'}"
                            headerValue="Rank" />
                        <apex:column value="{!location.Status__c}" id="locationStatus"
                            headerValue="Status" />
                        <apex:column value="{!location.LastModifiedDate}"
                            headerValue="Last Modified Date" />
                    </apex:pageBlockTable>
                    <script type="text/javascript">
                    locationsData = '{!locationsJSON}';
                </script>
                    <apex:outputpanel style="display:none">

                        <apex:inputHidden value="{!location.User_Assigned__c}"
                            id="locationUser" />
                        <apex:inputHidden value="{!location.Status_String__c}"
                            id="locationStatus" />
                        <apex:inputHidden value="{!location.Rank__c}" id="locationRank" />
                    </apex:outputpanel>
                </apex:pageBlockSection>


                <!-- Diagnosis Section -->
                <a name="Diag" id="Diag"></a>
                <apex:pageBlockSection showHeader="true" columns="1"
                    title="Diagnosis Information" collapsible="false" id="diagsec">
                    <apex:pageBlockSectionItem >
                        <apex:actionRegion >
                            <apex:commandButton value="Add Diagnosis" id="addDiagnosis"
                                onClick="showAddDiagnosis();return false;" />
                            <apex:commandButton value="PRE 10/1/2015" id="prevDiagnosis"
                                onClick="window.open('/apex/PreICD_Diagnosis_Referral_PDF?id={!referralrecord.id}');return false;"
                                rendered="{!Referral__c.Referral_Status__c=='Active' && !(ReferralRecordType ='Adult Day Health')}" />
                            <apex:actionStatus id="AdddiagStatus">
                                <apex:facet name="start">
                                    <apex:image height="16px" value="/img/loading32.gif"
                                        styleClass="dialogLoadingSpinner" />
                                </apex:facet>
                                <apex:facet name="stop" />
                            </apex:actionStatus>
                        </apex:actionRegion>
                    </apex:pageBlockSectionItem>

                    <apex:pageBlockTable value="{!diagnoses}" var="dg">
                        <apex:column value="{!dg.ICD__c}" headerValue="ICD-10 Code"
                            styleClass="noLink" />
                       <!-- <apex:column value="{!dg.ICD__r.Code_Type__c}"
                            headerValue="Code Type" /> -->
                        <apex:column value="{!dg.ICD__r.Icd_Description__c}" headerValue="ICD-10/DSM-5 Description"/>
                        <apex:column headerValue="Date and Time of Diagnosis">
                            <c:MilitaryDatetime datetimeval="{!dg.Effective_Date__c}" />
                        </apex:column>
                        <apex:column value="{!dg.Status__c}" headerValue="Status" />
                        <!--<apex:column value="{!dg.Type__c}" headerValue="Type" />-->
                    </apex:pageBlockTable>
                    <apex:outputText value="No diagnoses to display"
                        rendered="{!diagnoses.size == 0}" />
                </apex:pageBlockSection>

                <!--- end -->



                <apex:pageBlockSection showHeader="true" title="Evaluation"
                    columns="1" collapsible="false"
                    rendered="{!OR(ReferralRecordType=='CareMeridian', AND(ReferralRecordType=='NeuroRestorative', showNeuroFeatures))}">
                    <apex:outputPanel >
                        <apex:variable var="emptyList" value="'[]'" />
                        <apex:variable var="evaluationList"
                            value="'{!Referral__c.Evaluations__r}'" />
                        <apex:commandButton value="Add Evaluation"
                            action="{!addEvaluation}"
                            rendered="{!AND(evaluationList == emptyList, ReferralRecord.Id != null, Referral__c.Referral_Status__c!='Closed')}" />
                        <apex:commandButton value="Add Evaluation"
                            onclick="alert('Please save the referral before creating a new Evaluation'); return false;"
                            rendered="{!ReferralRecord.Id == null}" />
                        <apex:commandButton value="Add Evaluation"
                            onclick="alert('You cannot add a new Evaluation to a Closed referral'); return false;"
                            rendered="{!Referral__c.Referral_Status__c=='Closed'}" />
                    </apex:outputPanel>
                    <apex:pageBlockTable value="{!Referral__c.Evaluations__r}"
                        var="evaluation">
                        <apex:column headerValue="Name">
                            <a href="/{!evaluation.Id}">{!evaluation.Name}</a>
                        </apex:column>
                        <apex:column headerValue="Signed"
                            value="{!evaluation.Is_Signed__c}"></apex:column>
                        <apex:column headerValue="Last Modified"
                            value="{!evaluation.LastModifiedDate}" />
                    </apex:pageBlockTable>
                </apex:pageBlockSection>

                <apex:pageBlockSection columns="1"
                    title="Agencies Involved With Individual" id="agencies"
                    rendered="{!ReferralRecordType!='CareMeridian'}">
                    <apex:pageBlockSectionItem >
                        <apex:commandButton value="Add Agency Involved With Individual"
                            id="addAgency"
                            onclick="showAddAgency();openModalDialogR('agencyModal', 'span', 'Add Agency','none'); return false;" />
                    </apex:pageBlockSectionItem>

                    <apex:pageBlockTable value="{!agencies}" var="agency">
                        <apex:column value="{!agency.Name}" />
                        <apex:column value="{!agency.Address__c}" />
                        <apex:column value="{!agency.Email__c}" />
                        <apex:column value="{!agency.Phone__c}" />
                        <apex:column value="{!agency.Reason_for_Involvement__c}" />
                        <apex:column value="{!agency.CreatedDate}" />
                    </apex:pageBlockTable>
                    <apex:outputpanel style="display:none">
                        <apex:inputHidden value="{!agency.Name}" id="agencyName" />
                        <apex:inputHidden value="{!agency.Address__c}" id="agencyAddress" />
                        <apex:inputHidden value="{!agency.Email__c}" id="agencyEmail" />
                        <apex:inputHidden value="{!agency.Phone__c}" id="agencyPhone" />
                        <apex:inputHidden value="{!agency.Reason_for_Involvement__c}"
                            id="agencyReason" />
                    </apex:outputpanel>
                </apex:pageBlockSection>

                <apex:pageBlockSection columns="1" title="Funding Sources"
                    id="fundingSources">
                    <apex:pageBlockSectionItem >
                        <apex:outputPanel layout="none">
                            <apex:commandButton value="Add Funding Source"
                                onclick="showAddFundingSource(); return false;" />
                            <apex:actionStatus id="AddFundingSourceStatus">
                                <apex:facet name="start">
                                    <apex:image height="16px" value="/img/loading32.gif"
                                        styleClass="dialogLoadingSpinner" />
                                </apex:facet>
                                <apex:facet name="stop" />
                            </apex:actionStatus>
                        </apex:outputPanel>
                    </apex:pageBlockSectionItem>

                    <apex:pageBlockTable value="{!fundingSources}" var="fundingSource"
                        rendered="{!ReferralRecordType != 'CareMeridian' && ReferralRecordType != 'NeuroRestorative' && ReferralRecordType !='Adult Day Health'}">
                        <apex:column value="{!fundingSource.Funding_Source__c}" />
                        <apex:column value="{!fundingSource.Funding_Source_ID__c}" />
                        <apex:column value="{!fundingSource.Service_Being_Funded__c}"
                            rendered="{!ReferralRecordType!='CareMeridian'}" />
                        <apex:column value="{!fundingSource.Payor__c}"
                            rendered="{!ReferralRecordType=='CareMeridian'}" />
                        <apex:column value="{!fundingSource.Status__c}" />
                        <apex:column value="{!fundingSource.Comment__c}" />
                        <apex:column value="{!fundingSource.CreatedDate}" />
                    </apex:pageBlockTable>
                    <apex:pageBlockTable value="{!fundingSources}" var="fundingSource"
                        rendered="{!ReferralRecordType == 'CareMeridian'}">
                        <apex:column value="{!fundingSource.Type_of_Coverage__c}" />
                        <apex:column value="{!fundingSource.Payer_Name__c}" />
                        <apex:column value="{!fundingSource.Effective_Date__c}" />
                        <apex:column value="{!fundingSource.Termination_Date__c}" />
                        <apex:column value="{!fundingSource.Status__c}" />
                        <apex:column value="{!fundingSource.Comment__c}" />
                    </apex:pageBlockTable>
                    <apex:pageBlockTable value="{!fundingSources}" var="fundingSource"
                        rendered="{!ReferralRecordType == 'NeuroRestorative'}">
                        <apex:column value="{!fundingSource.Type_of_Coverage__c}" />
                        <apex:column value="{!fundingSource.Payer_Name__c}" />
                        <apex:column value="{!fundingSource.Effective_Date__c}" />
                        <apex:column value="{!fundingSource.Termination_Date__c}" />
                        <apex:column value="{!fundingSource.Comment__c}" />
                        <apex:column value="{!fundingSource.Status__c}" />
                    </apex:pageBlockTable>
                    
                    <apex:pageBlockTable value="{!fundingSources}" var="fundingSource"
                        rendered="{!ReferralRecordType =='Adult Day Health'}">
                        <apex:column value="{!fundingSource.Type_of_Coverage__c}" />
                        <apex:column value="{!fundingSource.Payer_Name__c}" />
                        <!--<apex:column value="{!fundingSource.Effective_Date__c}" />
                        <apex:column value="{!fundingSource.Termination_Date__c}" /> -->
                        <apex:column value="{!fundingSource.Comment__c}" />
                        <apex:column value="{!fundingSource.Status__c}" />
                        <apex:column value="{!fundingSource.CreatedDate}" />
                    </apex:pageBlockTable>

                    <apex:inputHidden value="{!fundingSource.RecordType.Name}"
                        id="fundingSourceEntryRecordType" />
                    <apex:inputHidden value="{!fundingSource.RecordTypeId}"
                        id="fundingSourceEntryRecordTypeId" />
                </apex:pageBlockSection>

                <style>
[id$=activities] .requiredInput {
    display: inline-block;
    margin-left: 10px;
}

[id$=activities] .errorMsg {
    display: inline-block;
}
</style>
                <apex:pageBlockSection columns="1" title="Referral Tracking"
                    id="activities">
                    <apex:pageBlockSectionItem >
                        <apex:outputPanel >
                            <apex:commandButton value="Add Referral Tracking Task"
                                onclick="showAddActivity(); openModalDialogR('ActivityModal', 'span', 'Add Task','none'); return false;" />
                            <apex:actionRegion >
                                <apex:commandButton onclick="addAdmissionSteps(); return false;"
                                    value="Add Admission Steps"
                                    rendered="{!AND(OR(AND(ReferralRecordType='NeuroRestorative', showNeuroFeatures), ReferralRecordType='Illinois', ReferralRecordType='Wisconsin'), !Referral__c.Admission_Steps_Added__c, Referral__c.Referral_Status__c != 'Closed')}" />
                                <apex:outputLabel value="Admission Steps Assigned To"
                                    for="taskOwner"
                                    rendered="{!AND(OR(AND(ReferralRecordType='NeuroRestorative', showNeuroFeatures), ReferralRecordType='Illinois', ReferralRecordType='Wisconsin'), !Referral__c.Admission_Steps_Added__c, Referral__c.Referral_Status__c != 'Closed')}"
                                    style="margin-left: 8px; margin-right: 8px; " />
                                <apex:inputField value="{!dummyTask.OwnerId}"
                                    label="Assigned To" id="taskOwner"
                                    rendered="{!AND(OR(AND(ReferralRecordType='NeuroRestorative', showNeuroFeatures), ReferralRecordType='Illinois', ReferralRecordType='Wisconsin'), !Referral__c.Admission_Steps_Added__c, Referral__c.Referral_Status__c!='Closed')}"
                                    required="false" />
                                <apex:actionFunction name="addAdmissionSteps"
                                    action="{!addAdmissionSteps}" rerender="activities"
                                    status="taskAssignStatus" />
                            </apex:actionRegion>
                            <apex:actionStatus id="taskAssignStatus">
                                <apex:facet name="start">
                                    <apex:image height="16px" value="/img/loading32.gif"
                                        styleClass="dialogLoadingSpinner" />
                                </apex:facet>
                                <apex:facet name="stop" />
                            </apex:actionStatus>
                        </apex:outputPanel>
                    </apex:pageBlockSectionItem>

                    <apex:pageBlockTable value="{!activities}" var="activity">
                        <apex:column value="{!activity.Subject}" />
                        <apex:column value="{!activity.ActivityDate}" />
                        <apex:column value="{!activity.OwnerId}" />
                        <apex:column value="{!activity.Priority}" />
                        <apex:column value="{!activity.Status}" />
                        <apex:column value="{!activity.Description}" />
                    </apex:pageBlockTable>
                    <apex:outputPanel style="display:none"
                        rendered="{!activity != null}">
                        <apex:inputHidden value="{!activity.Subject}" id="activitySubject" />
                        <apex:inputHidden value="{!activity.Priority}"
                            id="activityPriority" />
                        <apex:inputHidden value="{!activity.Status}" id="activityStatus" />
                        <apex:inputHidden value="{!activity.OwnerId}" id="activityOwner" />
                        <apex:inputHidden value="{!activity.ActivityDate}"
                            id="activityActivityDate" />
                        <apex:inputHidden value="{!activity.Description}"
                            id="activityComments__c" />
                    </apex:outputPanel>

                </apex:pageBlockSection>

                <span id="progConsid"> <apex:pageBlockSection title="Programming Considerations" showHeader="true" columns="4"
                        collapsible="false" id="progConsid"
                        rendered="{!OR(AND(ReferralRecordType!='CareMeridian', ReferralRecordType!='NeuroRestorative'), AND(ReferralRecordType='NeuroRestorative', showNeuroFeatures))}">
                        <!-- Row 1, Col 1 -->
                        <apex:inputField value="{!Referral__c.Staffing_Needs__c}"
                            rendered="{!ReferralRecordType != 'Indiana' && ReferralRecordType != 'NeuroRestorative' && ReferralRecordType !='Adult Day Health'}" />
                        <apex:inputField value="{!Referral__c.Living_Environment__c}"
                            rendered="{!ReferralRecordType = 'Indiana' && ReferralRecordType != 'NeuroRestorative' && ReferralRecordType !='Adult Day Health'}" />
                        <apex:inputField value="{!Referral__c.Staffing_Ratio__c}"
                            rendered="{!ReferralRecordType = 'NeuroRestorative'}" />

                        <!-- Row 1, Col 2 -->
                        <apex:inputField value="{!Referral__c.Physically_Aggressive_to_Peers__c}"
                            rendered="{!ReferralRecordType = 'Cambridge Florida' ||
                        ReferralRecordType = 'Cambridge Massachusetts' ||
                        ReferralRecordType = 'Cambridge Maryland' ||
                        ReferralRecordType = 'Cambridge Indiana' ||
                        ReferralRecordType = 'Cambridge North Carolina' ||
                        ReferralRecordType = 'Cambridge Ohio' ||
                        ReferralRecordType = 'CA FSS'}" />
                        <apex:inputField value="{!Referral__c.Physically_Aggressive_to_Staff__c}"
                            rendered="{!ReferralRecordType = 'Cambridge Georgia' ||
                        ReferralRecordType = 'Cambridge New Jersey' ||
                        ReferralRecordType = 'Iowa' ||
                        ReferralRecordType = 'Illinois' ||
                        ReferralRecordType = 'Indiana' ||
                        ReferralRecordType = 'Minnesota' ||
                        ReferralRecordType = 'North Dakota' ||
                        ReferralRecordType = 'Ohio' ||
                        ReferralRecordType = 'Oregon' ||
                        ReferralRecordType = 'Wisconsin' ||
                        ReferralRecordType = 'West Virginia'}" />
                        <apex:inputField value="{!Referral__c.Area_of_State_Interested_In__c}"
                            rendered="{!ReferralRecordType = 'Arizona' ||
                        ReferralRecordType = 'California'||
                        ReferralRecordType = 'Nevada' || ReferralRecordType =='Adult Day Health'}" />
                       <apex:inputField value="{!Referral__c.Physically_Aggressive_to_Staff__c}"
                            rendered="{!ReferralRecordType =='Adult Day Health'}" />
                       <apex:inputField value="{!Referral__c.Physically_Aggressive_to_Self__c}"
                                     rendered="{!ReferralRecordType =='Adult Day Health'}" />
                       <apex:inputField value="{!Referral__c.Physically_Aggressive_to_Peers__c}"
                                     rendered="{!ReferralRecordType =='Adult Day Health'}" />
                       <apex:inputField value="{!Referral__c.Verbally_Aggressive__c}"
                                     rendered="{!ReferralRecordType =='Adult Day Health'}" />
                       <apex:inputField value="{!Referral__c.Suicide_Threats__c}"
                                        rendered="{!ReferralRecordType =='Adult Day Health'}" />
                       <apex:inputField value="{!Referral__c.Registered_Sex_Offender__c}" rendered="{!ReferralRecordType =='Adult Day Health'}" />
                    <apex:inputField value="{!Referral__c.Chemical_Use_Recovery__c}" rendered="{!ReferralRecordType =='Adult Day Health'}" />
                    <apex:inputField value="{!Referral__c.Property_Destruction__c}" rendered="{!ReferralRecordType =='Adult Day Health'}" />

                        <apex:pageBlockSectionItem rendered="{!ReferralRecordType = 'NeuroRestorative'}">
                            <apex:outputLabel value="Verbally Aggressive" />
                            <apex:outputPanel >
                                <apex:inputField value="{!Referral__c.Verbally_Aggressive__c}">
                                    <apex:actionSupport event="onchange" rerender="progConsid"
                                        status="verballyAggressiveStatus" />
                                </apex:inputField>
                                <apex:actionStatus id="verballyAggressiveStatus">
                                    <apex:facet name="start">
                                        <div class="waitingHolder"
                                            style="display: inline; margin-left: 5px; position: relative;">
                                            <img class="waitingImage" src="/img/loading.gif"
                                                title="Please Wait..." /> <span class="waitingDescription"></span>
                                        </div>
                                    </apex:facet>
                                    <apex:facet name="stop"></apex:facet>
                                </apex:actionStatus>
                            </apex:outputPanel>
                        </apex:pageBlockSectionItem>

                        <!-- Row 1, Col 3 -->
                        <apex:inputField value="{!Referral__c.Uses_Tobacco__c}"
                            rendered="{! (isCambridge && referralRecordType!='Generic') || ReferralRecordType = 'CA FSS' || ReferralRecordType =='Adult Day Health'}" />
                        <apex:inputField value="{!Referral__c.Property_Destruction__c}"
                            rendered="{!ReferralRecordType = 'Arizona' ||
                        ReferralRecordType = 'California' ||
                        ReferralRecordType = 'Iowa' ||
                        ReferralRecordType = 'Illinois' ||
                        ReferralRecordType = 'North Dakota' ||
                        ReferralRecordType = 'Nevada' ||
                        ReferralRecordType = 'Ohio' ||
                        ReferralRecordType = 'Oregon'}" />
                        <apex:inputField value="{!Referral__c.Self_Harm_or_Self_Injurous_Behaviors__c}"
                            rendered="{!ReferralRecordType = 'Indiana' ||
                        ReferralRecordType = 'Minnesota' ||
                        ReferralRecordType = 'West Virginia'}" />
                        <apex:inputField value="{!Referral__c.Law_Enforcement_Involvement__c}"
                            rendered="{!ReferralRecordType = 'Wisconsin'}" />
                        <apex:pageBlockSectionItem rendered="{!ReferralRecordType = 'NeuroRestorative'}">
                            <apex:outputLabel value="Theft" />
                            <apex:outputPanel >
                                <apex:inputField value="{!Referral__c.Theft__c}">
                                    <apex:actionSupport event="onchange" rerender="progConsid"
                                        status="theftStatus" />
                                </apex:inputField>
                                <apex:actionStatus id="theftStatus">
                                    <apex:facet name="start">
                                        <div class="waitingHolder"
                                            style="display: inline; margin-left: 5px; position: relative;">
                                            <img class="waitingImage" src="/img/loading.gif"
                                                title="Please Wait..." /> <span class="waitingDescription"></span>
                                        </div>
                                    </apex:facet>
                                    <apex:facet name="stop"></apex:facet>
                                </apex:actionStatus>
                            </apex:outputPanel>
                        </apex:pageBlockSectionItem>

                        <!-- Row 1, Col 4 -->
                        <apex:inputField value="{!Referral__c.Maintain_Sibling_Group__c}"
                            rendered="{! (isCambridge && referralRecordType!='Generic') || ReferralRecordType = 'CA FSS'}" />
                        <apex:inputField value="{!Referral__c.Nursing_Care_Needed__c}"
                            rendered="{!ReferralRecordType = 'Arizona' ||
                        ReferralRecordType = 'California' ||
                        ReferralRecordType = 'Iowa' ||
                        ReferralRecordType = 'Illinois' ||
                        ReferralRecordType = 'North Dakota' ||
                        ReferralRecordType = 'Nevada' ||
                        ReferralRecordType = 'Ohio' ||
                        ReferralRecordType = 'Oregon' ||
                        ReferralRecordType = 'Wisconsin'}" />
                        <apex:inputField value="{!Referral__c.Elopement__c}"
                            rendered="{!ReferralRecordType = 'Indiana'}" />
                        <apex:inputField value="{!Referral__c.Unwanted_Sexual_Behavior__c}"
                            rendered="{!ReferralRecordType = 'Minnesota' ||
                        ReferralRecordType = 'West Virginia'}" />
                        <apex:pageBlockSectionItem rendered="{!ReferralRecordType = 'NeuroRestorative'}">
                            <apex:outputLabel value="Unwanted Sexual Behavior" />
                            <apex:outputPanel >
                                <apex:inputField value="{!Referral__c.Unwanted_Sexual_Behavior__c}">
                                    <apex:actionSupport event="onchange" rerender="progConsid"
                                        status="unwantedSexualBehaviorStatus" />
                                </apex:inputField>
                                <apex:actionStatus id="unwantedSexualBehaviorStatus">
                                    <apex:facet name="start">
                                        <div class="waitingHolder"
                                            style="display: inline; margin-left: 5px; position: relative;">
                                            <img class="waitingImage" src="/img/loading.gif"
                                                title="Please Wait..." /> <span class="waitingDescription"></span>
                                        </div>
                                    </apex:facet>
                                    <apex:facet name="stop"></apex:facet>
                                </apex:actionStatus>
                            </apex:outputPanel>
                        </apex:pageBlockSectionItem>

                        <!-- Row 2, Col 1 -->
                        <apex:inputField value="{!Referral__c.Staffing_Ratio__c}"
                            rendered="{!ReferralRecordType != 'Indiana' && ReferralRecordType != 'NeuroRestorative' && ReferralRecordType !='Adult Day Health'}" />
                        <apex:inputField value="{!Referral__c.Mobility__c}"
                            rendered="{!ReferralRecordType = 'Indiana'  || ReferralRecordType =='Adult Day Health'}" />
                        <apex:inputField value="{!Referral__c.Desired_Living_Environment_at_Discharge__c}"
                            rendered="{!ReferralRecordType = 'NeuroRestorative'}" />

                        <!-- Row 2, Col 2 -->
                        <apex:inputField value="{!Referral__c.Verbally_Aggressive__c}"
                            rendered="{!ReferralRecordType = 'Cambridge Florida' ||
                        ReferralRecordType = 'Cambridge Massachusetts' ||
                        ReferralRecordType = 'Cambridge Maryland' ||
                        ReferralRecordType = 'Cambridge Indiana' ||
                        ReferralRecordType = 'Cambridge North Carolina' ||
                        ReferralRecordType = 'Cambridge Ohio' ||
                        ReferralRecordType = 'CA FSS'}" />
                        <apex:inputField value="{!Referral__c.Physically_Aggressive_to_Self__c}"
                            rendered="{!ReferralRecordType = 'Cambridge Georgia' ||
                        ReferralRecordType = 'Cambridge New Jersey' ||
                        ReferralRecordType = 'Iowa' ||
                        ReferralRecordType = 'Illinois' ||
                        ReferralRecordType = 'Indiana' ||
                        ReferralRecordType = 'Minnesota' ||
                        ReferralRecordType = 'North Dakota' ||
                        ReferralRecordType = 'Ohio' ||
                        ReferralRecordType = 'Oregon' ||
                        ReferralRecordType = 'Wisconsin' ||
                        ReferralRecordType = 'West Virginia'}" />
                        <apex:inputField value="{!Referral__c.Physically_Aggressive_to_Staff__c}"
                            rendered="{!ReferralRecordType = 'Arizona' ||
                        ReferralRecordType = 'California' ||
                        ReferralRecordType = 'Nevada'}" />
                        <apex:inputField value="{!Referral__c.Verbally_Aggressive_Description__c}" id="verballyAggressive"
                            label="Describe"
                            rendered="{!ReferralRecordType = 'NeuroRestorative' && Referral__c.Verbally_Aggressive__c}" />
                        <apex:pageBlockSectionItem rendered="{!ReferralRecordType = 'NeuroRestorative' && !Referral__c.Verbally_Aggressive__c}" />

                        <!-- Row 2, Col 3 -->
                        <apex:inputField value="{!Referral__c.Chemical_Use_Recovery__c}"
                            rendered="{! (isCambridge && referralRecordType!='Generic') || ReferralRecordType = 'CA FSS'}" />
                        <apex:inputField value="{!Referral__c.Law_Enforcement_Involvement__c}"
                            rendered="{!ReferralRecordType = 'Arizona' ||
                        ReferralRecordType = 'California' ||
                        ReferralRecordType = 'Iowa' ||
                        ReferralRecordType = 'Illinois' ||
                        ReferralRecordType = 'North Dakota' ||
                        ReferralRecordType = 'Nevada' ||
                        ReferralRecordType = 'Ohio' ||
                        ReferralRecordType = 'Oregon'}" />
                        <apex:inputField value="{!Referral__c.Property_Destruction__c}"
                            rendered="{!ReferralRecordType = 'Indiana' ||
                        ReferralRecordType = 'Minnesota' ||
                        ReferralRecordType = 'West Virginia'}"/>
                        <apex:inputField value="{!Referral__c.Uses_Tobacco__c}"
                            rendered="{!ReferralRecordType = 'Wisconsin'}" />
                        <apex:inputField value="{!Referral__c.Theft_Description__c}" id="theft"
                            label="Describe"
                            rendered="{!ReferralRecordType = 'NeuroRestorative' && Referral__c.Theft__c}" />
                        <apex:pageBlockSectionItem rendered="{!ReferralRecordType = 'NeuroRestorative' && !Referral__c.Theft__c}" />

                        <!-- Row 2, Col 4 -->
                        <apex:inputField value="{!Referral__c.If_Yes_How_Many__c}"
                            rendered="{! (isCambridge && referralRecordType!='Generic') || ReferralRecordType = 'CA FSS'}" />
                        <apex:inputField value="{!Referral__c.Level_of_Support_Required__c}"
                            rendered="{!ReferralRecordType = 'Arizona' ||
                        ReferralRecordType = 'California' ||
                        ReferralRecordType = 'Iowa' ||
                        ReferralRecordType = 'Illinois' ||
                        ReferralRecordType = 'North Dakota' ||
                        ReferralRecordType = 'Nevada' ||
                        ReferralRecordType = 'Ohio' ||
                        ReferralRecordType = 'Oregon' ||
                        ReferralRecordType = 'Wisconsin'}" />
                        <apex:inputField value="{!Referral__c.Unwanted_Sexual_Behavior__c}"
                            rendered="{!ReferralRecordType = 'Indiana'}" />
                        <apex:inputField value="{!Referral__c.Nursing_Care_Needed__c}"
                            rendered="{!ReferralRecordType = 'Minnesota' ||
                        ReferralRecordType = 'West Virginia'}" />
                        <apex:inputField value="{!Referral__c.If_Yes_Type_of_Unwanted_Sexual_Behavior__c}" id="unwantedSexualBehavior"
                            label="If Yes, Type"
                            rendered="{!ReferralRecordType = 'NeuroRestorative' && Referral__c.Unwanted_Sexual_Behavior__c}" />
                        <apex:pageBlockSectionItem rendered="{!ReferralRecordType = 'NeuroRestorative' && !Referral__c.Unwanted_Sexual_Behavior__c}" />

                        <!-- Row 3, Col 1 -->
                        <apex:inputField value="{!Referral__c.Living_Environment__c}"
                            rendered="{!ReferralRecordType != 'Indiana' && ReferralRecordType != 'NeuroRestorative' && ReferralRecordType !='Adult Day Health'}" />
                        <apex:inputField value="{!Referral__c.Accessible_Housing_Needed__c}"
                            rendered="{!ReferralRecordType = 'Indiana'}" />
                        <apex:pageBlockSectionItem rendered="{!ReferralRecordType = 'NeuroRestorative'}">
                            <apex:outputLabel value="Physically Aggressive To Staff" />
                            <apex:outputPanel >
                                <apex:inputField value="{!Referral__c.Physically_Aggressive_to_Staff__c}">
                                    <apex:actionSupport event="onchange" rerender="progConsid"
                                        status="aggressiveToStaffStatus" />
                                </apex:inputField>
                                <apex:actionStatus id="aggressiveToStaffStatus">
                                    <apex:facet name="start">
                                        <div class="waitingHolder"
                                            style="display: inline; margin-left: 5px; position: relative;">
                                            <img class="waitingImage" src="/img/loading.gif"
                                                title="Please Wait..." /> <span class="waitingDescription"></span>
                                        </div>
                                    </apex:facet>
                                    <apex:facet name="stop"></apex:facet>
                                </apex:actionStatus>
                            </apex:outputPanel>
                        </apex:pageBlockSectionItem>

                        <!-- Row 3, Col 2 -->
                        <apex:inputField value="{!Referral__c.Suicide_Threats__c}"
                            rendered="{!ReferralRecordType = 'Cambridge Florida' ||
                        ReferralRecordType = 'Cambridge Massachusetts' ||
                        ReferralRecordType = 'Cambridge Maryland' ||
                        ReferralRecordType = 'Cambridge Indiana' ||
                        ReferralRecordType = 'Cambridge North Carolina' ||
                        ReferralRecordType = 'Cambridge Ohio' ||
                        ReferralRecordType = 'CA FSS'}" />
                        <apex:inputField value="{!Referral__c.Physically_Aggressive_to_Peers__c}"
                            rendered="{!ReferralRecordType = 'Cambridge Georgia' ||
                        ReferralRecordType = 'Cambridge New Jersey' ||
                        ReferralRecordType = 'Iowa' ||
                        ReferralRecordType = 'Illinois' ||
                        ReferralRecordType = 'Indiana' ||
                        ReferralRecordType = 'Minnesota' ||
                        ReferralRecordType = 'North Dakota' ||
                        ReferralRecordType = 'Ohio' ||
                        ReferralRecordType = 'Oregon' ||
                        ReferralRecordType = 'Wisconsin' ||
                        ReferralRecordType = 'West Virginia'}" />
                        <apex:inputField value="{!Referral__c.Physically_Aggressive_to_Self__c}"
                            rendered="{!ReferralRecordType = 'Arizona' ||
                        ReferralRecordType = 'California' ||
                        ReferralRecordType = 'Nevada'}" />
                        <apex:pageBlockSectionItem rendered="{!ReferralRecordType = 'NeuroRestorative'}">
                            <apex:outputLabel value="Suicide Threats" />
                            <apex:outputPanel >
                                <apex:inputField value="{!Referral__c.Suicide_Threats__c}">
                                    <apex:actionSupport event="onchange" rerender="progConsid"
                                        status="suicideThreatsStatus" />
                                </apex:inputField>
                                <apex:actionStatus id="suicideThreatsStatus">
                                    <apex:facet name="start">
                                        <div class="waitingHolder"
                                            style="display: inline; margin-left: 5px; position: relative;">
                                            <img class="waitingImage" src="/img/loading.gif"
                                                title="Please Wait..." /> <span class="waitingDescription"></span>
                                        </div>
                                    </apex:facet>
                                    <apex:facet name="stop"></apex:facet>
                                </apex:actionStatus>
                            </apex:outputPanel>
                        </apex:pageBlockSectionItem>

                        <!-- Row 3, Col 3 -->
                        <apex:inputField value="{!Referral__c.Chemical_Use_Current__c}"
                            rendered="{! (isCambridge && referralRecordType!='Generic') || ReferralRecordType = 'CA FSS' || ReferralRecordType =='Adult Day Health'}" />
                        <apex:inputField value="{!Referral__c.Chemical_Use_Recovery__c}"
                            rendered="{!ReferralRecordType = 'Arizona' ||
                        ReferralRecordType = 'California' ||
                        ReferralRecordType = 'Iowa' ||
                        ReferralRecordType = 'Illinois' ||
                        ReferralRecordType = 'North Dakota' ||
                        ReferralRecordType = 'Nevada' ||
                        ReferralRecordType = 'Ohio' ||
                        ReferralRecordType = 'Oregon' ||
                        ReferralRecordType = 'Wisconsin'}" />
                        <apex:inputField value="{!Referral__c.Law_Enforcement_Involvement__c}"
                            rendered="{!ReferralRecordType = 'Indiana' ||
                        ReferralRecordType = 'Minnesota' ||
                        ReferralRecordType = 'West Virginia' || ReferralRecordType =='Adult Day Health'}" />
                        <apex:pageBlockSectionItem rendered="{!ReferralRecordType = 'NeuroRestorative'}">
                            <apex:outputLabel value="Tobacco Use (Current)" />
                            <apex:outputPanel >
                                <apex:inputField value="{!Referral__c.Uses_Tobacco__c}">
                                    <apex:actionSupport event="onchange" rerender="progConsid"
                                        status="usesTobaccoStatus" />
                                </apex:inputField>
                                <apex:actionStatus id="usesTobaccoStatus">
                                    <apex:facet name="start">
                                        <div class="waitingHolder"
                                            style="display: inline; margin-left: 5px; position: relative;">
                                            <img class="waitingImage" src="/img/loading.gif"
                                                title="Please Wait..." /> <span class="waitingDescription"></span>
                                        </div>
                                    </apex:facet>
                                    <apex:facet name="stop"></apex:facet>
                                </apex:actionStatus>
                            </apex:outputPanel>
                        </apex:pageBlockSectionItem>

                        <!-- Row 3, Col 4 -->
                        <apex:inputField value="{!Referral__c.No_Same_Sex_Peers__c}"
                            rendered="{! (isCambridge && referralRecordType!='Generic') || ReferralRecordType = 'CA FSS'}" />
                        <apex:inputField value="{!Referral__c.Unsupervised_Time__c}"
                            rendered="{!ReferralRecordType = 'Arizona' ||
                        ReferralRecordType = 'California' ||
                        ReferralRecordType = 'Iowa' ||
                        ReferralRecordType = 'Illinois' ||
                        ReferralRecordType = 'Indiana' ||
                        ReferralRecordType = 'North Dakota' ||
                        ReferralRecordType = 'Nevada' ||
                        ReferralRecordType = 'Ohio' ||
                        ReferralRecordType = 'Oregon' ||
                        ReferralRecordType = 'Wisconsin'}" />

                        <apex:inputField value="{!Referral__c.Level_of_Support_Required__c}"
                            rendered="{!ReferralRecordType = 'Minnesota' ||
                        ReferralRecordType = 'West Virginia'}" />
                        <apex:pageBlockSectionItem rendered="{!ReferralRecordType = 'NeuroRestorative'}">
                            <apex:outputLabel value="Current Pending Litigation" />
                            <apex:outputPanel >
                                <apex:inputField value="{!Referral__c.Current_Pending_Litigation__c}">
                                    <apex:actionSupport event="onchange" rerender="progConsid"
                                        status="currentPendingLitigationStatus" />
                                </apex:inputField>
                                <apex:actionStatus id="currentPendingLitigationStatus">
                                    <apex:facet name="start">
                                        <div class="waitingHolder"
                                            style="display: inline; margin-left: 5px; position: relative;">
                                            <img class="waitingImage" src="/img/loading.gif"
                                                title="Please Wait..." /> <span class="waitingDescription"></span>
                                        </div>
                                    </apex:facet>
                                    <apex:facet name="stop"></apex:facet>
                                </apex:actionStatus>
                            </apex:outputPanel>
                        </apex:pageBlockSectionItem>

                        <!-- Row 4, Col 1 -->
                        <apex:inputField value="{!Referral__c.Preferred_Setting__c}"
                            rendered="{! (isCambridge && referralRecordType!='Generic') || ReferralRecordType = 'CA FSS'}" />
                        <apex:inputField value="{!Referral__c.Mobility__c}"
                            rendered="{!ReferralRecordType = 'Arizona' ||
                        ReferralRecordType = 'California' ||
                        ReferralRecordType = 'Iowa' ||
                        ReferralRecordType = 'Illinois' ||
                        ReferralRecordType = 'Minnesota' ||
                        ReferralRecordType = 'North Dakota' ||
                        ReferralRecordType = 'Nevada' ||
                        ReferralRecordType = 'Ohio' ||
                        ReferralRecordType = 'Oregon' ||
                        ReferralRecordType = 'Wisconsin' ||
                        ReferralRecordType = 'West Virginia'}" />
                        <apex:inputField value="{!Referral__c.Accessible_Vehicle_Needed__c}"
                            rendered="{!ReferralRecordType = 'Indiana'}" />
                        <apex:inputField value="{!Referral__c.Aggressive_to_Staff_Description__c}"
                            id="aggressiveToStaffDescription" label="Describe"
                            rendered="{!ReferralRecordType = 'NeuroRestorative' && Referral__c.Physically_Aggressive_to_Staff__c}" />
                        <apex:pageBlockSectionItem rendered="{!ReferralRecordType = 'NeuroRestorative' && !Referral__c.Physically_Aggressive_to_Staff__c}" />

                        <!-- Row 4, Col 2 -->
                        <apex:inputField value="{!Referral__c.Suicide_Attempts__c}"
                            rendered="{!ReferralRecordType = 'Cambridge Florida' ||
                        ReferralRecordType = 'Cambridge Massachusetts' ||
                        ReferralRecordType = 'Cambridge Maryland' ||
                        ReferralRecordType = 'Cambridge Indiana' ||
                        ReferralRecordType = 'Cambridge North Carolina' ||
                        ReferralRecordType = 'Cambridge Ohio' ||
                        ReferralRecordType = 'CA FSS'}" />
                        <apex:inputField value="{!Referral__c.Verbally_Aggressive__c}"
                            rendered="{!ReferralRecordType = 'Cambridge Georgia' ||
                        ReferralRecordType = 'Cambridge New Jersey' ||
                        ReferralRecordType = 'Iowa' ||
                        ReferralRecordType = 'Illinois' ||
                        ReferralRecordType = 'Indiana' ||
                        ReferralRecordType = 'Minnesota' ||
                        ReferralRecordType = 'North Dakota' ||
                        ReferralRecordType = 'Ohio' ||
                        ReferralRecordType = 'Oregon' ||
                        ReferralRecordType = 'Wisconsin' ||
                        ReferralRecordType = 'West Virginia'}" />
                        <apex:inputField value="{!Referral__c.Physically_Aggressive_to_Peers__c}"
                            rendered="{!ReferralRecordType = 'Arizona' ||
                        ReferralRecordType = 'California' ||
                        ReferralRecordType = 'Nevada'}" />
                        <apex:inputField value="{!Referral__c.Suicide_Threats_Description__c}" id="suicideThreats"
                            label="Describe"
                            rendered="{!ReferralRecordType = 'NeuroRestorative' && Referral__c.Suicide_Threats__c}" />
                        <apex:pageBlockSectionItem rendered="{!ReferralRecordType = 'NeuroRestorative' && !Referral__c.Suicide_Threats__c}" />

                        <!-- Row 4, Col 3 -->
                        <apex:inputField value="{!Referral__c.Chemical_Dependency_Treatment__c}"
                            rendered="{! (isCambridge && referralRecordType!='Generic') || ReferralRecordType = 'CA FSS' || ReferralRecordType =='Adult Day Health'}" />
                        <apex:inputField value="{!Referral__c.Chemical_Use_Current__c}"
                            rendered="{!ReferralRecordType = 'Arizona' ||
                        ReferralRecordType = 'California' ||
                        ReferralRecordType = 'Iowa' ||
                        ReferralRecordType = 'Illinois' ||
                        ReferralRecordType = 'North Dakota' ||
                        ReferralRecordType = 'Nevada' ||
                        ReferralRecordType = 'Ohio' ||
                        ReferralRecordType = 'Oregon' ||
                        ReferralRecordType = 'Wisconsin'}" />
                        <apex:inputField value="{!Referral__c.Chemical_Use_Recovery__c}"
                            rendered="{!ReferralRecordType = 'Indiana' ||
                        ReferralRecordType = 'Minnesota' ||
                        ReferralRecordType = 'West Virginia'}" />
                        <apex:inputField value="{!Referral__c.Current_Tobacco_Use_Description__c}" id="usesTobacco"
                            label="Describe"
                            rendered="{!ReferralRecordType = 'NeuroRestorative' && Referral__c.Uses_Tobacco__c}" />
                        <apex:pageBlockSectionItem rendered="{!ReferralRecordType = 'NeuroRestorative' && !Referral__c.Uses_Tobacco__c}" />

                        <!-- Row 4, Col 4 -->
                        <apex:inputField value="{!Referral__c.Live_with_Opposite_Sex__c}"
                            rendered="{! (isCambridge && referralRecordType!='Generic') || ReferralRecordType = 'CA FSS'}" />
                        <apex:inputField value="{!Referral__c.Length_of_time__c}"
                            rendered="{!ReferralRecordType = 'Arizona' ||
                        ReferralRecordType = 'California' ||
                        ReferralRecordType = 'Iowa' ||
                        ReferralRecordType = 'Illinois' ||
                        ReferralRecordType = 'Indiana' ||
                        ReferralRecordType = 'North Dakota' ||
                        ReferralRecordType = 'Nevada' ||
                        ReferralRecordType = 'Ohio' ||
                        ReferralRecordType = 'Oregon' ||
                        ReferralRecordType = 'Wisconsin'}" />
                        <apex:inputField value="{!Referral__c.Unsupervised_Time__c}"
                            rendered="{!ReferralRecordType = 'Minnesota' ||
                        ReferralRecordType = 'West Virginia'}" />
                        <apex:inputField value="{!Referral__c.Current_Pending_Litigation_Description__c}" id="currentPendingLitigation"
                            label="Describe"
                            rendered="{!ReferralRecordType = 'NeuroRestorative' && Referral__c.Current_Pending_Litigation__c}" />
                        <apex:pageBlockSectionItem rendered="{!ReferralRecordType = 'NeuroRestorative' && !Referral__c.Current_Pending_Litigation__c}" />

                        <!-- Row 5, Col 1 -->
                        <apex:inputField value="{!Referral__c.Mobility__c}"
                            rendered="{! (isCambridge && referralRecordType!='Generic') || ReferralRecordType = 'CA FSS'}" />
                        <apex:inputField value="{!Referral__c.Gender_Specific_Staffing__c}"
                            rendered="{!ReferralRecordType = 'Arizona' || 
                        ReferralRecordType = 'Nevada'}" />
                        <apex:inputField value="{!Referral__c.Accessible_Housing_Needed__c}"
                            id="AccessHouseNeeds"
                            rendered="{!ReferralRecordType = 'Iowa' ||
                        ReferralRecordType = 'California' ||
                        ReferralRecordType = 'Illinois' ||
                        ReferralRecordType = 'Minnesota' ||
                        ReferralRecordType = 'North Dakota' ||
                        ReferralRecordType = 'Ohio' ||
                        ReferralRecordType = 'Oregon' ||
                        ReferralRecordType = 'Wisconsin' ||
                        ReferralRecordType = 'West Virginia'}" />
                        <apex:inputField value="{!Referral__c.Area_of_State_Interested_In__c}"
                            rendered="{!ReferralRecordType = 'Indiana'}" />
                        <apex:pageBlockSectionItem rendered="{!ReferralRecordType = 'NeuroRestorative'}">
                            <apex:outputLabel value="Physically Aggressive To Self" />
                            <apex:outputPanel >
                                <apex:inputField value="{!Referral__c.Physically_Aggressive_to_Self__c}">
                                    <apex:actionSupport event="onchange" rerender="progConsid"
                                        status="aggressiveToSelfStatus" />
                                </apex:inputField>
                                <apex:actionStatus id="aggressiveToSelfStatus">
                                    <apex:facet name="start">
                                        <div class="waitingHolder"
                                            style="display: inline; margin-left: 5px; position: relative;">
                                            <img class="waitingImage" src="/img/loading.gif"
                                                title="Please Wait..." /> <span class="waitingDescription"></span>
                                        </div>
                                    </apex:facet>
                                    <apex:facet name="stop"></apex:facet>
                                </apex:actionStatus>
                            </apex:outputPanel>
                        </apex:pageBlockSectionItem>

                        <!-- Row 5, Col 2 -->
                        <apex:inputField value="{!Referral__c.Self_Harm_or_Self_Injurous_Behaviors__c}"
                            rendered="{!ReferralRecordType = 'Cambridge Florida' ||
                        ReferralRecordType = 'Cambridge Massachusetts' ||
                        ReferralRecordType = 'Cambridge Maryland' ||
                        ReferralRecordType = 'Cambridge Indiana' ||
                        ReferralRecordType = 'Cambridge North Carolina' ||
                        ReferralRecordType = 'Cambridge Ohio' ||
                        ReferralRecordType = 'CA FSS'}" />
                        <apex:inputField value="{!Referral__c.Suicide_Threats__c}"
                            rendered="{!ReferralRecordType = 'Cambridge Georgia' ||
                        ReferralRecordType = 'Cambridge New Jersey' ||
                        ReferralRecordType = 'Iowa' ||
                        ReferralRecordType = 'Illinois' ||
                        ReferralRecordType = 'Indiana' ||
                        ReferralRecordType = 'Minnesota' ||
                        ReferralRecordType = 'North Dakota' ||
                        ReferralRecordType = 'Ohio' ||
                        ReferralRecordType = 'Oregon' ||
                        ReferralRecordType = 'Wisconsin' ||
                        ReferralRecordType = 'West Virginia'}" />
                        <apex:inputField value="{!Referral__c.Verbally_Aggressive__c}"
                            rendered="{!ReferralRecordType = 'Arizona' ||
                        ReferralRecordType = 'California' ||
                        ReferralRecordType = 'Nevada'}" />
                        <apex:pageBlockSectionItem rendered="{!ReferralRecordType = 'NeuroRestorative' || ReferralRecordType ='Adult Day Health'}">
                            <apex:outputLabel value="Suicide Attempts" />
                            <apex:outputPanel >
                                <apex:inputField value="{!Referral__c.Suicide_Attempts__c}">
                                    <apex:actionSupport event="onchange" rerender="progConsid"
                                        status="suicideAttemptsStatus" />
                                </apex:inputField>
                                <apex:actionStatus id="suicideAttemptsStatus">
                                    <apex:facet name="start">
                                        <div class="waitingHolder"
                                            style="display: inline; margin-left: 5px; position: relative;">
                                            <img class="waitingImage" src="/img/loading.gif"
                                                title="Please Wait..." /> <span class="waitingDescription"></span>
                                        </div>
                                    </apex:facet>
                                    <apex:facet name="stop"></apex:facet>
                                </apex:actionStatus>
                            </apex:outputPanel>
                        </apex:pageBlockSectionItem>

                        <!-- Row 5, Col 3 -->
                        <apex:inputField value="{!Referral__c.Drug_Possession_Distribution__c}"
                            rendered="{!ReferralRecordType = 'Cambridge Florida' ||
                        ReferralRecordType = 'Cambridge Massachusetts' ||
                        ReferralRecordType = 'Cambridge Maryland' ||
                        ReferralRecordType = 'Cambridge Indiana' ||
                        ReferralRecordType = 'Cambridge North Carolina' ||
                        ReferralRecordType = 'Cambridge Ohio' ||
                        ReferralRecordType = 'CA FSS'}" />
                        <apex:inputField value="{!Referral__c.Elopement__c}"
                            rendered="{!ReferralRecordType = 'Cambridge Georgia' ||
                        ReferralRecordType = 'Cambridge New Jersey' || ReferralRecordType =='Adult Day Health'}" />
                        <apex:inputField value="{!Referral__c.Chemical_Dependency_Treatment__c}"
                            rendered="{!ReferralRecordType = 'Arizona' ||
                        ReferralRecordType = 'California' ||
                        ReferralRecordType = 'Iowa' ||
                        ReferralRecordType = 'Illinois' ||
                        ReferralRecordType = 'North Dakota' ||
                        ReferralRecordType = 'Nevada' ||
                        ReferralRecordType = 'Ohio' ||
                        ReferralRecordType = 'Oregon' ||
                        ReferralRecordType = 'Wisconsin'}" />
                        <apex:inputField value="{!Referral__c.Chemical_Use_Current__c}"
                            rendered="{!ReferralRecordType = 'Indiana' ||
                        ReferralRecordType = 'Minnesota' ||
                        ReferralRecordType = 'West Virginia'}" />
                        <apex:pageBlockSectionItem rendered="{!ReferralRecordType = 'NeuroRestorative'}">
                            <apex:outputLabel value="Chemical Use (Current)" />
                            <apex:outputPanel >
                                <apex:inputField value="{!Referral__c.Chemical_Use_Current__c}">
                                    <apex:actionSupport event="onchange" rerender="progConsid"
                                        status="chemicalUseCurrentStatus" />
                                </apex:inputField>
                                <apex:actionStatus id="chemicalUseCurrentStatus">
                                    <apex:facet name="start">
                                        <div class="waitingHolder"
                                            style="display: inline; margin-left: 5px; position: relative;">
                                            <img class="waitingImage" src="/img/loading.gif"
                                                title="Please Wait..." /> <span class="waitingDescription"></span>
                                        </div>
                                    </apex:facet>
                                    <apex:facet name="stop"></apex:facet>
                                </apex:actionStatus>
                            </apex:outputPanel>
                        </apex:pageBlockSectionItem>

                        <!-- Row 5, Col 4 -->
                        <apex:inputField value="{!Referral__c.No_Cross_Cultural_Placement__c}"
                            rendered="{! (isCambridge && referralRecordType!='Generic') || ReferralRecordType = 'CA FSS'}" />
                        <apex:inputField value="{!Referral__c.Live_with_Opposite_Sex__c}"
                            rendered="{!ReferralRecordType = 'Arizona' ||
                        ReferralRecordType = 'California' ||
                        ReferralRecordType = 'Iowa' ||
                        ReferralRecordType = 'Illinois' ||
                        ReferralRecordType = 'Indiana' ||
                        ReferralRecordType = 'North Dakota' ||
                        ReferralRecordType = 'Nevada' ||
                        ReferralRecordType = 'Ohio' ||
                        ReferralRecordType = 'Oregon' ||
                        ReferralRecordType = 'Wisconsin'}" />
                        <apex:inputField value="{!Referral__c.Length_of_time__c}"
                            rendered="{!ReferralRecordType = 'Minnesota' ||
                        ReferralRecordType = 'West Virginia'}" />
                        <apex:inputField value="{!Referral__c.Elopement__c}"
                            rendered="{!ReferralRecordType = 'NeuroRestorative'}" />

                        <!-- Row 6, Col 1 -->
                        <apex:inputField value="{!Referral__c.Accessible_Housing_Needed__c}"
                            rendered="{! (isCambridge && referralRecordType!='Generic') ||
                        ReferralRecordType = 'CA FSS' ||
                        ReferralRecordType = 'Arizona' ||
                        ReferralRecordType = 'Nevada'}" />
                        <apex:inputField value="{!Referral__c.Accessible_Vehicle_Needed__c}"
                            rendered="{!ReferralRecordType = 'California' ||
                        ReferralRecordType = 'Iowa' ||
                        ReferralRecordType = 'Illinois' ||
                        ReferralRecordType = 'Minnesota' ||
                        ReferralRecordType = 'North Dakota' ||
                        ReferralRecordType = 'Ohio' ||
                        ReferralRecordType = 'Oregon' ||
                        ReferralRecordType = 'Wisconsin' ||
                        ReferralRecordType = 'West Virginia'}" />
                        <apex:inputField value="{!Referral__c.Current_Medical_Conditions__c}"
                            rendered="{!ReferralRecordType = 'Indiana' || ReferralRecordType =='Adult Day Health'}" />
                        <apex:inputField value="{!Referral__c.Aggressive_to_Self_Description__c}" id="aggressiveToSelf"
                            label="Describe"
                            rendered="{!ReferralRecordType = 'NeuroRestorative' && Referral__c.Physically_Aggressive_to_Self__c}" />
                        <apex:pageBlockSectionItem rendered="{!ReferralRecordType = 'NeuroRestorative' && !Referral__c.Physically_Aggressive_to_Self__c}" />

                        <!-- Row 6, Col 2 -->
                        <apex:inputField value="{!Referral__c.Fire_Setting__c}"
                            rendered="{!ReferralRecordType = 'Cambridge Florida' ||
                        ReferralRecordType = 'Cambridge Massachusetts' ||
                        ReferralRecordType = 'Cambridge Maryland' ||
                        ReferralRecordType = 'Cambridge Indiana' ||
                        ReferralRecordType = 'Cambridge North Carolina' ||
                        ReferralRecordType = 'Cambridge Ohio' ||
                        ReferralRecordType = 'CA FSS' || ReferralRecordType =='Adult Day Health'}" />
                        <apex:inputField value="{!Referral__c.Suicide_Attempts__c}"
                            rendered="{!ReferralRecordType = 'Cambridge Georgia' ||
                        ReferralRecordType = 'Cambridge New Jersey' ||
                        ReferralRecordType = 'Iowa' ||
                        ReferralRecordType = 'Illinois' ||
                        ReferralRecordType = 'Indiana' ||
                        ReferralRecordType = 'Minnesota' ||
                        ReferralRecordType = 'North Dakota' ||
                        ReferralRecordType = 'Ohio' ||
                        ReferralRecordType = 'Oregon' ||
                        ReferralRecordType = 'Wisconsin' ||
                        ReferralRecordType = 'West Virginia'}" />
                        <apex:inputField value="{!Referral__c.Suicide_Threats__c}"
                            rendered="{!ReferralRecordType = 'Arizona' ||
                        ReferralRecordType = 'California' ||
                        ReferralRecordType = 'Nevada'}" />
                        <apex:inputField value="{!Referral__c.Suicide_Attempts_Description__c}" id="suicideAttempts"
                            label="Describe"
                            rendered="{!((ReferralRecordType = 'NeuroRestorative' || ReferralRecordType =='Adult Day Health') && Referral__c.Suicide_Attempts__c)}" />
                        <apex:pageBlockSectionItem rendered="{!((ReferralRecordType = 'NeuroRestorative' || ReferralRecordType =='Adult Day Health') && Referral__c.Suicide_Attempts__c)}" />

                        <!-- Row 6, Col 3 -->
                        <apex:inputField value="{!Referral__c.Elopement__c}"
                            rendered="{!ReferralRecordType = 'Cambridge Florida' ||
                        ReferralRecordType = 'Cambridge Massachusetts' ||
                        ReferralRecordType = 'Cambridge Maryland' ||
                        ReferralRecordType = 'Cambridge Indiana' ||
                        ReferralRecordType = 'Cambridge North Carolina' ||
                        ReferralRecordType = 'Cambridge Ohio' ||
                        ReferralRecordType = 'Arizona' ||
                        ReferralRecordType = 'California' ||
                        ReferralRecordType = 'Iowa' ||
                        ReferralRecordType = 'Illinois' ||
                        ReferralRecordType = 'North Dakota' ||
                        ReferralRecordType = 'Nevada' ||
                        ReferralRecordType = 'Ohio' ||
                        ReferralRecordType = 'Oregon' ||
                        ReferralRecordType = 'Wisconsin' ||
                        ReferralRecordType = 'CA FSS'}" />
                        <apex:inputField value="{!Referral__c.Unwanted_Sexual_Behavior__c}"
                            rendered="{!ReferralRecordType = 'Cambridge Georgia' ||
                        ReferralRecordType = 'Cambridge New Jersey' || ReferralRecordType =='Adult Day Health'}" />
                        <apex:inputField value="{!Referral__c.Chemical_Dependency_Treatment__c}"
                            rendered="{!ReferralRecordType = 'Indiana' ||
                        ReferralRecordType = 'Minnesota' ||
                        ReferralRecordType = 'West Virginia'}" />
                        <apex:inputField value="{!Referral__c.Current_Chemical_Use_Date_Last_Used__c}" id="chemicalUseCurrent"
                            label="Date Last Used"
                            rendered="{!ReferralRecordType = 'NeuroRestorative' && Referral__c.Chemical_Use_Current__c}" />
                        <apex:pageBlockSectionItem rendered="{!ReferralRecordType = 'NeuroRestorative' && !Referral__c.Chemical_Use_Current__c}" />

                        <!-- Row 6, Col 4 -->
                        <apex:inputField value="{!Referral__c.Can_Be_Placed_With_Other_Children__c}"
                            rendered="{! (isCambridge && referralRecordType!='Generic') || ReferralRecordType = 'CA FSS'}" />
                        <apex:inputField value="{!Referral__c.Current_Medical_Conditions__c}"
                            rendered="{!ReferralRecordType = 'Arizona' ||
                        ReferralRecordType = 'Nevada'}" />
                        <apex:pageBlockSectionItem rendered="{!ReferralRecordType = 'California' ||
                        ReferralRecordType = 'Illinois' ||
                        ReferralRecordType = 'Indiana' ||
                        ReferralRecordType = 'North Dakota'}" />
                        <apex:inputField value="{!Referral__c.Gender_Specific_Staffing__c}"
                            rendered="{!ReferralRecordType = 'Oregon'}" />
                        <apex:inputField value="{!Referral__c.X17_Under__c}"
                            rendered="{!ReferralRecordType = 'Iowa'}" />
                        <apex:inputField value="{!Referral__c.Live_with_Opposite_Sex__c}"
                            rendered="{!ReferralRecordType = 'Minnesota' ||
                        ReferralRecordType = 'West Virginia'}" />
                        <apex:inputField value="{!Referral__c.Aversive_Procedures_Currently_in_Place__c}"
                            rendered="{!ReferralRecordType = 'Ohio'}" />
                        <apex:inputField value="{!Referral__c.Has_Pets__c}"
                            rendered="{!ReferralRecordType = 'Wisconsin'}" />
                        <apex:pageBlockSectionItem rendered="{!ReferralRecordType = 'NeuroRestorative'}" />

                        <!-- Row 7, Col 1 -->
                        <apex:inputField value="{!Referral__c.Accessible_Vehicle_Needed__c}"
                            rendered="{! (isCambridge && referralRecordType!='Generic') ||
                        ReferralRecordType = 'Arizona' ||
                        ReferralRecordType = 'Nevada' ||
                        ReferralRecordType = 'CA FSS'}" />
                        <apex:inputField value="{!Referral__c.Current_Medical_Conditions__c}"
                            rendered="{!ReferralRecordType = 'California'}" />
                        <apex:inputField value="{!Referral__c.Area_of_State_Interested_In__c}"
                            rendered="{!ReferralRecordType = 'Iowa' ||
                        ReferralRecordType = 'Illinois' ||
                        ReferralRecordType = 'Minnesota' ||
                        ReferralRecordType = 'North Dakota' ||
                        ReferralRecordType = 'Ohio' ||
                        ReferralRecordType = 'Oregon' ||
                        ReferralRecordType = 'Wisconsin' ||
                        ReferralRecordType = 'West Virginia'}" />
                        <apex:pageBlockSectionItem rendered="{!ReferralRecordType = 'NeuroRestorative'}">
                            <apex:outputLabel value="Physically Aggressive To Peers" />
                            <apex:outputPanel >
                                <apex:inputField value="{!Referral__c.Physically_Aggressive_to_Peers__c}">
                                    <apex:actionSupport event="onchange" rerender="progConsid"
                                        status="aggressiveToPeersStatus" />
                                </apex:inputField>
                                <apex:actionStatus id="aggressiveToPeersStatus">
                                    <apex:facet name="start">
                                        <div class="waitingHolder"
                                            style="display: inline; margin-left: 5px; position: relative;">
                                            <img class="waitingImage" src="/img/loading.gif"
                                                title="Please Wait..." /> <span class="waitingDescription"></span>
                                        </div>
                                    </apex:facet>
                                    <apex:facet name="stop"></apex:facet>
                                </apex:actionStatus>
                            </apex:outputPanel>
                        </apex:pageBlockSectionItem>

                        <!-- Row 7, Col 2 -->
                        <apex:inputField value="{!Referral__c.Property_Destruction__c}"
                            rendered="{!ReferralRecordType = 'Cambridge Florida' ||
                        ReferralRecordType = 'Cambridge Massachusetts' ||
                        ReferralRecordType = 'Cambridge Maryland' ||
                        ReferralRecordType = 'Cambridge Indiana' ||
                        ReferralRecordType = 'Cambridge North Carolina' ||
                        ReferralRecordType = 'Cambridge Ohio' ||
                        ReferralRecordType = 'CA FSS'}" />
                        <apex:inputField value="{!Referral__c.Self_Harm_or_Self_Injurous_Behaviors__c}"
                            rendered="{!ReferralRecordType = 'Cambridge Georgia' ||
                        ReferralRecordType = 'Cambridge New Jersey' ||
                        ReferralRecordType = 'Iowa' ||
                        ReferralRecordType = 'Illinois' ||
                        ReferralRecordType = 'North Dakota' ||
                        ReferralRecordType = 'Ohio' ||
                        ReferralRecordType = 'Oregon' ||
                        ReferralRecordType = 'Wisconsin'  || ReferralRecordType =='Adult Day Health'}" />
                        <apex:inputField value="{!Referral__c.Suicide_Attempts__c}"
                            rendered="{!ReferralRecordType = 'Arizona' ||
                        ReferralRecordType = 'California' ||
                        ReferralRecordType = 'Nevada' }" />
                        <apex:pageBlockSectionItem rendered="{!ReferralRecordType = 'Minnesota' ||
                        ReferralRecordType = 'West Virginia'}" />
                        <apex:pageBlockSectionItem rendered="{!ReferralRecordType = 'NeuroRestorative'}">
                            <apex:outputLabel value="Self-Harm or Self-Injurious Behaviors" />
                            <apex:outputPanel >
                                <apex:inputField value="{!Referral__c.Self_Harm_or_Self_Injurous_Behaviors__c}">
                                    <apex:actionSupport event="onchange" rerender="progConsid"
                                        status="selfHarmStatus" />
                                </apex:inputField>
                                <apex:actionStatus id="selfHarmStatus">
                                    <apex:facet name="start">
                                        <div class="waitingHolder"
                                            style="display: inline; margin-left: 5px; position: relative;">
                                            <img class="waitingImage" src="/img/loading.gif"
                                                title="Please Wait..." /> <span class="waitingDescription"></span>
                                        </div>
                                    </apex:facet>
                                    <apex:facet name="stop"></apex:facet>
                                </apex:actionStatus>
                            </apex:outputPanel>
                        </apex:pageBlockSectionItem>

                        <!-- Row 7, Col 3 -->
                        <apex:inputField value="{!Referral__c.Unwanted_Sexual_Behavior__c}"
                            rendered="{!ReferralRecordType = 'Cambridge Florida' ||
                        ReferralRecordType = 'Cambridge Massachusetts' ||
                        ReferralRecordType = 'Cambridge Maryland' ||
                        ReferralRecordType = 'Cambridge Indiana' ||
                        ReferralRecordType = 'Cambridge North Carolina' ||
                        ReferralRecordType = 'Cambridge Ohio' ||
                        ReferralRecordType = 'Arizona' ||
                        ReferralRecordType = 'California' ||
                        ReferralRecordType = 'Iowa' ||
                        ReferralRecordType = 'Illinois' ||
                        ReferralRecordType = 'North Dakota' ||
                        ReferralRecordType = 'Nevada' ||
                        ReferralRecordType = 'Ohio' ||
                        ReferralRecordType = 'Oregon' ||
                        ReferralRecordType = 'CA FSS'}" />
                        <apex:inputField value="{!Referral__c.If_Yes_Type_of_Unwanted_Sexual_Behavior__c}"
                            label="if Yes, Type"
                            rendered="{!ReferralRecordType = 'Cambridge Georgia'}" />
                        <apex:inputField value="{!Referral__c.Nursing_Care_Needed__c}"
                            rendered="{!ReferralRecordType = 'Cambridge New Jersey'}" />
                        <apex:inputField value="{!Referral__c.Elopement__c}"
                            rendered="{!ReferralRecordType = 'Minnesota' ||
                        ReferralRecordType = 'West Virginia'}" />
                        <apex:inputField value="{!Referral__c.Exterior_Locking_Mechanism_Required__c}"
                            rendered="{!ReferralRecordType = 'Wisconsin'}" />
                        <apex:pageBlockSectionItem rendered="{!ReferralRecordType = 'NeuroRestorative'}">
                            <apex:outputLabel value="Chemical Dependency Treatment" />
                            <apex:outputPanel >
                                <apex:inputField value="{!Referral__c.Chemical_Dependency_Treatment__c}">
                                    <apex:actionSupport event="onchange" rerender="progConsid"
                                        status="chemicalDependencyTreatmentStatus" />
                                </apex:inputField>
                                <apex:actionStatus id="chemicalDependencyTreatmentStatus">
                                    <apex:facet name="start">
                                        <div class="waitingHolder"
                                            style="display: inline; margin-left: 5px; position: relative;">
                                            <img class="waitingImage" src="/img/loading.gif"
                                                title="Please Wait..." /> <span class="waitingDescription"></span>
                                        </div>
                                    </apex:facet>
                                    <apex:facet name="stop"></apex:facet>
                                </apex:actionStatus>
                            </apex:outputPanel>
                        </apex:pageBlockSectionItem>

                        <!-- Row 7, Col 4 -->
                        <apex:inputField value="{!Referral__c.If_Yes_Age_Requirements__c}"
                            rendered="{! (isCambridge && referralRecordType!='Generic') || ReferralRecordType = 'CA FSS'}" />
                        <apex:pageBlockSectionItem rendered="{!ReferralRecordType = 'Arizona' ||
                        ReferralRecordType = 'California' ||
                        ReferralRecordType = 'Illinois' ||
                        ReferralRecordType = 'Minnesota' ||
                        ReferralRecordType = 'North Dakota' ||
                        ReferralRecordType = 'Nevada' ||
                        ReferralRecordType = 'West Virginia'}" />
                        <apex:inputField value="{!Referral__c.Extreme_Unwanted_Behaviors__c}"
                            rendered="{!ReferralRecordType = 'Iowa' ||
                                        ReferralRecordType = 'Oregon' || 
                                        ReferralRecordType =='Adult Day Health'}" />
                        <apex:inputField value="{!Referral__c.If_Yes_What_kind__c}"
                            rendered="{!ReferralRecordType = 'Wisconsin'}" />
                        <apex:pageBlockSectionItem rendered="{!ReferralRecordType = 'NeuroRestorative'}" />
                        <apex:inputField value="{!Referral__c.Diabetes__c}" rendered="{!ReferralRecordType = 'Ohio'}" />

                        <!-- Row 8, Col 1 -->
                        <apex:inputField value="{!Referral__c.Geographic_Restrictions__c}"
                            rendered="{! (isCambridge && referralRecordType!='Generic') || ReferralRecordType = 'CA FSS'}" />
                        <apex:inputField value="{!Referral__c.Lift_Transfer_Assistance__c}"
                            rendered="{!ReferralRecordType = 'Arizona' ||
                        ReferralRecordType = 'Nevada'}" />
                        <apex:inputField value="{!Referral__c.Restricted_Health_Conditions__c}"
                            rendered="{!ReferralRecordType = 'California'}" />
                        <apex:inputField value="{!Referral__c.Current_Medical_Conditions__c}"
                            rendered="{!ReferralRecordType = 'Iowa' ||
                        ReferralRecordType = 'Illinois' ||
                        ReferralRecordType = 'Minnesota' ||
                        ReferralRecordType = 'North Dakota' ||
                        ReferralRecordType = 'Ohio' ||
                        ReferralRecordType = 'Oregon' ||
                        ReferralRecordType = 'Wisconsin' ||
                        ReferralRecordType = 'West Virginia'}" />
                        <apex:inputField value="{!Referral__c.Aggressive_to_Peers_Description__c}" id="aggressiveToPeers"
                            label="Describe"
                            rendered="{!ReferralRecordType = 'NeuroRestorative' && Referral__c.Physically_Aggressive_to_Peers__c}" />
                        <apex:pageBlockSectionItem rendered="{!ReferralRecordType = 'NeuroRestorative' && !Referral__c.Physically_Aggressive_to_Peers__c}" />

                        <!-- Row 8, Col 2 -->
                        <apex:inputField value="{!Referral__c.Gang_Involvement__c}"
                            rendered="{!ReferralRecordType = 'Cambridge Florida' ||
                        ReferralRecordType = 'Cambridge Massachusetts' ||
                        ReferralRecordType = 'Cambridge Maryland' ||
                        ReferralRecordType = 'Cambridge Indiana' ||
                        ReferralRecordType = 'Cambridge North Carolina' ||
                        ReferralRecordType = 'Cambridge Ohio' ||
                        ReferralRecordType = 'CA FSS'}" />
                        <apex:inputField value="{!Referral__c.Fire_Setting__c}"
                            rendered="{!ReferralRecordType = 'Cambridge Georgia' ||
                        ReferralRecordType = 'Cambridge New Jersey' ||
                        ReferralRecordType = 'Iowa' ||
                        ReferralRecordType = 'Wisconsin' ||
                        ReferralRecordType = 'Oregon'}" />
                        <apex:inputField value="{!Referral__c.Self_Harm_or_Self_Injurous_Behaviors__c}"
                            rendered="{!ReferralRecordType = 'Arizona' ||
                        ReferralRecordType = 'California' ||
                        ReferralRecordType = 'Nevada'}" />
                        <apex:pageBlockSectionItem rendered="{!ReferralRecordType = 'Illinois' ||
                        ReferralRecordType = 'Minnesota' ||
                        ReferralRecordType = 'North Dakota' ||
                        ReferralRecordType = 'Ohio' ||
                        ReferralRecordType = 'West Virginia'}" />
                        <apex:inputField value="{!Referral__c.Self_Harm_Behavior_Description__c}" id="selfHarm"
                            label="Describe"
                            rendered="{!ReferralRecordType = 'NeuroRestorative' && Referral__c.Self_Harm_or_Self_Injurous_Behaviors__c}" />
                        <apex:pageBlockSectionItem rendered="{!ReferralRecordType = 'NeuroRestorative' && !Referral__c.Self_Harm_or_Self_Injurous_Behaviors__c}" />

                        <!-- Row 8, Col 3 -->
                        <apex:inputField value="{!Referral__c.Registered_Sex_Offender__c}"
                            rendered="{!ReferralRecordType = 'Cambridge Florida' ||
                        ReferralRecordType = 'Cambridge Massachusetts' ||
                        ReferralRecordType = 'Cambridge Maryland' ||
                        ReferralRecordType = 'Cambridge Indiana' ||
                        ReferralRecordType = 'Cambridge North Carolina' ||
                        ReferralRecordType = 'Cambridge Ohio' ||
                        ReferralRecordType = 'California' ||
                        ReferralRecordType = 'Iowa' ||
                        ReferralRecordType = 'Ohio' ||
                        ReferralRecordType = 'CA FSS' ||
                        ReferralRecordType = 'Oregon'}" />
                        <apex:inputField value="{!Referral__c.Nursing_Care_Needed__c}"
                            rendered="{!ReferralRecordType = 'Cambridge Georgia'}" />
                        <apex:inputField value="{!Referral__c.Level_of_Support_Required__c}"
                            rendered="{!ReferralRecordType = 'Cambridge New Jersey'}" />
                        <apex:inputField value="{!Referral__c.Visual_Impairment__c}"
                            rendered="{!ReferralRecordType = 'Arizona' ||
                        ReferralRecordType = 'Nevada'}" />
                        <apex:pageBlockSectionItem rendered="{!ReferralRecordType = 'Illinois' ||
                        ReferralRecordType = 'Minnesota' ||
                        ReferralRecordType = 'North Dakota' ||
                        ReferralRecordType = 'West Virginia'}" />
                        <apex:inputField value="{!Referral__c.Unwanted_Sexual_Behavior__c}"
                            rendered="{!ReferralRecordType = 'Wisconsin'}" />
                        <apex:inputField value="{!Referral__c.Chemical_Dep_Treatment_Date_Completed__c}" id="chemicalDependencyTreatment"
                            label="Date Completed"
                            rendered="{!ReferralRecordType = 'NeuroRestorative' && Referral__c.Chemical_Dependency_Treatment__c}" />
                        <apex:pageBlockSectionItem rendered="{!ReferralRecordType = 'NeuroRestorative' && !Referral__c.Chemical_Dependency_Treatment__c}" />

                        <!-- Row 8, Col 4 -->
                        <apex:inputField value="{!Referral__c.Family_Involvement_Restrictions__c}"
                            rendered="{! (isCambridge && referralRecordType!='Generic')  ||
                ReferralRecordType = 'CA FSS' ||
                ReferralRecordType = 'Oregon'}" />
                        <apex:pageBlockSectionItem rendered="{!ReferralRecordType = 'California'}" />
                        <apex:inputField value="{!Referral__c.No_Mixed_Diagnosis__c}"
                            rendered="{!ReferralRecordType = 'Iowa' || ReferralRecordType =='Adult Day Health'}" />
                        <apex:inputField value="{!Referral__c.Locked_Seclusion_Room_Needed__c}"
                            rendered="{!ReferralRecordType = 'Wisconsin'}" />
                        <apex:pageBlockSectionItem rendered="{!ReferralRecordType = 'NeuroRestorative'}" />
                        <apex:inputField value="{!Referral__c.PWS__c}" rendered="{!ReferralRecordType = 'Ohio'}" />

                        <!-- Row 9, Col 1 -->
                        <apex:inputField value="{!Referral__c.Area_of_State_Interested_In__c}"
                            rendered="{! (isCambridge && referralRecordType!='Generic') || ReferralRecordType = 'CA FSS'}" />
                        <apex:pageBlockSectionItem rendered="{!ReferralRecordType = 'Wisconsin' ||
                        ReferralRecordType = 'Iowa'}" />
                        
                        <apex:pageBlockSectionItem rendered="{!ReferralRecordType = 'Oregon'}">
                            <apex:outputLabel value="Current Pending Litigation" />
                            <apex:outputPanel >
                                <apex:inputField value="{!Referral__c.Current_Pending_Litigation__c}">
                                    <apex:actionSupport event="onchange" rerender="progConsid"
                                        status="currentPendingLitigationStatus" />
                                </apex:inputField>
                                <apex:actionStatus id="currentPendingLitigationStatus">
                                    <apex:facet name="start">
                                        <div class="waitingHolder"
                                            style="display: inline; margin-left: 5px; position: relative;">
                                            <img class="waitingImage" src="/img/loading.gif"
                                                title="Please Wait..." /> <span class="waitingDescription"></span>
                                        </div>
                                    </apex:facet>
                                    <apex:facet name="stop"></apex:facet>
                                </apex:actionStatus>
                            </apex:outputPanel>
                        </apex:pageBlockSectionItem>

                        <!-- Row 9, Col 2 -->
                        <apex:inputField value="{!Referral__c.Theft__c}"
                            rendered="{!ReferralRecordType = 'Cambridge Florida' ||
                        ReferralRecordType = 'Cambridge Massachusetts' ||
                        ReferralRecordType = 'Cambridge Maryland' ||
                        ReferralRecordType = 'Cambridge Indiana' ||
                        ReferralRecordType = 'Cambridge North Carolina' ||
                        ReferralRecordType = 'Cambridge Ohio' ||
                        ReferralRecordType = 'CA FSS' ||
                        ReferralRecordType = 'Oregon'}" />
                        <apex:inputField value="{!Referral__c.Legal_History__c}"
                            rendered="{!ReferralRecordType = 'Cambridge Georgia' ||
                        ReferralRecordType = 'Cambridge New Jersey' ||
                        ReferralRecordType = 'Iowa' || ReferralRecordType =='Adult Day Health'}" />
                        <apex:inputField value="{!Referral__c.Property_Destruction__c}"
                            rendered="{!ReferralRecordType = 'Wisconsin'}" />
                        <apex:inputField value="{!Referral__c.Current_Pending_Litigation__c}" rendered="{!ReferralRecordType =='Adult Day Health'}" />
                        <!-- Row 9, Col 3 -->
                        <apex:inputField value="{!Referral__c.Nursing_Care_Needed__c}"
                            rendered="{!ReferralRecordType = 'Cambridge Florida' ||
                        ReferralRecordType = 'Cambridge Massachusetts' ||
                        ReferralRecordType = 'Cambridge Maryland' ||
                        ReferralRecordType = 'Cambridge Indiana' ||
                        ReferralRecordType = 'Cambridge North Carolina' ||
                        ReferralRecordType = 'Cambridge Ohio' ||
                        ReferralRecordType = 'CA FSS'|| ReferralRecordType =='Adult Day Health'}" />
                        <apex:inputField value="{!Referral__c.Legal_History__c}"
                            rendered="{!ReferralRecordType = 'Oregon'}" />
                        <apex:inputField value="{!Referral__c.Level_of_Support_Required__c}"
                            rendered="{!ReferralRecordType = 'Cambridge Georgia' || ReferralRecordType =='Adult Day Health'}" />
                        <apex:inputField value="{!Referral__c.Unsupervised_Time__c}"
                            rendered="{!ReferralRecordType = 'Cambridge New Jersey'}" />
                        <apex:pageBlockSectionItem rendered="{!ReferralRecordType = 'Wisconsin'}" />

                        <!-- Row 9, Col 4 -->
                        <apex:inputField value="{!Referral__c.If_Yes_Level__c}"
                            rendered="{! (isCambridge && referralRecordType!='Generic') || ReferralRecordType = 'CA FSS' || ReferralRecordType = 'Oregon'}" />
                        <apex:inputField value="{!Referral__c.Safety_Measures_Required__c}"
                            label="Restrictive measures or rights restrictions will need to be implemented to safely support this individual"
                            rendered="{!ReferralRecordType = 'Wisconsin'}" />

                        <!-- Row 10, Col 1 -->
                        <apex:inputField value="{!Referral__c.Access_to_Public_Transportation__c}"
                            rendered="{! (isCambridge && referralRecordType!='Generic') || ReferralRecordType = 'CA FSS'}" />
                            
                        <!-- Row 10, Col 2 -->
                        <apex:inputField value="{!Referral__c.Legal_History__c}"
                            rendered="{!ReferralRecordType = 'Cambridge Florida' ||
                        ReferralRecordType = 'Cambridge Massachusetts' ||
                        ReferralRecordType = 'Cambridge Maryland' ||
                        ReferralRecordType = 'Cambridge Indiana' ||
                        ReferralRecordType = 'Cambridge North Carolina' ||
                        ReferralRecordType = 'Cambridge Ohio' ||
                        ReferralRecordType = 'CA FSS'}" />
                        <apex:inputField value="{!Referral__c.Law_Enforcement_Involvement__c}"
                            rendered="{!ReferralRecordType = 'Cambridge Georgia' ||
                        ReferralRecordType = 'Cambridge New Jersey'}" />

                        <!-- Row 10, Col 3 -->
                        <apex:inputField value="{!Referral__c.Level_of_Support_Required__c}"
                            rendered="{!ReferralRecordType = 'Cambridge Florida' ||
                        ReferralRecordType = 'Cambridge Massachusetts' ||
                        ReferralRecordType = 'Cambridge Maryland' ||
                        ReferralRecordType = 'Cambridge Indiana' ||
                        ReferralRecordType = 'Cambridge North Carolina' ||
                        ReferralRecordType = 'Cambridge Ohio' ||
                        ReferralRecordType = 'CA FSS'}" />
                        <apex:inputField value="{!Referral__c.Unsupervised_Time__c}"
                            rendered="{!ReferralRecordType = 'Cambridge Georgia'}" />
                        <apex:inputField value="{!Referral__c.Length_of_time__c}"
                            rendered="{!ReferralRecordType = 'Cambridge New Jersey'}" />
                        <apex:inputField value="{!Referral__c.Visual_Impairment__c}"
                            rendered="{!ReferralRecordType = 'Oregon'}" />
                        <!-- Row 10, Col 4 -->
                        <apex:inputField value="{!Referral__c.Animal_Cruelty__c}"
                            rendered="{!ReferralRecordType = 'Cambridge Florida' ||
                        ReferralRecordType = 'Cambridge Massachusetts' ||
                        ReferralRecordType = 'Cambridge Indiana' ||
                        ReferralRecordType = 'Cambridge North Carolina' ||
                        ReferralRecordType = 'Cambridge Ohio' ||
                        ReferralRecordType = 'CA FSS'}" />
                        <apex:inputField value="{!Referral__c.Has_Pets__c}"
                            rendered="{!ReferralRecordType = 'Cambridge Georgia'}" />
                        <apex:pageBlockSectionItem rendered="{!ReferralRecordType = 'Cambridge Maryland' ||
                        ReferralRecordType = 'Cambridge New Jersey'}" />

                        <!-- Row 11, Col 1 (Row-11 skipped for Oregon flavor)-->
                        <apex:inputField value="{!Referral__c.Physically_Aggressive_to_Staff__c}"
                            rendered="{!ReferralRecordType = 'Cambridge Florida' ||
                        ReferralRecordType = 'Cambridge Massachusetts' ||
                        ReferralRecordType = 'Cambridge Maryland' ||
                        ReferralRecordType = 'Cambridge Indiana' ||
                        ReferralRecordType = 'Cambridge North Carolina' ||
                        ReferralRecordType = 'Cambridge Ohio' ||
                        ReferralRecordType = 'CA FSS'}" />
                        <apex:pageBlockSectionItem rendered="{!ReferralRecordType = 'Cambridge Georgia' ||
                        ReferralRecordType = 'Cambridge New Jersey'}" />
                        <!-- Row 11, Col 2 -->
                        <apex:inputField value="{!Referral__c.Law_Enforcement_Involvement__c}"
                            rendered="{!ReferralRecordType = 'Cambridge Florida' ||
                        ReferralRecordType = 'Cambridge Massachusetts' ||
                        ReferralRecordType = 'Cambridge Maryland' ||
                        ReferralRecordType = 'Cambridge Indiana' ||
                        ReferralRecordType = 'Cambridge North Carolina' ||
                        ReferralRecordType = 'Cambridge Ohio' ||
                        ReferralRecordType = 'CA FSS'}" />
                        <apex:inputField value="{!Referral__c.Property_Destruction__c}"
                            rendered="{!ReferralRecordType = 'Cambridge Georgia' ||
                        ReferralRecordType = 'Cambridge New Jersey'}" />
                        <!-- Row 11, Col 3 -->
                        <apex:inputField value="{!Referral__c.Unsupervised_Time__c}"
                            rendered="{!ReferralRecordType = 'Cambridge Florida' ||
                        ReferralRecordType = 'Cambridge Massachusetts' ||
                        ReferralRecordType = 'Cambridge Maryland' ||
                        ReferralRecordType = 'Cambridge Indiana' ||
                        ReferralRecordType = 'Cambridge North Carolina' ||
                        ReferralRecordType = 'Cambridge Ohio' ||
                        ReferralRecordType = 'CA FSS'}" />
                        <!-- CTEAE-107, OH referral flavor fields added to Programming Considerations -->
                        <apex:inputField value="{!Referral__c.Victim_of_Domestic_Violence__c}"
                            rendered="{!ReferralRecordType = 'Cambridge Ohio'}" />
                        <apex:inputField value="{!Referral__c.Safe_Plan__c}"
                            rendered="{!ReferralRecordType = 'Cambridge Indiana'}" />
                        <apex:inputField value="{!Referral__c.Length_of_time__c}"
                            rendered="{!ReferralRecordType = 'Cambridge Georgia'}" />
                        <apex:pageBlockSectionItem rendered="{!ReferralRecordType = 'Cambridge New Jersey'}" />
                        <!-- Row 11, Col 4 -->
                        <apex:pageBlockSectionItem rendered="{!ReferralRecordType = 'Cambridge Florida' ||
                                                ReferralRecordType = 'Cambridge Massachusetts' ||
                                                ReferralRecordType = 'Cambridge Maryland' ||
                                                ReferralRecordType = 'Cambridge North Carolina' ||
                                                ReferralRecordType = 'Cambridge New Jersey' ||
                                                ReferralRecordType = 'CA FSS'}" />
                        <apex:inputField value="{!Referral__c.If_Yes_What_kind__c}"
                            label="If Yes, Type"
                            rendered="{!ReferralRecordType = 'Cambridge Georgia'}" />

                        <!-- Row 12, Col 1 -->
                        <apex:inputField value="{!Referral__c.Physically_Aggressive_to_Self__c}"
                            rendered="{!ReferralRecordType = 'Cambridge Florida' ||
                        ReferralRecordType = 'Cambridge Massachusetts' ||
                        ReferralRecordType = 'Cambridge Maryland' ||
                        ReferralRecordType = 'Cambridge Indiana' ||
                        ReferralRecordType = 'Cambridge North Carolina' ||
                        ReferralRecordType = 'Cambridge Ohio' ||
                        ReferralRecordType = 'CA FSS'}" />
                        <apex:pageBlockSectionItem rendered="{!ReferralRecordType = 'Cambridge Georgia'}" />


                        <apex:pageBlockSectionItem rendered="{!ReferralRecordType == 'Cambridge Florida' ||
                                                ReferralRecordType = 'Cambridge Massachusetts' ||
                                                ReferralRecordType = 'Cambridge Maryland' ||
                                                ReferralRecordType = 'Cambridge Indiana' ||
                                                ReferralRecordType = 'Cambridge North Carolina' ||
                                                ReferralRecordType = 'Cambridge Ohio' ||
                                                ReferralRecordType = 'CA FSS' ||
                                                ReferralRecordType = 'Oregon'}">
                            <apex:outputPanel >
                                <apex:outputLabel for="Adjudicated_offense_status">
                        Adjudicated offense status
                        <br />
                                </apex:outputLabel>
                                <apex:actionStatus id="statusAdjudicated_offense_status">
                                    <apex:facet name="start">
                                        <div class="waitingHolder"
                                            style="display: inline; margin-left: 5px; position: relative; top: 5px;">
                                            <img class="waitingImage" src="/img/loading.gif"
                                                title="Please Wait..." /> <span class="waitingDescription"></span>
                                        </div>
                                    </apex:facet>
                                    <apex:facet name="stop"></apex:facet>
                                </apex:actionStatus>
                            </apex:outputPanel>
                            <apex:outputPanel id="Adjudicated_offense_status_Item"
                                layout="block" style="width: 150px;">
                                <apex:actionRegion >
                                    <apex:inputField id="Adjudicated_offense_status"
                                        value="{!Referral__c.Adjudicated_offense_status__c}">
                                        <apex:actionSupport event="onchange"
                                            rerender="Adjudicated_offense_status_Item"
                                            status="statusAdjudicated_offense_status"
                                            oncomplete="clearAdjudicated_offense_status(); return false;" />
                                    </apex:inputField>
                                </apex:actionRegion>
                                <apex:outputPanel layout="block"
                                    rendered="{! !Referral__c.Adjudicated_offense_status__c}"
                                    style="display: none;">
                                    <apex:outputLabel ></apex:outputLabel>
                                    <br />
                                    <apex:inputField id="Misdemeanor_s"
                                        value="{!Referral__c.Misdemeanor_s__c}" html-disabled="true" />Misdemeanor/s
                        <br />
                                    <apex:inputField id="Felony_ies"
                                        value="{!Referral__c.Felony_ies__c}" html-disabled="true" /> Felony/ies
                    </apex:outputPanel>
                                <apex:outputPanel layout="block"
                                    rendered="{!Referral__c.Adjudicated_offense_status__c}">
                                    <apex:outputLabel >
                                        <b>Select one :</b>
                                    </apex:outputLabel>
                                    <br />
                                    <apex:inputField id="cbMisdemeanor_s"
                                        value="{!Referral__c.Misdemeanor_s__c}" />
                                    <apex:outputLabel for="cbMisdemeanor_s">Misdemeanor/s</apex:outputLabel>
                                    <br />
                                    <apex:inputField id="cbFelony_ies"
                                        value="{!Referral__c.Felony_ies__c}" />
                                    <apex:outputLabel for="cbFelony_ies">Felony/ies</apex:outputLabel>
                                </apex:outputPanel>
                            </apex:outputPanel>
                        </apex:pageBlockSectionItem>

                        <apex:pageBlockSectionItem rendered="{!ReferralRecordType = 'Cambridge Georgia'}" />
                        <apex:inputField value="{!Referral__c.Geographic_Restrictions__c}"
                            rendered="{!ReferralRecordtype == 'Oregon'}" />
                        <!-- Row 12, Col 3 -->
                        <apex:inputField value="{!Referral__c.Length_of_time__c}"
                            rendered="{!ReferralRecordType = 'Cambridge Florida' ||
                        ReferralRecordType = 'Cambridge Massachusetts' ||
                        ReferralRecordType = 'Cambridge Maryland' ||
                        ReferralRecordType = 'Cambridge Indiana' ||
                        ReferralRecordType = 'Cambridge North Carolina' ||
                        ReferralRecordType = 'Cambridge Ohio' ||
                        ReferralRecordType = 'CA FSS'}" />
                        <apex:inputField value="{!Referral__c.Parental_Disability__c}"
                            rendered="{!ReferralRecordType = 'Cambridge Ohio'}" />
                            
                        <apex:inputField value="{!Referral__c.Has_Pets__c}"
                            rendered="{!ReferralRecordType = 'Oregon'}" />

                        <apex:pageBlockSectionItem rendered="{!ReferralRecordType = 'Cambridge Georgia'}" />
                        <!-- Row 12, Col 4 -->
                        <apex:pageBlockSectionItem rendered="{!ReferralRecordType = 'Cambridge Florida' ||
                                                ReferralRecordType = 'Cambridge Massachusetts' ||
                                                ReferralRecordType = 'Cambridge Maryland' ||
                                                ReferralRecordType = 'Cambridge Indiana' ||
                                                ReferralRecordType = 'Cambridge North Carolina' ||
                                                ReferralRecordType = 'CA FSS'}" />
                        <apex:inputField value="{!Referral__c.Animal_Cruelty__c}"
                            rendered="{!ReferralRecordType = 'Cambridge Georgia'}" />

                        <!-- This section is standard among the operating groups, so wwe keep them in one place -->
                        <apex:outputText rendered="{! (isCambridge && referralRecordType!='Generic') || ReferralRecordType = 'Wisconsin' || ReferralRecordType = 'CA FSS' || ReferralRecordType = 'Oregon'}">
                            <h1>Diagnosis Programming Considerations</h1>
                            <hr />
                        </apex:outputText>
                        <apex:pageBlockSectionItem rendered="{! (isCambridge && referralRecordType!='Generic') || ReferralRecordType = 'Wisconsin' || ReferralRecordType = 'CA FSS' || ReferralRecordType = 'Oregon'}" />
                        <apex:pageBlockSectionItem rendered="{! (isCambridge && referralRecordType!='Generic') || ReferralRecordType = 'Wisconsin' || ReferralRecordType = 'CA FSS' || ReferralRecordType = 'Oregon'}" />
                        <apex:pageBlockSectionItem rendered="{! (isCambridge && referralRecordType!='Generic') || ReferralRecordType = 'Wisconsin' || ReferralRecordType = 'CA FSS' || ReferralRecordType = 'Oregon'}" />
                        <apex:inputField value="{!Referral__c.Choking_Risk__c}"
                            rendered="{! (isCambridge && referralRecordType!='Generic') || ReferralRecordType = 'Wisconsin' || ReferralRecordType = 'CA FSS' || ReferralRecordType = 'Oregon'}" />
                        <apex:inputField value="{!Referral__c.History_of_Bowel_Obstructions__c}"
                            rendered="{! (isCambridge && referralRecordType!='Generic') || ReferralRecordType = 'Wisconsin' ||ReferralRecordType = 'CA FSS' || ReferralRecordType = 'Oregon'}" />
                        <apex:inputField value="{!Referral__c.Takes_Injectible_Medications__c}"
                            rendered="{! (isCambridge && referralRecordType!='Generic') || ReferralRecordType = 'Wisconsin' || ReferralRecordType = 'CA FSS' || ReferralRecordType = 'Oregon'}" />
                        <apex:inputField value="{!Referral__c.Ventilator_Dependent__c}"
                            rendered="{! (isCambridge && referralRecordType!='Generic') || ReferralRecordType = 'Wisconsin' || ReferralRecordType = 'CA FSS'}" />
                        <apex:inputField value="{!Referral__c.Eating_Disorders__c}"
                            rendered="{! (isCambridge && referralRecordType!='Generic') || ReferralRecordType = 'Wisconsin' || ReferralRecordType = 'CA FSS' || ReferralRecordType = 'Oregon' }" />
                        <apex:inputField value="{!Referral__c.Ingesting_Non_Consumables__c}"
                            rendered="{! (isCambridge && referralRecordType!='Generic') || ReferralRecordType = 'Wisconsin' || ReferralRecordType = 'CA FSS' || ReferralRecordType = 'Oregon'}" />
                        <apex:inputField value="{!Referral__c.Psychiatric_Mental_Hospitalization__c}"
                            rendered="{! (isCambridge && referralRecordType!='Generic') || ReferralRecordType = 'Wisconsin' || ReferralRecordType = 'CA FSS' || ReferralRecordType = 'Oregon'}" />
                        <apex:inputField value="{!Referral__c.Hospitalization_Within_the_past_year__c}"
                            rendered="{! (isCambridge && referralRecordType!='Generic') || ReferralRecordType = 'Wisconsin' || ReferralRecordType = 'CA FSS' || ReferralRecordType = 'Oregon'}" />
                        <!-- TADA -->
                    </apex:pageBlockSection> <apex:pageBlockSection columns="1" id="progConsiderationsDetail"
                        rendered="{!OR(ReferralRecordType != 'NeuroRestorative', showNeuroFeatures)}">
                        <apex:inputField value="{!Referral__c.Restricted_Health_Conditions__c}"
                            id="resrictHealthCond"
                            rendered="{!ReferralRecordType == 'Cambridge Georgia'}" />
                        <apex:outputPanel layout="none"
                            rendered="{!ReferralRecordType = 'NeuroRestorative'}">
                            <hr />
                        </apex:outputPanel>
                        <apex:inputTextarea value="{!Referral__c.Programming_Considerations_Comments__c}"
                            id="ProgConsComment" cols="80"
                            rendered="{! (isCambridge && referralRecordType!='Generic') || ReferralRecordType = 'NeuroRestorative' || ReferralRecordType = 'CA FSS' || ReferralRecordType =='Adult Day Health'}" />
                    </apex:pageBlockSection>
                </span>

            </apex:pageBlock>
        </apex:form>
    </div>
    <apex:actionStatus id="myStatus">
        <apex:facet name="start">
            <div class="thinking">
                <div class="thinkingwheel">
                    <span><img class="waitingImage" src="/img/loading.gif"
                        title="Please Wait..." />&nbsp; Processing...</span>
                </div>
            </div>
        </apex:facet>
        <apex:facet name="stop">
        </apex:facet>
    </apex:actionStatus>
    <div style="text-align: right; width: 100%">
        <apex:outputpanel styleclass="whitenoise" id="refTypeHidden">{!referralRecordType}</apex:outputpanel>
    </div>

</apex:page>