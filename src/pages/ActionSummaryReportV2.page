<apex:page standardController="Action_Summary__c" extensions="ActionSummaryReportV2">
	<apex:includeScript value="{!URLFOR($Resource.jquery, 'js/jquery-1.7.2.min.js')}"/>
	<apex:stylesheet value="{!URLFOR($Resource.mentoresd,'/mentoresd.css')}" />
	<style>
		#pbsBlueCard {
			margin-bottom: 15px;
		}
		.leftAndTheRest {
			padding-left:300px;
		}
		.recommendationBlock {
			float: left;
			padding: 4px;
			padding-left: 120px;
			position: relative;
			width: 180px;
			right: 300px;
			margin-left: -100%;
		}
		.commentBlock {
			float: left;
			padding: 4px;
			width: 100%;
			position: relative;
		}
		.objectiveCommentInput {
			width:100%;
		}
		tr.dataRow {
			background-color: white;
		}
		tr.dataRow.changed {
			background-color: #FFF8DC;
		}
		tr.dataRow:hover {
			background-color: #e3f3ff;
		};
	</style>

	<c:PersonalRecord pbsId="{!Action_Summary__c.Service_Assignment__r.Admission__r.Person_Being_Served__r.Id}"
		parentPage="ActionSummaryReport" servAssignId="{!Action_Summary__c.Service_Assignment__c}"
		admId="{!Action_Summary__c.Service_Assignment__r.Admission__c}" />

	<apex:pageMessages id="pageMessages" />
	<apex:form id="mainForm">
		<apex:pageBlock title="Action Plan Summary" >
			<div class="pbHeaderButton">
				<apex:commandButton value="Go To Prior Summaries" id="priorSummariesButton" rendered="{!action == 'edit'}"/>
				<apex:commandButton value="Save" action="{!save}" id="saveButton" status="pageProcessing"  rendered="{!action == 'edit'}"/>
				<apex:commandButton value="Cancel" action="{!cancel}" id="cancelButton" rendered="{!action == 'edit'}"/>
			</div>
			<apex:pageBlockSection title="Summary Details" columns="2">
				<apex:outputField value="{!Action_Summary__c.Name}" label="Summary Name" />
				<apex:outputField value="{!Action_Summary__c.Start_Date__c}" />
				<apex:outputField value="{!Action_Summary__c.Service_Assignment__r.Admission__c}" />
				<apex:outputField value="{!Action_Summary__c.End_Date__c}" />
				<apex:outputField value="{!Action_Summary__c.Service_Assignment__c}" />
				<apex:outputField value="{!Action_Summary__c.Status__c}" />
				<apex:pageBlockSectionItem >
					<apex:outputLabel for="summaryCreatedBy" value="Created By" />
					<apex:outputLink id="summaryCreatedBy" value="/{!Action_Summary__c.CreatedBy.Id}">{!Action_Summary__c.CreatedBy.Name}</apex:outputLink>
				</apex:pageBlockSectionItem>
				<apex:outputField value="{!Action_Summary__c.CreatedDate}" />
			</apex:pageBlockSection>
			<apex:repeat value="{!objectiveMap}" var="objectiveType">
				<apex:pageBlockSection title="{!objectiveType}" columns="1">
					<apex:outputPanel layout="block" id="objectivePanel" style="clear: both; ">
						<apex:repeat value="{!objectiveMap[objectiveType]}" var="objectiveParentToChildrenMap">
							<apex:repeat value="{!objectiveParentToChildrenMap}" var="parentId">
								<table class="list" style="clear: both; margin-bottom: 20px; " cellspacing="0" cellpadding="0" border="0">
									<thead>
										<tr class="headerRow">
											<th>Description</th>
											<th>Revised</th>
											<th>Attribute</th>
											<th>Progress</th>
										</tr>
									</thead>
									<tbody>
										<apex:repeat value="{!objectiveMap[objectiveType][parentId]}" var="objective">
											<tr class="dataRow {!IF(objective.highlight, 'changed', '')}">
												<td class="dataCell">
													{!objective.objectiveSObject.Description__c}
												</td>
												<td class="dataCell">
													{!objective.objectiveSObject.CreatedDate}
												</td>
												<td class="dataCell">
													Status - {!Objective.objectiveSObject.Status__c}<br />
													Effective Date - <apex:outputText value="{0, date, M/d/yyyy}"><apex:param value="{!Objective.objectiveSObject.Effective_Date__c}" /></apex:outputText> <br />
													Target Date - <apex:outputText value="{0, date, M/d/yyyy}"><apex:param value="{!Objective.objectiveSObject.Target_End_Date__c}" /></apex:outputText>
												</td>
												<td class="dataCell">
												</td>
											</tr>
										</apex:repeat>
									</tbody>
								</table>
								<apex:outputPanel layout="block" styleClass="leftAndTheRest">
									<apex:outputPanel layout="block" styleClass="commentBlock">
										<div style="font-weight:bold">Objective Comment</div>
										<apex:inputTextArea styleClass="objectiveCommentInput" value="{!otherSummaryResultMap[parentId].comment}" rows="6" rendered="{!action='edit'}" />
										<apex:outputText value="{!otherSummaryResultMap[parentId].comment}" rendered="{!action!='edit'}" />
									</apex:outputPanel>
									<apex:outputPanel layout="block" styleClass="recommendationBlock">
										<div style="color:#cc6600;font-weight:bold;">Recommendation</div>
										<apex:selectRadio value="{!otherSummaryResultMap[parentId].recommendation}"  layout="pageDirection" rendered="{!action='edit'}">
											<apex:selectoptions value="{!recommendationOptions}"></apex:selectoptions>
										</apex:selectRadio>
										<apex:outputText value="{!otherSummaryResultMap[parentId].recommendation}" rendered="{!action!='edit'}"/>
									</apex:outputPanel>
								</apex:outputPanel>
							</apex:repeat>
						</apex:repeat>
					</apex:outputPanel>
				</apex:pageBlockSection>
			</apex:repeat>
		</apex:pageBlock>
	</apex:form>

	<script>
		jQuery.noConflict();
		jQuery(document).ready(function ($));
	</script>
</apex:page>