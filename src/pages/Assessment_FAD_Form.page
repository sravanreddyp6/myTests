<apex:page standardController="Assessment__c" extensions="Assessment_FAD_Form_Ex"  sidebar="false">
    <apex:includeScript value="{!URLFOR($Resource.jquery, 'js/jquery-1.7.2.min.js')}"/>
    <apex:includeScript value="{!URLFOR($Resource.jquery, 'js/jquery-ui-1.8.21.custom.min.js')}"/>
    <apex:stylesheet value="{!URLFOR($Resource.jquery, 'css/custom-theme/jquery-ui-1.8.21.custom.css')}"/>
    <apex:stylesheet value="{!if ($CurrentPage.parameters.pdf !='1', $Resource.mentoresdcss, $Resource.mentoresdprint)}" />
    <script>function setFocusOnLoad() {}</script>
<style>
    body .bPageBlock[id*=main_detail] {
        margin-bottom: 5px;
    }
.thinking{
    opacity:0.8;
    background-color:#ccc;
    position:fixed;
    width:100%;
    height:100%;
    top:0px;
    left:0px;
    z-index:1000;
}    
.thinkingwheel{
position:absolute; left:50%; top:50%; background-color: white; border: 2px solid gray; padding: 2px;
}
.dateFormat{
    display :none;
}
.txtBox{

    height: 120px;
    width: 270px;

}
</style>
<!---->
<c:PersonalRecord servAssignId="{!Assessment__c.Service_Assignment__c}" pbsId="{!Assessment__c.Admission__r.Person_Being_Served__c}" parentPage="Assessment" admId="{!Assessment__c.Admission__c}" asmtType="{!Assessment__c.Type__c}" asmtId="{!Assessment__c.Id}"   />
<br/>
<apex:outputPanel id="everything">
<apex:pageMessages ></apex:pageMessages>
<apex:form >
<apex:pageBlock title="FAD Assessment Summary" >
    <apex:pageBlockButtons >
        <div style="float: right" >
            <apex:image value="/img/lock_small.gif" alt="Locked" width="20" height="20" title="Record is Locked" rendered="{!Assessment__c.Status__c =='Locked'}" />         
        <!--
            <apex:commandButton action="{!myUnlock}" 
                                value="Unlock" 
                                rendered="{!mode='view'}" 
                                reRender="everything" 
                                status="myStatus"/>
                                
            <apex:commandButton action="{!myDisregard}" 
                                value="Disregard" 
                                rendered="{!mode='view'}" 
                                reRender="everything" 
                                status="myStatus"/>                                 
         -->                       
            <apex:commandButton action="{!myLock}" 
                                value="Submit" 
                                rendered="{!mode='view' && Assessment__c.Status__c =='Open'}" 
                                reRender="everything" 
                                status="myStatus"/>                                        
        
            <apex:commandButton action="{!mySave}" 
                                value="Save"  id="confirmBtn"
                                rendered="{!mode='edit'}" 
                                reRender="everything" 
                                status="myStatus"/>
            <apex:commandButton action="{!myEdit}" 
                                value="Edit" 
                                rendered="{!mode='view' && Assessment__c.Status__c =='Open'}" 
                                reRender="everything" 
                                status="myStatus"/>
            <apex:commandButton action="{!cancel}" 
                                value="Cancel" 
                                rendered="{!$CurrentPage.parameters.isnew !='1' && mode='edit'}" 
                                immediate="true" />    
            <apex:commandButton action="{!mycancel}" 
                                value="Cancel" 
                                rendered="{!$CurrentPage.parameters.isnew =='1' && mode='edit'}" 
                                immediate="true"/>                                 
                                
        </div>
    </apex:pageBlockButtons>
<!-- edit -->    
    <apex:pageBlockSection rendered="{!mode='edit'}" >
        <apex:inputField label="Date of Admistration" required="true"  value="{!Assessment__c.Assessment_Date__c}"/>
        <apex:outputField value="{!Assessment__c.AccountPerson__c}"/>
        
        <apex:inputField required="true" value="{!Assessment__c.Phase__c}">
            <apex:actionSupport reRender="previous_CG" event="onchange" action="{!myCG_is_same_as_other_assessment}"  />
        </apex:inputField>
        
        <!--
        <apex:selectList size="1" value="{!Assessment__c.Phase__c}" required="true">
            <apex:selectOption itemLabel="--None--" itemValue="" ></apex:selectOption>
            <apex:selectOption itemLabel="Initial" itemValue="Initial" ></apex:selectOption>
            <apex:selectOption itemLabel="3 Month" itemValue="3 Month"></apex:selectOption>
            <apex:selectOption itemLabel="Final" itemValue="Final"></apex:selectOption>
            <apex:actionSupport reRender="previous_CG" event="onchange" action="{!myCG_is_same_as_other_assessment}"  />
        </apex:selectList>
        -->
        <apex:outputField value="{!Assessment__c.Service_Assignment__c}"/>
        <apex:outputField value="{!Assessment__c.Status__c}"/>
        <apex:outputField value="{!Assessment__c.Disregard__c}"/>
    </apex:pageBlockSection>
<!-- view -->    
    <apex:pageBlockSection rendered="{!mode='view'}" >
        <apex:outputField label="Date of Admistration"  value="{!Assessment__c.Assessment_Date__c}"/>
        <apex:outputField value="{!Assessment__c.AccountPerson__c}"/>
        <apex:outputField value="{!Assessment__c.Phase__c}"/>
        <apex:outputField value="{!Assessment__c.Service_Assignment__c}"/>
        <apex:outputField value="{!Assessment__c.Status__c}"/>
        <apex:outputField value="{!Assessment__c.Disregard__c}"/>
    </apex:pageBlockSection> 
    
<hr/>      
<!-- PBS edit -->
    <apex:pageBlockSection columns="1" title="Person Being Served" collapsible="false" rendered="{!mode='edit'}">
        <apex:pageBlockSectionItem >
            <apex:outputPanel >{!mapQs['PBS_Could_Not_complete'].Question_Title__c}</apex:outputPanel>            
            <apex:outputPanel layout="block" >
                <apex:inputCheckbox value="{!mapRes['PBS_Could_Not_complete'].Yes_No__c}" onclick="toggleOptions(this, 'PBS_CNC2', 'pbs_question');"/>  
                &nbsp;
                <span id="PBS_CNC2" style="{!if(mapRes['PBS_Could_Not_complete'].Yes_No__c,'','display:none;')}">
                    Reason:&nbsp;<apex:inputField id="PBS_CNC" value="{!mapRes['PBS_Could_Not_complete_reason'].Rating__c}"/>
                </span>
            </apex:outputPanel>        
        </apex:pageBlockSectionItem>    
        <apex:pageBlockSectionItem >
            <apex:outputPanel >{!mapQs['PBS_Problem_Solving'].Question_Title__c}</apex:outputPanel>            
            <apex:outputPanel >
                <apex:inputField styleClass="pbs_question" value="{!mapRes['PBS_Problem_Solving'].Score__c}"/>    
            </apex:outputPanel>        
        </apex:pageBlockSectionItem>
        <apex:pageBlockSectionItem >
            <apex:outputPanel >{!mapQs['PBS_Communication'].Question_Title__c}</apex:outputPanel>            
            <apex:outputPanel >
                <apex:inputField styleClass="pbs_question" value="{!mapRes['PBS_Communication'].Score__c}"/>    
            </apex:outputPanel>        
        </apex:pageBlockSectionItem>
        <apex:pageBlockSectionItem >
            <apex:outputPanel >{!mapQs['PBS_Roles'].Question_Title__c}</apex:outputPanel>            
            <apex:outputPanel >
                <apex:inputField styleClass="pbs_question" value="{!mapRes['PBS_Roles'].Score__c}"/>    
            </apex:outputPanel>        
        </apex:pageBlockSectionItem>
        <apex:pageBlockSectionItem >
            <apex:outputPanel >{!mapQs['PBS_Affective_Responses'].Question_Title__c}</apex:outputPanel>            
            <apex:outputPanel >
                <apex:inputField styleClass="pbs_question" value="{!mapRes['PBS_Affective_Responses'].Score__c}"/>    
            </apex:outputPanel>        
        </apex:pageBlockSectionItem>
        <apex:pageBlockSectionItem >
            <apex:outputPanel >{!mapQs['PBS_Affective_Involvement'].Question_Title__c}</apex:outputPanel>            
            <apex:outputPanel >
                <apex:inputField styleClass="pbs_question" value="{!mapRes['PBS_Affective_Involvement'].Score__c}"/>    
            </apex:outputPanel>        
        </apex:pageBlockSectionItem>
        <apex:pageBlockSectionItem >
            <apex:outputPanel >{!mapQs['PBS_Behavior_Control'].Question_Title__c}</apex:outputPanel>            
            <apex:outputPanel >
                <apex:inputField styleClass="pbs_question" value="{!mapRes['PBS_Behavior_Control'].Score__c}"/>    
            </apex:outputPanel>        
        </apex:pageBlockSectionItem>
        <apex:pageBlockSectionItem >
            <apex:outputPanel >{!mapQs['PBS_General_Functioning'].Question_Title__c}</apex:outputPanel>            
            <apex:outputPanel >
                <apex:inputField styleClass="pbs_question" value="{!mapRes['PBS_General_Functioning'].Score__c}"/>    
            </apex:outputPanel>        
        </apex:pageBlockSectionItem>
        <apex:pageBlockSectionItem >
            <apex:outputPanel >{!mapQs['PBS_Not_Using_Fad_Highest_Concern'].Question_Title__c}</apex:outputPanel>            
            <apex:outputPanel >
                <apex:inputField value="{!mapRes['PBS_Not_Using_Fad_Highest_Concern'].Response__c}" styleClass="txtBox pbs_question"/>    
            </apex:outputPanel>        
        </apex:pageBlockSectionItem> 
    </apex:pageBlockSection>

<!-- PBS view-->
    <apex:pageBlockSection columns="1" title="Person Being Served" collapsible="false" rendered="{!mode='view'}">
        <apex:pageBlockSectionItem >
            <apex:outputPanel >{!mapQs['PBS_Could_Not_complete'].Question_Title__c}</apex:outputPanel>            
            <apex:outputPanel >
                <apex:outputField value="{!mapRes['PBS_Could_Not_complete'].Yes_No__c}" /> 
                <apex:outputField value="{!mapRes['PBS_Could_Not_complete_reason'].Rating__c}"/>   
            </apex:outputPanel>        
        </apex:pageBlockSectionItem>    
        <apex:pageBlockSectionItem >
            <apex:outputPanel >{!mapQs['PBS_Problem_Solving'].Question_Title__c}</apex:outputPanel>            
            <apex:outputPanel >
                <apex:outputField value="{!mapRes['PBS_Problem_Solving'].Score__c}"/>    
            </apex:outputPanel>        
        </apex:pageBlockSectionItem>
        <apex:pageBlockSectionItem >
            <apex:outputPanel >{!mapQs['PBS_Communication'].Question_Title__c}</apex:outputPanel>            
            <apex:outputPanel >
                <apex:outputField value="{!mapRes['PBS_Communication'].Score__c}"/>    
            </apex:outputPanel>        
        </apex:pageBlockSectionItem>
        <apex:pageBlockSectionItem >
            <apex:outputPanel >{!mapQs['PBS_Roles'].Question_Title__c}</apex:outputPanel>            
            <apex:outputPanel >
                <apex:outputField value="{!mapRes['PBS_Roles'].Score__c}"/>    
            </apex:outputPanel>        
        </apex:pageBlockSectionItem>
        <apex:pageBlockSectionItem >
            <apex:outputPanel >{!mapQs['PBS_Affective_Responses'].Question_Title__c}</apex:outputPanel>            
            <apex:outputPanel >
                <apex:outputField value="{!mapRes['PBS_Affective_Responses'].Score__c}"/>    
            </apex:outputPanel>        
        </apex:pageBlockSectionItem>
        <apex:pageBlockSectionItem >
            <apex:outputPanel >{!mapQs['PBS_Affective_Involvement'].Question_Title__c}</apex:outputPanel>            
            <apex:outputPanel >
                <apex:outputField value="{!mapRes['PBS_Affective_Involvement'].Score__c}"/>    
            </apex:outputPanel>        
        </apex:pageBlockSectionItem>
        <apex:pageBlockSectionItem >
            <apex:outputPanel >{!mapQs['PBS_Behavior_Control'].Question_Title__c}</apex:outputPanel>            
            <apex:outputPanel >
                <apex:outputField value="{!mapRes['PBS_Behavior_Control'].Score__c}"/>    
            </apex:outputPanel>        
        </apex:pageBlockSectionItem>
        <apex:pageBlockSectionItem >
            <apex:outputPanel >{!mapQs['PBS_General_Functioning'].Question_Title__c}</apex:outputPanel>            
            <apex:outputPanel >
                <apex:outputField value="{!mapRes['PBS_General_Functioning'].Score__c}"/>    
            </apex:outputPanel>        
        </apex:pageBlockSectionItem>
        <apex:pageBlockSectionItem >
            <apex:outputPanel >{!mapQs['PBS_Not_Using_Fad_Highest_Concern'].Question_Title__c}</apex:outputPanel>            
            <apex:outputPanel >
                <apex:outputField value="{!mapRes['PBS_Not_Using_Fad_Highest_Concern'].Response__c}"/>    
            </apex:outputPanel>        
        </apex:pageBlockSectionItem> 
    </apex:pageBlockSection>
<br/>
<hr/>       
<!-- CG edit -->    
    <apex:pageBlockSection columns="1" title="Caregiver" collapsible="false"  rendered="{!mode='edit'}">
        <apex:pageBlockSectionItem >
            <apex:outputPanel >Primary Caregiver</apex:outputPanel>            
            <apex:outputPanel >
                TBD        
            </apex:outputPanel>        
        </apex:pageBlockSectionItem>    
        <apex:pageBlockSectionItem >
            <apex:outputPanel >{!mapQs['CG_Could_Not_complete'].Question_Title__c}</apex:outputPanel>            
            <apex:outputPanel >
                <apex:inputCheckbox value="{!mapRes['CG_Could_Not_complete'].Yes_No__c}"  onclick="toggleOptions(this, 'CG_CNC2', 'cg_question');"/>
                <span id="CG_CNC2" style="{!if(mapRes['CG_Could_Not_complete'].Yes_No__c,'','display:none;')}">
                    Reason:&nbsp;<apex:inputField value="{!mapRes['CG_Could_Not_complete_reason'].Rating__c}"/>
                </span>                     
            </apex:outputPanel>        
        </apex:pageBlockSectionItem>   
        <apex:pageBlockSectionItem >
            <apex:outputPanel >{!mapQs['CG_is_same_as_other_assessment'].Question_Title__c}</apex:outputPanel>            
            <apex:outputPanel id="previous_CG"> 
                <apex:selectRadio value="{!mapRes['CG_is_same_as_other_assessment'].Rating__c}" 
                                    disabled="{!Assessment__c.Phase__c ='Initial'}">
                    <apex:selectOption itemLabel="Yes" itemValue="Yes"></apex:selectOption>
                    <apex:selectOption itemLabel="No" itemValue="No"></apex:selectOption>
                </apex:selectRadio>
            </apex:outputPanel>        
        </apex:pageBlockSectionItem>          
        <apex:pageBlockSectionItem >
            <apex:outputPanel >{!mapQs['CG_Problem_Solving'].Question_Title__c}</apex:outputPanel>            
            <apex:outputPanel >
                <apex:inputField styleClass="cg_question" value="{!mapRes['CG_Problem_Solving'].Score__c}"/>    
            </apex:outputPanel>        
        </apex:pageBlockSectionItem>
        <apex:pageBlockSectionItem >
            <apex:outputPanel >{!mapQs['CG_Communication'].Question_Title__c}</apex:outputPanel>            
            <apex:outputPanel >
                <apex:inputField styleClass="cg_question" value="{!mapRes['CG_Communication'].Score__c}"/>    
            </apex:outputPanel>        
        </apex:pageBlockSectionItem>
        <apex:pageBlockSectionItem >
            <apex:outputPanel >{!mapQs['CG_Roles'].Question_Title__c}</apex:outputPanel>            
            <apex:outputPanel >
                <apex:inputField styleClass="cg_question" value="{!mapRes['CG_Roles'].Score__c}"/>    
            </apex:outputPanel>        
        </apex:pageBlockSectionItem>
        <apex:pageBlockSectionItem >
            <apex:outputPanel >{!mapQs['CG_Affective_Responses'].Question_Title__c}</apex:outputPanel>            
            <apex:outputPanel >
                <apex:inputField styleClass="cg_question" value="{!mapRes['CG_Affective_Responses'].Score__c}"/>    
            </apex:outputPanel>        
        </apex:pageBlockSectionItem>
        <apex:pageBlockSectionItem >
            <apex:outputPanel >{!mapQs['CG_Affective_Involvement'].Question_Title__c}</apex:outputPanel>            
            <apex:outputPanel >
                <apex:inputField styleClass="cg_question" value="{!mapRes['CG_Affective_Involvement'].Score__c}"/>    
            </apex:outputPanel>        
        </apex:pageBlockSectionItem>
        <apex:pageBlockSectionItem >
            <apex:outputPanel >{!mapQs['CG_Behavior_Control'].Question_Title__c}</apex:outputPanel>            
            <apex:outputPanel >
                <apex:inputField styleClass="cg_question" value="{!mapRes['CG_Behavior_Control'].Score__c}"/>    
            </apex:outputPanel>        
        </apex:pageBlockSectionItem>
        <apex:pageBlockSectionItem >
            <apex:outputPanel >{!mapQs['CG_General_Functioning'].Question_Title__c}</apex:outputPanel>            
            <apex:outputPanel >
                <apex:inputField styleClass="cg_question" value="{!mapRes['CG_General_Functioning'].Score__c}"/>    
            </apex:outputPanel>        
        </apex:pageBlockSectionItem>
        <apex:pageBlockSectionItem >
            <apex:outputPanel >{!mapQs['CG_Not_Using_Fad_Highest_Concern'].Question_Title__c}</apex:outputPanel>            
            <apex:outputPanel >
                <apex:inputField value="{!mapRes['CG_Not_Using_Fad_Highest_Concern'].Response__c}" 
                                    styleClass="txtBox cg_question"/>    
            </apex:outputPanel>        
        </apex:pageBlockSectionItem>    
    </apex:pageBlockSection>
<!-- CG view --> 
    <apex:pageBlockSection columns="1" title="Caregiver" collapsible="false"  rendered="{!mode='view'}">
        <apex:pageBlockSectionItem >
            <apex:outputPanel >Primary Caregiver</apex:outputPanel>            
            <apex:outputPanel >
                TBD        
            </apex:outputPanel>        
        </apex:pageBlockSectionItem>     
        <apex:pageBlockSectionItem >
            <apex:outputPanel >{!mapQs['CG_Could_Not_complete'].Question_Title__c}</apex:outputPanel>            
            <apex:outputPanel >
                <apex:outputField value="{!mapRes['CG_Could_Not_complete'].Yes_No__c}" />
                <apex:outputField value="{!mapRes['CG_Could_Not_complete_reason'].Rating__c}"/>    
            </apex:outputPanel>        
        </apex:pageBlockSectionItem> 
        <apex:pageBlockSectionItem >
            <apex:outputPanel >{!mapQs['CG_is_same_as_other_assessment'].Question_Title__c}</apex:outputPanel>            
            <apex:outputPanel id="previous_CG"> 
                <apex:outputField value="{!mapRes['CG_is_same_as_other_assessment'].Rating__c}" />
            </apex:outputPanel>        
        </apex:pageBlockSectionItem>             
        <apex:pageBlockSectionItem >
            <apex:outputPanel >{!mapQs['CG_Problem_Solving'].Question_Title__c}</apex:outputPanel>            
            <apex:outputPanel >
                <apex:outputField value="{!mapRes['CG_Problem_Solving'].Score__c}"/>    
            </apex:outputPanel>        
        </apex:pageBlockSectionItem>
        <apex:pageBlockSectionItem >
            <apex:outputPanel >{!mapQs['CG_Communication'].Question_Title__c}</apex:outputPanel>            
            <apex:outputPanel >
                <apex:outputField value="{!mapRes['CG_Communication'].Score__c}"/>    
            </apex:outputPanel>        
        </apex:pageBlockSectionItem>
        <apex:pageBlockSectionItem >
            <apex:outputPanel >{!mapQs['CG_Roles'].Question_Title__c}</apex:outputPanel>            
            <apex:outputPanel >
                <apex:outputField value="{!mapRes['CG_Roles'].Score__c}"/>    
            </apex:outputPanel>        
        </apex:pageBlockSectionItem>
        <apex:pageBlockSectionItem >
            <apex:outputPanel >{!mapQs['CG_Affective_Responses'].Question_Title__c}</apex:outputPanel>            
            <apex:outputPanel >
                <apex:outputField value="{!mapRes['CG_Affective_Responses'].Score__c}"/>    
            </apex:outputPanel>        
        </apex:pageBlockSectionItem>
        <apex:pageBlockSectionItem >
            <apex:outputPanel >{!mapQs['CG_Affective_Involvement'].Question_Title__c}</apex:outputPanel>            
            <apex:outputPanel >
                <apex:outputField value="{!mapRes['CG_Affective_Involvement'].Score__c}"/>    
            </apex:outputPanel>        
        </apex:pageBlockSectionItem>
        <apex:pageBlockSectionItem >
            <apex:outputPanel >{!mapQs['CG_Behavior_Control'].Question_Title__c}</apex:outputPanel>            
            <apex:outputPanel >
                <apex:outputField value="{!mapRes['CG_Behavior_Control'].Score__c}"/>    
            </apex:outputPanel>        
        </apex:pageBlockSectionItem>
        <apex:pageBlockSectionItem >
            <apex:outputPanel >{!mapQs['CG_General_Functioning'].Question_Title__c}</apex:outputPanel>            
            <apex:outputPanel >
                <apex:outputField value="{!mapRes['CG_General_Functioning'].Score__c}"/>    
            </apex:outputPanel>        
        </apex:pageBlockSectionItem>
        <apex:pageBlockSectionItem >
            <apex:outputPanel >{!mapQs['CG_Not_Using_Fad_Highest_Concern'].Question_Title__c}</apex:outputPanel>            
            <apex:outputPanel >
                <apex:outputField value="{!mapRes['CG_Not_Using_Fad_Highest_Concern'].Response__c}"/>    
            </apex:outputPanel>        
        </apex:pageBlockSectionItem>    
    </apex:pageBlockSection>   
</apex:pageBlock>
</apex:form>



<c:SObjectNotesAndAttachments rendered="{! mode='view'}" parentId="{!Assessment__c.id}" showAction="false" ></c:SObjectNotesAndAttachments>

<apex:actionStatus id="myStatus" >
    <apex:facet name="start">
        <div  class="thinking">
            <div class="thinkingwheel">
                <span><img class="waitingImage" src="/img/loading.gif" title="Please Wait..." />&nbsp;Processing...</span>
            </div>
        </div>
    </apex:facet>  
    <apex:facet name="stop"></apex:facet>         
</apex:actionStatus>

</apex:outputPanel>

<script>
function scrollWindow()
  {
  window.scrollTo(0,0)
  }

jQuery.noConflict();
var j$ = jQuery.noConflict();
function toggleOptions( rb, divopt, dis_class ) {
    if ( j$(rb).prop('checked')  ){       
        document.getElementById(divopt).style.display = 'inline';
        j$('.'+ dis_class ).prop( "disabled", true ); 
        j$('.'+ dis_class ).prop( "value", "");     
      }
    else{    
        document.getElementById( divopt).style.display = 'none';
        j$('.'+ dis_class ).prop( "disabled", false);        
    }
};
function toggleById(id, ms){
    j$(document.getElementById(id)).toggle(ms);
};
</script>

</apex:page>